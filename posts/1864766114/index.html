<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa:300,300italic,400,400italic,700,700italic|Ma Shan Zheng:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"amostian.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="前置知识： Spring Mybatis SpringMVC 学习视频：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1PE411i7CV?spm_id_from&#x3D;333.337.search-card.all.click  自动装配原理 SpringBoot是企业级开发的整体整合解决方案，特别用于快速构建微服务应用，旨在用最简单的方式让开发人员适应各种开发场景  本视频着重"><meta property="og:type" content="article"><meta property="og:title" content="SpringBoot"><meta property="og:url" content="https://amostian.github.io/posts/1864766114/index.html"><meta property="og:site_name" content="AmosTian"><meta property="og:description" content="前置知识： Spring Mybatis SpringMVC 学习视频：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1PE411i7CV?spm_id_from&#x3D;333.337.search-card.all.click  自动装配原理 SpringBoot是企业级开发的整体整合解决方案，特别用于快速构建微服务应用，旨在用最简单的方式让开发人员适应各种开发场景  本视频着重"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225121311369.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225103909848.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210222221540572.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225112938454.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225113002016.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223122012223.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225184203682.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225124913706.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225123445960.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225125310828.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225123900899.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223123339231.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223105713021.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210222164313683.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20220318101012496.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210222163317091.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210222163655934.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223101105630.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210222163803945.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223212441301.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223213822781.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223215720062.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223215732495.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223215737203.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223165605554.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223163436025.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223190448217.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225174128054.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225172726191.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210223192432319.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225212508624.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225212715554.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225212801309.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/concrete-bindings.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/legacy.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/legacy.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226104919822.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226092429241.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226092447844.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226093025027.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226093946609.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226084751792.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226085421452.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225222114977.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210225222231571.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226085732192.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226112126811.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226112259041.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226112533794.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224113046456.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224114108697.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224115108314.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224115154440.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226113236236.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226113328599.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224120258081.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224122214027.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224123713024.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226120355646.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224131808705.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224160157281.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224165636820.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224170722867.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224170708295.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228193748674.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228194341578.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228194628911.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228195336959.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226163508330.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226163149713.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226164737142.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226165131407.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226165701261.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226170412960.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226170618218.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226170702724.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224180352060.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224175103168.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226180354872.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226184520287.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226184627774.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210226190411112.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224204653626.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224215124654.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227093127936.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227093632333.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224222417611.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224222954196.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227082052346.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210224223826116.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227113118384.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227213638344.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227214229599.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227214157642.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227222235836.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227224116202.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227224123870.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210227224056842.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228122338104.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228122351983.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228202206435.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301101454202.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301101706862.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210228205649247.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301110306283.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301120113925.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301120429885.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301163342791.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301120530935.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301163439031.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301181722341.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301122623056.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301180355956.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301183137958.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301184222365.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301164601358.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301202423757.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301185226902.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301185220385.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301185226902.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301192540428.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301192812288.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301204415789.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301200549284.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301201247349.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301201101370.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301204615309.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301205128756.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301203415376.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301205905147.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301210935040.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301211355035.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301212438367.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301221835357.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210301225101806.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303150602155.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210302122802542.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210302131413918.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303162147435.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303170640201.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303171804782.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303173725150.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303145024390.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303145136752.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303145335036.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303145433524.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303150703527.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303150733376.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303150739664.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303151532231.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303151825997.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303151853199.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303151945285.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303152356183.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303152548713.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303152654981.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303181715679.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303181501723.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303182722927.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303181538977.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303183213136.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303181600074.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303195936200.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303210945785.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303211040914.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303211459760.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303212023419.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303185133410.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303185440444.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303190359260.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210303190901784.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307195651382.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307211857197.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307213620036.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307213602303.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307213854993.png"><meta property="og:image" content="https://amostian.github.io/posts/1864766114/image-20210307214921663.png"><meta property="article:published_time" content="2022-03-15T13:49:17.000Z"><meta property="article:modified_time" content="2023-03-26T16:09:11.196Z"><meta property="article:author" content="AmosTian"><meta property="article:tag" content="开发"><meta property="article:tag" content="后端框架"><meta property="article:tag" content="SpringBoot"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://amostian.github.io/posts/1864766114/image-20210225121311369.png"><link rel="canonical" href="https://amostian.github.io/posts/1864766114/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>SpringBoot | AmosTian</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">AmosTian</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">66</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">83</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">412</span></a></li><li class="menu-item menu-item-essay"><a href="/categories/%E9%9A%8F%E7%AC%94/" rel="section"><i class="fa fa-fw fa-pied-piper"></i>随笔</a></li><li class="menu-item menu-item-dynamic-resume"><a href="/dynamic-resume/" rel="section"><i class="fa fa-fw fa-cog"></i>动态简历</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a href="https://github.com/AmosTian" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://amostian.github.io/posts/1864766114/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="AmosTian"><meta itemprop="description" content="知道的越多，不知道的越多"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="AmosTian"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">SpringBoot</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间 2022-03-15 21:49:17" itemprop="dateCreated datePublished" datetime="2022-03-15T21:49:17+08:00">2022-03-15</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间 2023-03-27 00:09:11" itemprop="dateModified" datetime="2023-03-27T00:09:11+08:00">2023-03-27</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a> </span>> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">后端框架</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数 </span><span title="本文字数">20k字 </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1:15</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>前置知识：</p><p><a href="https://amostian.github.io/posts/1821512031/">Spring</a></p><p><a href="https://amostian.github.io/posts/3381441825/">Mybatis</a></p><p><a href="https://amostian.github.io/posts/2920256992/">SpringMVC</a></p><p>学习视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PE411i7CV?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1PE411i7CV?spm_id_from=333.337.search-card.all.click</a></p></blockquote><p>自动装配原理</p><p>SpringBoot是企业级开发的整体整合解决方案，特别用于快速构建微服务应用，旨在用最简单的方式让开发人员适应各种开发场景</p><p>本视频着重介绍SpringBoot的使用和内部原理；</p><p>内容包含微服务概念、配置文件、日志框架的使用、web开发、Thymeleaf模板引擎、Docker容器技术教程由springboot核心技术+整合篇组成</p><span id="more"></span><h1 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h1><pre class="mermaid">graph LR
A[SpringBoot]-->是什么
A-->配置如何编写
A-->自动装配原理:重要
A-->继承web开发:业务开发
A-->继承数据库Druid
A-->c["分布式开发:Dubbo(RPC接口风格)+zookeeper"]
A-->swagger:接口文档
A-->任务调度
A-->SpringSecurity,拦截器,shiro</pre><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SpringBoot：简化Spring应用的配置文件，使用嵌入式Tomcat，含诸多开箱即用的微服务组件</p><p>Spring Cloud：为开发者提供了微服务动态访问与控制的开发工具包</p><blockquote><p>一个SpringBoot项目就是让Spring启动的项目。过去要启动一个Spring项目，需要配置很多的xml文件，使用SpringBoot之后，可以极大地简化配置过程。</p><p>SpringBoot将所有功能场景封装为一个个的启动器，在开发中只需要导入相应的启动器，启动器就会帮我们导入该场景所需要的带有默认配置的组件，让开发过程专注于业务逻辑。</p><p>类比一下，Maven管理所以的jar包，docker整合了所有环境，SpringBoot整合了所有框架</p></blockquote><h4 id="启动器"><a href="#启动器" class="headerlink" title="启动器"></a>启动器</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--启动器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>启动器：Springboot的启动场景，需要什么功能，找对应的启动器即可</p><p><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/2.2.x/spring-boot-project/spring-boot-starters">启动器</a></p><p>eg：<code>spring-boot-starter-web</code> ：会自动导入web环境相关的所有依赖</p></blockquote><h3 id="两大特点"><a href="#两大特点" class="headerlink" title="两大特点"></a>两大特点</h3><h4 id="开箱即用"><a href="#开箱即用" class="headerlink" title="开箱即用"></a>开箱即用</h4><blockquote><p>在开发过程中，通过maven项目的pom配置文件添加相关依赖包，然后通过注解代替xml配置以管理Bean的生命周期</p></blockquote><h4 id="约定大于配置"><a href="#约定大于配置" class="headerlink" title="约定大于配置"></a>约定大于配置</h4><blockquote><p>由SpringBoot本身来配置目标结构，由开发者在结构中添加信息的结构标准</p></blockquote><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul><li>快速创建独立运行的Spring项目以及主流框架集成</li><li>使用嵌入式Servlet容器，应用无需打成war包，jar包即可</li><li>由starters完成自动依赖与版本控制</li><li>大量的自动配置，简化开发，也可修改默认值</li><li>无需配置XML，无代码生成，开箱即用</li><li>准生产环境的运行时应用监控</li><li>与云计算天然继承</li></ul><h3 id="Spring如何构建微服务"><a href="#Spring如何构建微服务" class="headerlink" title="Spring如何构建微服务"></a>Spring如何构建微服务</h3><ul><li>通过SpringBoot快速构建一个个功能独立的微服务应用单元</li><li>大新分布式网络服务的调用，由SpringCloud完成，实现分布式</li><li>在分布式中间，进行流式数据计算，批处理，spring cloud data flow</li></ul><h3 id="Hello程序"><a href="#Hello程序" class="headerlink" title="Hello程序"></a>Hello程序</h3><h4 id="0-环境"><a href="#0-环境" class="headerlink" title="0. 环境"></a>0. 环境</h4><h5 id="修改主类位置"><a href="#修改主类位置" class="headerlink" title="修改主类位置"></a>修改主类位置</h5><p><img src="/posts/1864766114/image-20210225121311369.png" alt="image-20210225121311369"></p><blockquote><p>重启idea后解决</p></blockquote><h5 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>development<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210225103909848.png" alt="image-20210225103909848"></p><h4 id="1-新建Project"><a href="#1-新建Project" class="headerlink" title="1. 新建Project"></a>1. 新建Project</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--启动器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--junit--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--maven项目--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p><code>&lt;parent&gt;</code> : 继承 <code>spring-boot-starter-parent</code> 的依赖管理，控制版本与打包等内容</p><ul><li><p>即继承spring-boot-dependencies：所有依赖版本控制</p><p><img src="/posts/1864766114/image-20210222221540572.png" alt="image-20210222221540572"></p></li><li><p>引入SpringBoot依赖时，不需要指定版本，因为有版本仓库</p></li></ul></li><li><p>项目元数据信息：创建时的Project Metadata部分，包括groupid,artifactedId,version,name,description等</p></li><li><p>dependencies：项目具体依赖</p><ul><li><code>spring-boot-starter-web</code> 用于实现web应用<ul><li>SpringMVC</li><li>RESTful</li><li>Tomcat作为默认的嵌入式容器</li></ul></li><li><code>spring-boot-starter-test</code>用于编写单元测试的依赖包</li></ul></li><li><p>build:项目构建配置</p><ul><li><code>spring-boot-maven-plugin</code>:配合 <code>Spring-boot-starter-parent</code>将SpringBoot应用打包成JAR直接运行</li></ul></li></ul><h4 id="2-标注主程序类"><a href="#2-标注主程序类" class="headerlink" title="2.标注主程序类"></a>2.标注主程序类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldApplication</span>()&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">         <span class="comment">//Spring应用启动</span></span><br><span class="line">         SpringApplication.run(HelloWorldApplicatio,args)</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>@SpringBootApplication</code>，说明这个类是SpringBoot的主配置类</li></ul><h4 id="3-导入web依赖"><a href="#3-导入web依赖" class="headerlink" title="3. 导入web依赖"></a>3. 导入web依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-改端口号"><a href="#4-改端口号" class="headerlink" title="4. 改端口号"></a>4. 改端口号</h4><p>application.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更改端口号</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8081</span></span><br></pre></td></tr></table></figure><h4 id="5-部署"><a href="#5-部署" class="headerlink" title="5.部署"></a>5.部署</h4><p>将应用打包成可执行的jar包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210225112938454.png" alt="image-20210225112938454"></p><p><img src="/posts/1864766114/image-20210225113002016.png" alt="image-20210225113002016"></p><h2 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h2><h3 id="自动装配示例"><a href="#自动装配示例" class="headerlink" title="自动装配示例"></a>自动装配示例</h3><blockquote><p>需求：定义一个注解，让使用了这个注解的应用程序自动化地注入一些类或者做一些底层的事情</p></blockquote><p><img src="/posts/1864766114/image-20210223122012223.png" alt></p><p>在应用程序的入口加上 <code>@EnableMyConfig</code> 注解。这样的话，MyConfig就被注入进来了</p><p>SpringBoot也就是用这个完成的。只不过它用了更加高级点的ImportSelector。</p><h3 id="什么是自动装配"><a href="#什么是自动装配" class="headerlink" title="什么是自动装配"></a>什么是自动装配</h3><ol><li><p>SpringBoot启动时会根据启动器 <code>starter</code> 加载自动配置类，就是将带有默认配置信息的组件导入Spring容器</p><p>只要自动配置的组件满足场景需求，则无需手动配置</p><p>若应用场景所需的环境没有对应的组件，再尝试手动配置</p></li><li><p>可以在配置文件<code>application.yml</code> 中修改这些自动装配的组件的信息，可以配置的属性封装在了与<code>XXXAutoConfiguration</code> 对应的 <code>XXXProperties</code></p></li></ol><h3 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a><code>@SpringBootApplication</code></h3><blockquote><p>将这个类标注为Springboot主配置类；导入并启动类下的所有资源</p></blockquote><p><img src="/posts/1864766114/image-20210225184203682.png" alt="image-20210225184203682"></p><h4 id="SpringBootConfiguration"><a href="#SpringBootConfiguration" class="headerlink" title="@SpringBootConfiguration"></a>@SpringBootConfiguration</h4><blockquote><p>表示这是一个Spring的配置类，以组件的方式加入到Spring容器中</p><p>相当于XML配置文件 <code>&lt;xml&gt;&lt;/xml&gt;</code></p></blockquote><h4 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h4><blockquote><p>自动扫描并加载符合条件的组件或者bean ， 将这个bean定义加载到IOC容器中</p><p>相当于扫描并加载XML配置文件中的组件 <code>&lt;bean&gt;&lt;/bean&gt;</code></p></blockquote><h4 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h4><blockquote><p>开启自动而配置功能</p></blockquote><h5 id="AutoconfigurationPackage"><a href="#AutoconfigurationPackage" class="headerlink" title="@AutoconfigurationPackage"></a>@AutoconfigurationPackage</h5><blockquote><p>导入组件 <code>Registrar</code> 将主启动类的所在包及包下的所有子包中的配置类注册到Spring容器</p></blockquote><h5 id="Import-AutoConfigurationImportSelector-class"><a href="#Import-AutoConfigurationImportSelector-class" class="headerlink" title="@Import({AutoConfigurationImportSelector.class})"></a>@Import({AutoConfigurationImportSelector.class})</h5><blockquote><p>导入 <code>自动配置导入选择器</code> 组件用于配置导入哪些自动配置类</p></blockquote><p><code>@EnableAutoConfiguration</code> 注解中使用了 <code>AutoConfigurationImportSelector</code>（自动配置类的导入选择器），用于选择自动配置类，导入Spring容器后，以这些自动配置类全限定名数组的形式返回给主配置类。</p><hr><p>第1层</p><p>selectImports()</p><p><img src="/posts/1864766114/image-20210225124913706.png" alt="image-20210225124913706"></p><ul><li><p>AnnotationMetadata指向的是主配置类，也就是 <code>AutoConfigurationImportSelector</code> 会为标注了主配置类(标注了 <code>@SpringBootApplication</code> )导入自动配置类，并将这些自动配置类(也就是可以被自动导入的组件)的全限定名以字符串数组的形式返回给主配置类</p><p><img src="/posts/1864766114/image-20210225123445960.png" alt="image-20210225123445960"></p></li></ul><p>那这些自动配置类哪里来的</p><p>由一个与 <code>selectImports()</code> 方法同一层的 <code>getAutoConfigurationEntry()</code> 选择</p><p><img src="/posts/1864766114/image-20210225125310828.png" alt="image-20210225125310828"></p><p>在这个方法中，调用了 <code>getCandidateConfigurations()</code> 方法，将候选的配置类以字符串列表的形式返回，再经过一系列的排除，过滤操作，才将最终的自动配置类的全限定名数组返回给主配置类。</p><p><img src="/posts/1864766114/image-20210225123900899.png" alt="image-20210225123900899"></p><p><code>getCandidateConfigurations()</code> 方法将获取到的所有配置类的全限定名，保存到 <code>List&lt;String&gt; configurations</code> 字符列表中</p><hr><p>那这些候选的自动配置类又从哪里来，看 <code>getCandidateConfiguration()</code> 方法的执行流程</p><p>第二层：<code>getCandidateConfigurations()</code></p><p><img src="/posts/1864766114/image-20210223123339231.png" alt="image-20210223123339231"></p><p>显然，是调用了 <code>SpringFactoriesLoader.loadFactoryName</code> 获取的全限定名列表</p><hr><p>第三层：SpringFactoriesLoader执行流程</p><p><img src="/posts/1864766114/image-20210223105713021.png" alt="image-20210223105713021"></p><p><img src="/posts/1864766114/image-20210222164313683.png" alt="image-20210222164313683"></p><p>上面这些代码片段的意思就是，<code>SpringFactoriesLoader</code> 会从类路径中查找 <code>spring.factories</code> 的文件，将文件中的全限定名逐一封装为 <code>Properties</code> 类的实例</p><p><img src="/posts/1864766114/image-20220318101012496.png" alt="image-20220318101012496"></p><h4 id="自动装配核心配置——XXXAutoConfiguration"><a href="#自动装配核心配置——XXXAutoConfiguration" class="headerlink" title="自动装配核心配置——XXXAutoConfiguration"></a>自动装配核心配置——XXXAutoConfiguration</h4><p><img src="/posts/1864766114/image-20210222163317091.png" alt="image-20210222163317091"></p><blockquote><p>eg:</p><p><img src="/posts/1864766114/image-20210222163655934.png" alt="image-20210222163655934"></p><p><img src="/posts/1864766114/image-20210223101105630.png" alt="image-20210223101105630"></p><p><img src="/posts/1864766114/image-20210222163803945.png" alt="image-20210222163803945"></p></blockquote><p>getCandidateConfigurations 方法中的 getSpringFactoriesLoaderFactoryClass 方法返回的是<code>EnableAutoConfiguration.class</code>，所以会过滤出key为org.springframework.boot.autoconfigure.EnableAutoConfiguration的值。</p><p>下面这段配置代码就是autoconfigure这个jar包里的spring.factories文件的一部分内容(有个key为org.springframework.boot.autoconfigure.EnableAutoConfiguration，所以会得到这些AutoConfiguration）</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Auto Configure</span></span><br><span class="line"><span class="attr">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="string">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\</span></span><br><span class="line"><span class="string">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\</span></span><br><span class="line"><span class="string">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\</span></span><br><span class="line"><span class="string">org.springframework.boot.autoconfigure.MessageSourceAutoConfiguration,\</span></span><br></pre></td></tr></table></figure><p>当然了，这些AutoConfiguration不是所有都会加载的，会根据AutoConfiguration上的</p><p><code>@ConditionalOnClass</code> 经过exclude和filter等操作，最终确定要装配的类。</p><h4 id="ConditionalOnXXX"><a href="#ConditionalOnXXX" class="headerlink" title="@ConditionalOnXXX"></a><code>@ConditionalOnXXX</code></h4><div class="table-container"><table><thead><tr><th><code>@Conditional</code>扩展注解</th><th>作用（判断是否满足当前指定条件）</th></tr></thead><tbody><tr><td><code>@ConditionalOnJava</code></td><td>系统的java版本是否符合要求</td></tr><tr><td><code>@ConditionalOnBean</code></td><td>容器中是否存在指定Bean</td></tr><tr><td><code>@ConditionalOnMissingBean</code></td><td>容器中不存在指定Bean</td></tr><tr><td><code>@ConditionalOnExpression</code></td><td>满足SpEL表达式指定</td></tr><tr><td><code>@ConditionalOnClass</code></td><td>系统中有指定的类</td></tr><tr><td><code>@ConditionalOnMissingClass</code></td><td>系统中没有指定的类</td></tr><tr><td><code>@ConditionalOnSingleCandidate</code></td><td>容器中只有一个指定的Bean</td></tr><tr><td><code>@ContidionalOnProperty</code></td><td>系统中指定的属性是否有指定的值</td></tr><tr><td><code>@ContidionalOnResource</code></td><td>类路径下是否存在指定资源文件</td></tr><tr><td><code>@ContidionalOnWebApplication</code></td><td>当前是web环境</td></tr><tr><td><code>@ContidionalOnNotWebApplication</code></td><td>当前不是Web环境</td></tr><tr><td><code>@ConditionalOnJndi</code></td><td>JNDI存在指定项</td></tr></tbody></table></div><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul><li>自动装配利用了 <code>SpringFactoriesLoader</code> 会根据 <code>FACTORIES_RESOURCE_LOCATION</code> 这个静态变量指出<code>spring.factories</code>的路径，然后从所有的jar包中读取根据这个文件内容指出的自动配置类。将类信息封装为 <code>propreties</code> 类型的对象</li><li>在若干 <code>@ConditionalOnXXX</code> 的约束下，经过exclude和filter等操作，确定待装配的类是否生效</li><li>所有需要导入的组件，以类名的方式返回，这些组件在 <code>starter</code> 作用下，自动装配到相应的环境</li></ul><h3 id="SpringApplication-run-Springboot01Application-class-args"><a href="#SpringApplication-run-Springboot01Application-class-args" class="headerlink" title="SpringApplication.run(Springboot01Application.class, args);"></a>SpringApplication.run(Springboot01Application.class, args);</h3><p>将SpringBoot启动</p><ul><li>_推断应用类型是普通项目还是web项目_</li><li>查找并加载所有可用的初始化器，设置到initializers属性中</li><li>找出所有的而应用程序监听器，设置到listeners属性中</li><li>_推断并设置main方法的定义类，找出运行的主类_</li></ul><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><h4 id="1-什么会被自动装配"><a href="#1-什么会被自动装配" class="headerlink" title="1. 什么会被自动装配"></a>1. 什么会被自动装配</h4><p>我只知道如何选择自动装配的组件这块，至于这些组件在Spring容器生命周期的哪个阶段加入就没有了解了。</p><p>选择哪些组件会被自动配置，与 <code>@SpringBootApplication</code> 这个注解有关。他有三个重要的注解</p><p>第一个是 <code>@SpringBootConfiguration</code> ，表示启动类也是一个配置类，会以Bean的形式注册到 Spring 容器中</p><p>第二个是 <code>@ComponentScan</code> ，这个注解本身的作用是指出包扫描路径。由于没有配置，默认是扫描主配置类所在包及子包下的组件</p><p>第三个是 <code>@EnableAutoConfiguration</code> 表示开启自动装配功能。他有两个功能，第一个是选择支持自动装配的组件，然后将这些组件的全限定名以字符串数组的方式返回给主配置类，第二个是将需要自动装配组件导入到Spring容器中。这个两个功能分别由两个注解完成，<code>@Import(&#123;AutoConfigurationImportSelector.class&#125;)</code> 和 <code>@AutoConfigurationPackage</code></p><p><code>@Import(&#123;&#125;)</code> 就是通过反射机制导入 <code>AutoConfigurationImportSelector</code> ，这个选择器中有一个 <code>selectImports()</code> 方法，完成自动配置类的选择和全限定名的返回</p><p>具体做法是调用 <code>getAutoConfigurationEntry()</code> 方法筛选主配置类需要的组件，然后返回全限定名。而待筛选的自动配置类，由 <code>getCandidateAutoConfiguration()</code> 返回，这些自动配置类的全限定名是由 <code>SpringFactoriesLoader</code> 加载 <code>spring.factories</code> 文件得到的</p><p><code>@AutoConfigurationPackage</code> ：会导入一个 <code>Registrar</code> 注册器，将启动类所在包及其子包下的组件注册到Spring容器中，就是把自己写的Bean导入到Spring容器中</p><p>而我们平时在 <code>application.yml</code> 主配置文件中的配置项，是与相应的 <code>XXXProperties</code> 中的属性绑定的。 <code>XXXAutoConfiguration</code> 这些可以自动装配的组件，会通过 <code>XXXProperties</code> 获取到配置信息，然后在 <code>@ConditionOn()</code> 注解的作用下，这些可以被自动装配的组件有选择的注册称为Spring容器中的Bean</p><h4 id="2-XXXAutoConfiguration"><a href="#2-XXXAutoConfiguration" class="headerlink" title="2.XXXAutoConfiguration"></a>2.XXXAutoConfiguration</h4><p>在application.yaml中能配置的属性，这些属性的默认值都在对应的 <code>XXXProperties</code>中 ：</p><ul><li>一定会存在对应的 <code>XXXAutoConfiguration</code>类，由 <code>@EnableAutoContiguration</code> 将这些配置类封装为 Properties 类加载到运行主类中</li></ul><h4 id="3-每一个XXXAutoConfiguration进行自动配置功能"><a href="#3-每一个XXXAutoConfiguration进行自动配置功能" class="headerlink" title="3. 每一个XXXAutoConfiguration进行自动配置功能"></a>3. 每一个XXXAutoConfiguration进行自动配置功能</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="comment">//标注为配置类</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(ServerProperties.class)</span></span><br><span class="line"><span class="comment">//启用指定类的CongigurationProperties功能，并把这个配置类加入到IoC容器中</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(type = ConditionalOnWebApplication.Type.SERVLET)</span></span><br><span class="line"><span class="comment">//如果是web应用，当前配置类生效</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ConditionalOnClass(CharacterEncodingFilter.class)</span></span><br><span class="line"><span class="comment">//判断当前项目有没有这个类；SpringMVC中乱码过滤器</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ConditionalOnProperty(prefix = &quot;server.servlet.encoding&quot;, value = &quot;enabled&quot;, matchIfMissing = true)</span></span><br><span class="line"><span class="comment">//配置文件中是否存在某个配置，即使配置文件中没有配置，也是生效的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpEncodingAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Encoding properties;<span class="comment">//properties与SpringBoot的配置文件映射</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//在只有有参构造器的情况下，参数的值(ServerProperties properties)从容器中取</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">HttpEncodingAutoConfiguration</span><span class="params">(ServerProperties properties)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.properties = properties.getServlet().getEncoding();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span>	<span class="comment">//给容器中添加一个组件，这个组件的某些值需从properties中获取</span></span><br><span class="line">	<span class="meta">@ConditionalOnMissingBean</span> <span class="comment">//IoC容器中没有这个Bean才new</span></span><br><span class="line">	<span class="keyword">public</span> CharacterEncodingFilter <span class="title function_">characterEncodingFilter</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">CharacterEncodingFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderedCharacterEncodingFilter</span>();</span><br><span class="line">		filter.setEncoding(<span class="built_in">this</span>.properties.getCharset().name());</span><br><span class="line">		filter.setForceRequestEncoding(<span class="built_in">this</span>.properties.shouldForce(Encoding.Type.REQUEST));</span><br><span class="line">		filter.setForceResponseEncoding(<span class="built_in">this</span>.properties.shouldForce(Encoding.Type.RESPONSE));</span><br><span class="line">		<span class="keyword">return</span> filter;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><ul><li>根据 <code>@ConditionalOnXXX</code> 判断当前 <code>XXXAutoConfiguration</code> 是否生效</li><li>一旦 <code>XXXAutoconfiguration</code> 生效，这个配置类就会给容器中添加各种组件 (由<code>@Bean</code>标注) ；</li><li>这些组件的属性是从对应的XXXProperties类中获取</li><li>XXXAutoconfiguration的每一个属性都是和配置文件绑定，并可通过配置文件修改</li></ul><h4 id="4-配置文件中能配置的属性都在XXXProperties中封装"><a href="#4-配置文件中能配置的属性都在XXXProperties中封装" class="headerlink" title="4. 配置文件中能配置的属性都在XXXProperties中封装"></a>4. 配置文件中能配置的属性都在XXXProperties中封装</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;server&quot;, ignoreUnknownFields = true)</span></span><br><span class="line"><span class="comment">//从配置文件中获取指定属性的值和bean属性进行绑定</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerProperties</span> &#123;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210223212441301.png" alt="image-20210223212441301"></p><p>在 <code>application.yaml</code> 中修改的是这些配置类的属性值</p><p><img src="/posts/1864766114/image-20210223213822781.png" alt="image-20210223213822781"></p><h4 id="检测自动配置类是否生效"><a href="#检测自动配置类是否生效" class="headerlink" title="检测自动配置类是否生效"></a>检测自动配置类是否生效</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">debug:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>生效的</p><p><img src="/posts/1864766114/image-20210223215720062.png" alt="image-20210223215720062"></p><p>没生效的：</p><p><img src="/posts/1864766114/image-20210223215732495.png" alt="image-20210223215732495"></p><p>排除的和不满足条件的：</p><p><img src="/posts/1864766114/image-20210223215737203.png" alt="image-20210223215737203"></p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><h3 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h3><h4 id="yaml基本语法"><a href="#yaml基本语法" class="headerlink" title="yaml基本语法"></a>yaml基本语法</h4><blockquote><p>以数据为中心</p><p>_空格控制层级_</p><p>属性和值，大小写敏感</p><p>“[内容]”：不转义，输出特殊字符表示的内容</p><ul><li><p>name: “hello \n !” _&gt;hello [换行] !</p><p>‘[内容]’:转义，将特殊字符以字符串形式输出</p></li><li><p>name: ‘hello \n !’ _&gt; hello \n !</p></li></ul></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">port</span>&gt;</span>8080<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">student.name</span>=<span class="string">qinjiang</span></span><br><span class="line"><span class="attr">student.age</span>=<span class="string">3</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">	<span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="comment">#对象</span></span><br><span class="line"><span class="attr">student:</span></span><br><span class="line">	<span class="attr">name:</span> <span class="string">qinjiang</span></span><br><span class="line">	<span class="attr">age:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#行内写法</span></span><br><span class="line"><span class="attr">student:</span> &#123;<span class="attr">name:</span> <span class="string">qinjiang</span>,<span class="attr">age:</span> <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#数组</span></span><br><span class="line"><span class="attr">pets:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">dog</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">pig</span></span><br><span class="line"><span class="attr">pets:</span> [<span class="string">cats</span>,<span class="string">dogs</span>,<span class="string">pig</span>]</span><br></pre></td></tr></table></figure><h4 id="配置文件占位符"><a href="#配置文件占位符" class="headerlink" title="配置文件占位符"></a>配置文件占位符</h4><p><code>properties</code>文件和<code>yaml</code>文件都适用</p><blockquote><p>$ 查找的是当前yaml中及其支持的变量</p></blockquote><h5 id="随机数-random-XXXX"><a href="#随机数-random-XXXX" class="headerlink" title="随机数${random.XXXX}"></a>随机数${random.XXXX}</h5><ul><li>${random.int}</li><li>${random.uuid}</li></ul><h5 id="获取之前的值，指定默认值"><a href="#获取之前的值，指定默认值" class="headerlink" title="获取之前的值，指定默认值"></a>获取之前的值，指定默认值</h5><ul><li>${[A]:[B]}：存在用A，不存在用B</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">tian$&#123;random.uuid&#125;</span></span><br><span class="line">  <span class="attr">age:</span> <span class="string">$&#123;random.int&#125;</span></span><br><span class="line">  <span class="attr">happy:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">date:</span> <span class="number">2020</span><span class="string">/02/23</span></span><br><span class="line">  <span class="attr">maps:</span> &#123;<span class="attr">k1:</span> <span class="string">v1</span>,<span class="attr">k2:</span> <span class="string">v2</span>&#125;</span><br><span class="line">  <span class="attr">lists:</span> [<span class="string">code</span>,<span class="string">music</span>]</span><br><span class="line">  <span class="attr">hello:</span> <span class="string">todo</span></span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">$&#123;person.hello:hello&#125;_旺财</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210223165605554.png" alt="image-20210223165605554"></p><h3 id="注入，给实体类赋值"><a href="#注入，给实体类赋值" class="headerlink" title="注入，给实体类赋值"></a>注入，给实体类赋值</h3><p>之前</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;旺财&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;3&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Springboot02YamlApplicationTests</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(dog);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>相关依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">tian</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">happy:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">date:</span> <span class="number">2020</span><span class="string">/02/23</span></span><br><span class="line">  <span class="attr">maps:</span> &#123;<span class="attr">k1:</span> <span class="string">v1</span>,<span class="attr">k2:</span> <span class="string">v2</span>&#125;</span><br><span class="line">  <span class="attr">lists:</span> [<span class="string">code</span>,<span class="string">music</span>]</span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">旺财</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><h4 id="ConfigurationProperties"><a href="#ConfigurationProperties" class="headerlink" title="@ConfigurationProperties"></a><code>@ConfigurationProperties</code></h4><p><code>@ConfigurationProperties(prefix=)</code> 将本类的属性与配置文件中的相关配置绑定</p><ul><li>prefix(“”):指定配置文件中哪个变量进行映射</li><li>只有在 IoC容器中的组件才能使用这个注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Boolean happy;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Object&gt; lists;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210223163436025.png" alt="image-20210223163436025"></p><h4 id="PropertySource"><a href="#PropertySource" class="headerlink" title="@PropertySource"></a><code>@PropertySource</code></h4><p><code>@PropertySource(&quot;classpath:myconfig.xml&quot;)</code>加载指定的配置文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="comment">//@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(value = &quot;classpath:myconfig.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * &lt;bean class=&quot;Person&quot;&gt;</span></span><br><span class="line"><span class="comment">    * 	&lt;property name=&quot;lastName&quot; </span></span><br><span class="line"><span class="comment">    *		value=&quot;字面量|</span></span><br><span class="line"><span class="comment">    				$&#123;key&#125;:从环境变量中获取键值|</span></span><br><span class="line"><span class="comment">    				#&#123;SpEL&#125;&quot;:表达式&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">    * &lt;/bean&gt;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;#&#123;11*2&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="meta">@Value(&quot;true&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean happy;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Object&gt; lists;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><p><code>@ConfigurationProperties</code> 与 <code>@Value</code></p><div class="table-container"><table><thead><tr><th></th><th><code>@ConfigurationProperties</code></th><th><code>@Value</code></th><th></th></tr></thead><tbody><tr><td>功能</td><td>从全局配置文件中，批量注入属性</td><td>一个个指定</td><td></td></tr><tr><td>松散绑定(松散语法)</td><td>支持</td><td>不支持</td><td>last-name_&gt;lastName</td></tr><tr><td>SpEL</td><td>不支持</td><td>支持</td><td>#{11*2}</td></tr><tr><td>JSR303数据校验</td><td>支持</td><td>不支持</td><td><code>@Validated</code></td></tr><tr><td>复杂类型封装</td><td>支持</td><td>不支持</td><td>${maps.key}</td></tr></tbody></table></div><h5 id="松散绑定"><a href="#松散绑定" class="headerlink" title="松散绑定"></a>松散绑定</h5><p>yml中横线命名 ： java中驼峰命名</p><p>last-name ： lastName</p><h5 id="JSR303校验"><a href="#JSR303校验" class="headerlink" title="JSR303校验"></a>JSR303校验</h5><p><code>@Validated</code>_&gt;开启数据验证</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull(message=&quot;名字不能为空&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String userName;</span><br><span class="line"><span class="meta">@Max(value=120,message=&quot;年龄最大不能查过120&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"><span class="meta">@Email(message=&quot;邮箱格式错误&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">空检查</span><br><span class="line"><span class="meta">@Null</span>       验证对象是否为<span class="literal">null</span></span><br><span class="line"><span class="meta">@NotNull</span>    验证对象是否不为<span class="literal">null</span>, 无法查检长度为<span class="number">0</span>的字符串</span><br><span class="line"><span class="meta">@NotBlank</span>   检查约束字符串是不是Null还有被Trim的长度是否大于<span class="number">0</span>,只对字符串,且会去掉前后空格.</span><br><span class="line"><span class="meta">@NotEmpty</span>   检查约束元素是否为NULL或者是EMPTY.</span><br><span class="line">    </span><br><span class="line">Booelan检查</span><br><span class="line"><span class="meta">@AssertTrue</span>     验证 Boolean 对象是否为 <span class="literal">true</span>  </span><br><span class="line"><span class="meta">@AssertFalse</span>    验证 Boolean 对象是否为 <span class="literal">false</span>  </span><br><span class="line">    </span><br><span class="line">长度检查</span><br><span class="line"><span class="meta">@Size(min=, max=)</span> 验证对象（Array,Collection,Map,String）长度是否在给定的范围之内  </span><br><span class="line"><span class="meta">@Length(min=, max=)</span> string is between min and max included.</span><br><span class="line"></span><br><span class="line">日期检查</span><br><span class="line"><span class="meta">@Past</span>       验证 Date 和 Calendar 对象是否在当前时间之前  </span><br><span class="line"><span class="meta">@Future</span>     验证 Date 和 Calendar 对象是否在当前时间之后  </span><br><span class="line"><span class="meta">@Pattern</span>    验证 String 对象是否符合正则表达式的规则</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><ul><li>在某个业务中，只需要配置某个属性的值：<code>@Value</code></li><li>专门编写了一个JavaBean来和配置文件映射：<code>`@ConfigurationProperties</code></li></ul><h3 id="全局配置文件"><a href="#全局配置文件" class="headerlink" title="全局配置文件"></a>全局配置文件</h3><p>配置文件名是固定的</p><ul><li>application.properties<ul><li>语法：key=value</li></ul></li><li>application.yml<ul><li>语法：key: value</li></ul></li></ul><blockquote><p>可以修改SpringBoot自动配置的默认值</p></blockquote><h4 id="全局配置文件的加载位置"><a href="#全局配置文件的加载位置" class="headerlink" title="全局配置文件的加载位置"></a>全局配置文件的加载位置</h4><h5 id="项目内"><a href="#项目内" class="headerlink" title="项目内"></a>项目内</h5><ul><li>./</li><li><p>./config</p></li><li><p>classpath:/</p></li><li>classpath:/config</li></ul><p><img src="/posts/1864766114/image-20210223190448217.png" alt="image-20210223190448217"></p><p>命令行修改配置文件加载位置</p><p>springjava -jar [打包后包名] —spring.config.location=F:/application.properties</p><h6 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h6><ol><li>项目路径/config/application.yml</li><li>项目路径/application.yml</li><li>资源路径/config/application.yml</li><li>资源路径/applicatin.yml</li></ol><h5 id="外部配置加载顺序"><a href="#外部配置加载顺序" class="headerlink" title="外部配置加载顺序"></a>外部配置加载顺序</h5><p><img src="/posts/1864766114/image-20210225174128054.png" alt="image-20210225174128054"></p><h4 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h4><ul><li><strong>互补配置</strong></li><li><strong>高优先级覆盖低优先级</strong></li></ul><h3 id="其他配置文件的加载"><a href="#其他配置文件的加载" class="headerlink" title="其他配置文件的加载"></a>其他配置文件的加载</h3><h4 id="PropertySource-value-quot-quot-quot-quot"><a href="#PropertySource-value-quot-quot-quot-quot" class="headerlink" title="@PropertySource(value={&quot;&quot;,&quot;&quot;})"></a><code>@PropertySource(value=&#123;&quot;&quot;,&quot;&quot;&#125;)</code></h4><blockquote><p>读取指定的配置文件</p></blockquote><h4 id="ImportResource-location-quot-quot-quot-quot"><a href="#ImportResource-location-quot-quot-quot-quot" class="headerlink" title="@ImportResource(location={&quot;&quot;,&quot;&quot;})"></a><code>@ImportResource(location=&#123;&quot;&quot;,&quot;&quot;&#125;)</code></h4><blockquote><p>在一个配置类上标注，导入Spring配置文件，让其生效</p></blockquote><h4 id="SpringBoot推荐使用配置类编写配置"><a href="#SpringBoot推荐使用配置类编写配置" class="headerlink" title="SpringBoot推荐使用配置类编写配置"></a>SpringBoot推荐使用配置类编写配置</h4><p>以前</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>配置类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*@Configuration指明当前类是一个配置类，替代Spring-application.xml文件</span></span><br><span class="line"><span class="comment">*相当于&lt;beans&gt;&lt;/beans&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAppConfig</span>()&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * @Bean将方法的返回值添加到容器中；容器中组件的返回值默认的Id就是方法名</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> HelloService <span class="title function_">helloService</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HelloService</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="多环境切换——Profile"><a href="#多环境切换——Profile" class="headerlink" title="多环境切换——Profile"></a>多环境切换——Profile</h3><p><code>profiles</code> 是Spring对不同环境提供不同配置功能的支持，可以通过激活不同的环境版本，实现快速切换环境；</p><p>我们在主配置文件编写的时候，文件名可以是 <code>application-&#123;profiles&#125;.properties/yml</code> , 用来指定多个环境版本；</p><p>但是Springboot并不会直接启动这些配置文件，它<strong>默认使用application.properties主配置文件</strong>；</p><h4 id="激活方式"><a href="#激活方式" class="headerlink" title="激活方式"></a>激活方式</h4><h5 id="配置文件-1"><a href="#配置文件-1" class="headerlink" title="配置文件"></a>配置文件</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h5 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h5><p>java -jar [打包后包名] —spring.profiles.active=dev</p><p><img src="/posts/1864766114/image-20210225172726191.png" alt="image-20210225172726191"></p><h5 id="jvm参数"><a href="#jvm参数" class="headerlink" title="jvm参数"></a>jvm参数</h5><p>-Dspring.profiles.active=dev</p><h4 id="yaml多文档块"><a href="#yaml多文档块" class="headerlink" title="yaml多文档块"></a>yaml多文档块</h4><p><img src="/posts/1864766114/image-20210223192432319.png" alt="image-20210223192432319"></p><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><div class="table-container"><table><thead><tr><th>日志门面(日志抽象层)</th><th>日志实现</th></tr></thead><tbody><tr><td><del>JCL(Apache2014停更)</del>，<del>jboss-logging(不好用)</del>，SLF4J(Simple Logging Facade for java)</td><td>Log4j,Logback(同一人)<br>log4j2,<del>JUL(java.util.logging)</del></td></tr></tbody></table></div><p>springboot:SLF4J+Logback</p><h3 id="默认日志依赖"><a href="#默认日志依赖" class="headerlink" title="默认日志依赖"></a>默认日志依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210225212508624.png" alt="image-20210225212508624"></p><ol><li>SpringBoot底层也是使用SLF4J+logback进行日志记录</li><li>SpringBoot通过中间替换包把其他日志替换成了SLF4J</li></ol><p><img src="/posts/1864766114/image-20210225212715554.png" alt="image-20210225212715554"></p><p><img src="/posts/1864766114/image-20210225212801309.png" alt="image-20210225212801309"></p><ol><li>使用其他框架，一定要把这个框架默认的日志依赖移除</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.activemq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activemq-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;activemq.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="日志文档与框架关系"><a href="#日志文档与框架关系" class="headerlink" title="日志文档与框架关系"></a>日志文档与框架关系</h3><p><a target="_blank" rel="noopener" href="http://www.slf4j.org/manual.html">SLF4J文档</a></p><p>SLF4J可以由Log4j,logback实现，也可以通过适配层，将其他实现框架转化为SLF4J框架。即一个应用内的所有日志抽象层都是用SLF4J框架</p><p><img src="/posts/1864766114/concrete-bindings.png" alt="img"></p><h4 id="其他框架的统一转换为SLF4J"><a href="#其他框架的统一转换为SLF4J" class="headerlink" title="其他框架的统一转换为SLF4J"></a>其他框架的统一转换为SLF4J</h4><p>不同层使用不同的日志框架，通过适配层统一转化为SLF4J框架</p><p><img src="/posts/1864766114/legacy.png" alt="click to enlarge"></p><ol><li>将系统中其他日志框架先排除出去</li><li>用中间包替换原有日志框架</li><li>导入SLF4J的其他实现</li></ol><p>框架每一个日志的实现实框架都有自己的配置文件，使用SLF4J后，配置文件为实现日志实现框架的配置文件</p><h4 id="切换日志实现框架"><a href="#切换日志实现框架" class="headerlink" title="切换日志实现框架"></a>切换日志实现框架</h4><p>根据SLF4J的日志适配图，进行相关切换</p><p><img src="/posts/1864766114/legacy.png" alt="click to enlarge"></p><p><img src="/posts/1864766114/image-20210226104919822.png" alt="image-20210226104919822"></p><h3 id="SpringBoot默认配置"><a href="#SpringBoot默认配置" class="headerlink" title="SpringBoot默认配置"></a>SpringBoot默认配置</h3><p><img src="/posts/1864766114/image-20210226092429241.png" alt="image-20210226092429241"></p><p><img src="/posts/1864766114/image-20210226092447844.png" alt="image-20210226092447844"></p><h4 id="0-配置原理"><a href="#0-配置原理" class="headerlink" title="0.配置原理"></a>0.配置原理</h4><p><img src="/posts/1864766114/image-20210226093025027.png" alt="image-20210226093025027"></p><p>获得配置文件中的属性值</p><p><img src="/posts/1864766114/image-20210226093946609.png" alt="image-20210226093946609"></p><h4 id="1-导包"><a href="#1-导包" class="headerlink" title="1. 导包"></a>1. 导包</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(getClass());</span><br></pre></td></tr></table></figure><h4 id="2-日志级别"><a href="#2-日志级别" class="headerlink" title="2. 日志级别"></a>2. 日志级别</h4><blockquote><p>调整需要输出的日志级别</p></blockquote><p>trace &lt; debug &lt; info &lt; warn &lt; error</p><p><img src="/posts/1864766114/image-20210226084751792.png" alt="image-20210226084751792"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.springboot:</span> <span class="string">trace</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210226085421452.png" alt="image-20210226085421452"></p><h4 id="3-指定日志信息的输出格式"><a href="#3-指定日志信息的输出格式" class="headerlink" title="3. 指定日志信息的输出格式"></a>3. 指定日志信息的输出格式</h4><p><img src="/posts/1864766114/image-20210225222114977.png" alt="image-20210225222114977"></p><p><img src="/posts/1864766114/image-20210225222231571.png" alt="image-20210225222231571"></p><h4 id="4-日志输出路径"><a href="#4-日志输出路径" class="headerlink" title="4. 日志输出路径"></a>4. 日志输出路径</h4><h5 id="1-在当前路径下输出"><a href="#1-在当前路径下输出" class="headerlink" title="1.在当前路径下输出"></a>1.在当前路径下输出</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line"> <span class="attr">file:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">springboot.log</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210226085732192.png" alt="image-20210226085732192"></p><h5 id="2-指定输出到某一目录下的文件"><a href="#2-指定输出到某一目录下的文件" class="headerlink" title="2. 指定输出到某一目录下的文件"></a>2. 指定输出到某一目录下的文件</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">F:/springboot.log</span></span><br></pre></td></tr></table></figure><h5 id="3-本项目下的目录，默认的文件名为spring-log"><a href="#3-本项目下的目录，默认的文件名为spring-log" class="headerlink" title="3. 本项目下的目录，默认的文件名为spring.log"></a>3. 本项目下的目录，默认的文件名为spring.log</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">log/sringboot-04</span></span><br></pre></td></tr></table></figure><h3 id="SpringBoot自定义日志配置"><a href="#SpringBoot自定义日志配置" class="headerlink" title="SpringBoot自定义日志配置"></a>SpringBoot自定义日志配置</h3><p>每一个日志的实现实框架都有自己的配置文件，使用SLF4J后，配置文件为实现日志实现框架的配置文件</p><p>将 <code>[实现框架名].xml</code>放在在类路径下，即替换</p><div class="table-container"><table><thead><tr><th style="text-align:left">Logging System</th><th style="text-align:left">Customization</th></tr></thead><tbody><tr><td style="text-align:left">Logback</td><td style="text-align:left"><code>logback-spring.xml</code>, <code>logback-spring.groovy</code>, <code>logback.xml</code>, or <code>logback.groovy</code></td></tr><tr><td style="text-align:left">Log4j2</td><td style="text-align:left"><code>log4j2-spring.xml</code> or <code>log4j2.xml</code></td></tr><tr><td style="text-align:left">JDK (Java Util Logging)</td><td style="text-align:left"><code>logging.properties</code></td></tr></tbody></table></div><p>logback.xml:直接就被日志框架识别</p><p>logback-spring.xml:由spring识别，可以使用 <code>profile</code></p><h4 id="多环境日志输出"><a href="#多环境日志输出" class="headerlink" title="多环境日志输出"></a>多环境日志输出</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--可以根据环境调整输出--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;dev&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;!dev&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">profiles</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">active</span>: <span class="string">dev</span></span><br></pre></td></tr></table></figure><h3 id="日志使用"><a href="#日志使用" class="headerlink" title="日志使用"></a>日志使用</h3><h4 id="1-自定义日志配置文件"><a href="#1-自定义日志配置文件" class="headerlink" title="1. 自定义日志配置文件"></a>1. 自定义日志配置文件</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.properties</span></span><br><span class="line"><span class="comment">#配置日志</span></span><br><span class="line"><span class="comment">## 调整需要输出的日志级别 trace &lt; debug &lt; info &lt; warn &lt; error</span></span><br><span class="line"><span class="attr">logging.level.root</span>=<span class="string">info</span></span><br><span class="line"><span class="comment">## 使用mybatis的时候，sql语句是debug下才会打印，而这里我们只配置了info，所以想要查看sql语句的话，有以下两种操作：</span></span><br><span class="line"><span class="comment">### 第一种把 日志配置文件中的 &lt;root level=&quot;info&quot;&gt;改成&lt;root level=&quot;DEBUG&quot;&gt;这样就会打印sql，不过这样日志那边会出现很多其他消息</span></span><br><span class="line"><span class="comment">### 第二种就是单独给dao下目录配置debug模式，这样配置sql语句会打印，其他还是正常info级别：</span></span><br><span class="line"><span class="attr">logging.level.com.xq.tmall.dao</span> = <span class="string">debug</span></span><br></pre></td></tr></table></figure><h4 id="2-日志配置"><a href="#2-日志配置" class="headerlink" title="2. 日志配置"></a>2. 日志配置</h4><p>在resources下面创建一个官方推荐：<code>logback-spring.xml</code></p><blockquote><p>带spring后缀的可以使用 <code>&lt;springProfile &gt;</code> 这个标签来指定环境</p></blockquote><p><strong>根节点\<configuration \>包含的属性</configuration></strong></p><p>日志级别从低到高分为TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL，如果设置为WARN，则低于WARN的信息都不会输出</p><ul><li>scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。</li><li>scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。</li><li>debug:当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">总体说明：根节点下有2个属性，三个节点</span><br><span class="line">属性： contextName 上下文名称； property 设置变量</span><br><span class="line">节点： appender,  root， logger</span><br></pre></td></tr></table></figure><h5 id="lt-root-gt"><a href="#lt-root-gt" class="headerlink" title="&lt;root&gt;"></a><code>&lt;root&gt;</code></h5><p>root节点是必选节点，用来指定最基础的日志输出级别，只有一个level属性。</p><blockquote><p>level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，不能设置为INHERITED或者同义词NULL。<br>默认是DEBUG。<br>可以包含零个或多个元素，表示这个appender将会添加到这个loger。</p></blockquote><h5 id="lt-contextName-gt"><a href="#lt-contextName-gt" class="headerlink" title="&lt;contextName&gt;"></a><code>&lt;contextName&gt;</code></h5><p>设置上下文名称</p><blockquote><p>每个logger都关联到logger上下文，默认上下文名称为“default”。但可以使用设置成其他名字，用于区分不同应用程序的记录。一旦设置，不能修改,可以通过<code>%contextName</code>来打印日志上下文名称，一般来说我们不用这个属性，可有可无。</p></blockquote><h5 id="lt-property-gt"><a href="#lt-property-gt" class="headerlink" title="&lt;property&gt;"></a><code>&lt;property&gt;</code></h5><p>设置变量</p><blockquote><p>用来定义变量值的标签， 有两个属性，name和value；其中name的值是变量的名称，value的值时变量定义的值。通过定义的值会被插入到logger上下文中。定义变量后，可以使“${}”来使用变量。</p></blockquote><h5 id="lt-appender-gt"><a href="#lt-appender-gt" class="headerlink" title="&lt;appender&gt;"></a><code>&lt;appender&gt;</code></h5><blockquote><p>appender用来格式化日志输出节点，有两个属性name和class</p></blockquote><ul><li>class用来指定哪种输出策略，常用就是控制台输出策略和文件输出策略。</li></ul><h6 id="控制台输出ConsoleAppender"><a href="#控制台输出ConsoleAppender" class="headerlink" title="控制台输出ConsoleAppender"></a>控制台输出<code>ConsoleAppender</code></h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;consoleLog1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--展示格式 layout--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d -1 %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;consoleLog2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d -2 %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure><p>都可以将事件转换为格式化后的日志记录，但是控制台输出使用<code>layout</code>，文件输出使用<code>encoder</code></p><p><code>&lt;encoder&gt;</code>表示对日志进行编码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">%d&#123;HH: mm:ss.SSS&#125;——日志输出时间</span><br><span class="line">%thread——输出日志的进程名字，这在Web应用以及异步任务处理中很有用</span><br><span class="line">%-5level——日志级别，并且使用5个字符靠左对齐</span><br><span class="line">%logger&#123;36&#125;——日志输出者的名字</span><br><span class="line">%msg——日志消息</span><br><span class="line">%n——平台的换行符</span><br></pre></td></tr></table></figure><p>ThresholdFilter为系统定义的拦截器，例如我们用ThresholdFilter来过滤掉ERROR级别以下的日志不输出到文件中。如果不用记得注释掉，不然你控制台会发现没日志~</p><h6 id="输出到文件-RollingFileAppender"><a href="#输出到文件-RollingFileAppender" class="headerlink" title="输出到文件 RollingFileAppender"></a>输出到文件 <code>RollingFileAppender</code></h6><p>随着应用的运行时间越来越长，日志也会增长的越来越多，将他们输出到同一个文件并非一个好办法。<code>RollingFileAppender</code>用于切分文件日志：</p><h5 id="lt-loger-gt"><a href="#lt-loger-gt" class="headerlink" title="&lt;loger&gt;"></a><code>&lt;loger&gt;</code></h5><p><code>&lt;loger&gt;</code>用来设置某一个包或者具体的某一个类的日志打印级别、以及指定 <code>&lt;appender&gt;</code>。</p><ul><li><p>name:用来指定受此loger约束的某一个包或者具体的某一个类。</p></li><li><p>level</p><p>用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，还有一个特殊值INHERITED或者同义词NULL，代表强制执行上级的级别。如果未设置此属性，那么当前loger将会继承上级的级别。</p></li><li><p>addtivity:是否向上级loger传递打印信息。默认是true</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;10 seconds&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>logback-spring<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logging.path&quot;</span> <span class="attr">value</span>=<span class="string">&quot;myLogs&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--0. 日志格式和颜色渲染 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 彩色日志依赖的渲染类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">&quot;clr&quot;</span> <span class="attr">converterClass</span>=<span class="string">&quot;org.springframework.boot.logging.logback.ColorConverter&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">&quot;wex&quot;</span> <span class="attr">converterClass</span>=<span class="string">&quot;org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">&quot;wEx&quot;</span> <span class="attr">converterClass</span>=<span class="string">&quot;org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 彩色日志格式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE_LOG_PATTERN&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;$&#123;CONSOLE_LOG_PATTERN:-%clr(%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;)&#123;faint&#125; %clr($&#123;LOG_LEVEL_PATTERN:-%5p&#125;) %clr($&#123;PID:- &#125;)&#123;magenta&#125; %clr(---)&#123;faint&#125; %clr([%15.15t])&#123;faint&#125; %clr(%-40.40logger&#123;39&#125;)&#123;cyan&#125; %clr(:)&#123;faint&#125; %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&#125;&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--1. 输出到控制台--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日志文档输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定日志格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>$&#123;CONSOLE_LOG_PATTERN&#125;<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置字符集--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--输出到文档--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 时间滚动输出 level为 DEBUG 日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;DEBUG_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文件的路径及文件名~~~~~file设置打印的文件的路径及文件名，建议绝对路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;logging.path&#125;/web_debug.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日志文档输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定日志格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 设置字符集 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            日志记录器的滚动策略</span></span><br><span class="line"><span class="comment">            SizeAndTimeBasedRollingPolicy 按日期，大小记录日志</span></span><br><span class="line"><span class="comment">            另外一种方式：</span></span><br><span class="line"><span class="comment">                rollingPolicy的class设置为ch.qos.logback.core.rolling.TimeBasedRollingPolicy</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 日志归档 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                归档的日志文件的路径，例如今天是2018-08-23日志，当前写的日志文件路径为file节点指定，</span></span><br><span class="line"><span class="comment">                可以将此文件与file指定文件路径设置为不同路径，从而将当前日志文件或归档日志文件置不同的目录。</span></span><br><span class="line"><span class="comment">                而2018-08-23的日志文件在由fileNamePattern指定。%d&#123;yyyy-MM-dd&#125;指定日期格式，%i指定索引</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;logging.path&#125;/web-debug-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">               配置日志文件不能超过100M，若超过100M，日志文件会以索引0开始，命名日志文件</span></span><br><span class="line"><span class="comment">               例如error.20180823.0.txt</span></span><br><span class="line"><span class="comment">               --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--日志文档保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文档只记录debug级别的 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 过滤策略：</span></span><br><span class="line"><span class="comment">            LevelFilter ： 只打印level标签设置的日志级别</span></span><br><span class="line"><span class="comment">            ThresholdFilter：打印大于等于level标签设置的级别，小的舍弃</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 过滤的日志级别 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--匹配到就允许--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--没有匹配到就禁止--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2.2 level为 INFO 日志，时间滚动输出  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;INFO_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文档的路径及文档名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;logging.path&#125;/web_info.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文档输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 每天日志归档路径以及格式 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;logging.path&#125;/web-info-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文档保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文档只记录info级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>info<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2.3 level为 WARN 日志，时间滚动输出  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;WARN_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文档的路径及文档名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;logging.path&#125;/web_warn.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文档输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;logging.path&#125;/web-warn-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文档保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文档只记录warn级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2.4 level为 ERROR 日志，时间滚动输出  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ERROR_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文档的路径及文档名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;logging.path&#125;/web_error.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文档输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;logging.path&#125;/web-error-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文档保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文档只记录ERROR级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    ## 使用mybatis的时候，sql语句是debug下才会打印，而这里我们只配置了info，所以想要查看sql语句的话，有以下两种操作：</span></span><br><span class="line"><span class="comment">    ### 第一种把 日志配置文件中的 &lt;root level=&quot;info&quot;&gt;改成&lt;root level=&quot;DEBUG&quot;&gt;这样就会打印sql，不过这样日志那边会出现很多其他消息</span></span><br><span class="line"><span class="comment">      &lt;logger name=&quot;org.springframework.web&quot; level=&quot;info&quot;/&gt;</span></span><br><span class="line"><span class="comment">      &lt;logger name=&quot;org.springframework.scheduling.annotation.ScheduledAnnotationBeanPostProcessor&quot; level=&quot;INFO&quot;/&gt;</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 4. 最终的策略 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;DEBUG_FILE&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO_FILE&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;WARN_FILE&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ERROR_FILE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h4><p>SLF4J的jar和Logback的实现jar</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorld.class);</span><br><span class="line">    logger.info(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AOP实现自定义日志"><a href="#AOP实现自定义日志" class="headerlink" title="AOP实现自定义日志"></a>AOP实现自定义日志</h3><h4 id="定义切点注解"><a href="#定义切点注解" class="headerlink" title="定义切点注解"></a>定义切点注解</h4><h4 id="定义切面"><a href="#定义切面" class="headerlink" title="定义切面"></a>定义切面</h4><h4 id="在切点切入"><a href="#在切点切入" class="headerlink" title="在切点切入"></a>在切点切入</h4><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><ul><li>导入静态资源</li><li>首页</li><li>jsp，模板引擎Thymeleaf</li><li>装配扩展SpringMVC</li><li>CRUD</li><li>Inteceptor</li><li>国家化</li></ul><p><strong>使用SpringBoot:</strong></p><ul><li>创建SpringBoot应用，选中模块</li><li>SpringBoot默认将这些场景配置好，只需要在配置文件中指定少量配置即可</li><li>自己编写业务代码</li></ul><p><strong>自动配置原理：</strong></p><ul><li>这个场景SpringBoot帮我们配置了什么？能不能修改！</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XXXAutoconfiguration</span><br><span class="line">XXXProperties</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://getbootstrap.com/">bootstrap</a></p><h3 id="导入静态资源"><a href="#导入静态资源" class="headerlink" title="导入静态资源"></a>导入静态资源</h3><p><img src="/posts/1864766114/image-20210226112126811.png" alt="image-20210226112126811"></p><p><img src="/posts/1864766114/image-20210226112259041.png" alt="image-20210226112259041"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">	<span class="comment">//判断是否开启自动配置资源路径</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">        logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//所有 /webjars 的静态资源请求，都被映射到 classpath:/META-INF/resources/webjars/下</span></span><br><span class="line">    addResourceHandler(registry, <span class="string">&quot;/webjars/**&quot;</span>, <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getStaticPathPattern(), (registration) -&gt; &#123;</span><br><span class="line">        registration.addResourceLocations(<span class="built_in">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">        <span class="keyword">if</span> (servletContext != <span class="literal">null</span>) &#123;</span><br><span class="line">            registration.addResourceLocations(<span class="keyword">new</span> <span class="title class_">ServletContextResource</span>(servletContext, SERVLET_LOCATION));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-webjars"><a href="#1-webjars" class="headerlink" title="1. webjars"></a>1. webjars</h4><p><a target="_blank" rel="noopener" href="https://www.webjars.org/">webjars</a>:以jar包的方式导入静态资源</p><p>所有 <code>/webjars</code> 的静态资源请求，都被映射到 <code>classpath:/META-INF/resources/webjars/</code>下</p><p><img src="/posts/1864766114/image-20210226112533794.png" alt="image-20210226112533794"></p><p><img src="/posts/1864766114/image-20210224113046456.png" alt="image-20210224113046456"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210224114108697.png" alt="image-20210224114108697"></p><p><img src="/posts/1864766114/image-20210224115108314.png" alt="image-20210224115108314"></p><p><img src="/posts/1864766114/image-20210224115154440.png" alt="image-20210224115154440"></p><h4 id="2-静态资源的默认查找位置"><a href="#2-静态资源的默认查找位置" class="headerlink" title="2. 静态资源的默认查找位置"></a>2. 静态资源的默认查找位置</h4><p><img src="/posts/1864766114/image-20210226113236236.png" alt="image-20210226113236236"></p><p><img src="/posts/1864766114/image-20210226113328599.png" alt="image-20210226113328599"></p><h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><ul><li>wabjars ：一般不用</li><li>rescources :上传的文件</li><li>static ：静态资源，图片</li><li>public :公共资源</li></ul><blockquote><p>localhost:8080/webjars/**</p></blockquote><p><strong>优先级</strong></p><p>rescources&gt;static&gt;public</p><p><img src="/posts/1864766114/image-20210224120258081.png" alt="image-20210224120258081"></p><h3 id="首页"><a href="#首页" class="headerlink" title="首页"></a>首页</h3><h4 id="位置"><a href="#位置" class="headerlink" title="位置"></a>位置</h4><blockquote><p>首页 从静态资源路径 <code>CLASSPATH_RESOURCE_LOCATIONS</code> +index.gtml中查找</p></blockquote><p><img src="/posts/1864766114/image-20210224122214027.png" alt="image-20210224122214027"></p><p>在Templates目录下的所有页面只能通过Controller跳转，相当于 WEB-INF</p><p>需要<code>TemplateEngine</code>模板引擎支持</p><h3 id="模板引擎——ThymeLeaf"><a href="#模板引擎——ThymeLeaf" class="headerlink" title="模板引擎——ThymeLeaf"></a>模板引擎——ThymeLeaf</h3><blockquote><p>为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的HTML文档。</p><p>模板引擎的实现方式有很多，最简单的是“置换型”模板引擎，这类模板引擎只是将指定模板内容（字符串）中的特定标记（子字符串）替换一下便生成了最终需要的业务数据（比如网页）。</p></blockquote><p>类比：JSP</p><p><img src="/posts/1864766114/image-20210224123713024.png" alt="image-20210224123713024"></p><p><a target="_blank" rel="noopener" href="https://github.com/thymeleaf/thymeleaf">github</a></p><p><a target="_blank" rel="noopener" href="https://www.thymeleaf.org/">Thymeleaf官网</a></p><h4 id="启动器-1"><a href="#启动器-1" class="headerlink" title="启动器"></a>启动器</h4><p>spring-boot-starter-thymeleaf</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-java8time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210226120355646.png" alt="image-20210226120355646"></p><h4 id="默认位置"><a href="#默认位置" class="headerlink" title="默认位置"></a>默认位置</h4><p><img src="/posts/1864766114/image-20210224131808705.png" alt="image-20210224131808705"></p><p><strong>页面默认位置为classpath:/templates/</strong></p><h4 id="导入thymeleaf约束"><a href="#导入thymeleaf约束" class="headerlink" title="导入thymeleaf约束"></a>导入thymeleaf约束</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><p><strong>所有的html元素都可被 thymeleaf替换接管， th:元素名</strong></p><h5 id="属性优先级"><a href="#属性优先级" class="headerlink" title="属性优先级"></a>属性优先级</h5><div class="table-container"><table><thead><tr><th style="text-align:left">JSP</th><th style="text-align:left">Feature</th><th style="text-align:left">Attributes</th></tr></thead><tbody><tr><td style="text-align:left"><code>jsp:include</code></td><td style="text-align:left">Fragment inclusion</td><td style="text-align:left"><code>th:insert</code> <code>th:replace</code></td></tr><tr><td style="text-align:left"><code>c:forEach</code></td><td style="text-align:left">Fragment iteration</td><td style="text-align:left"><code>th:each</code></td></tr><tr><td style="text-align:left">流程控制</td><td style="text-align:left">Conditional evaluation</td><td style="text-align:left"><code>th:if</code> <code>th:unless</code> <code>th:switch</code> <code>th:case</code></td></tr><tr><td style="text-align:left">声明变量 <code>c:set</code></td><td style="text-align:left">Local variable definition</td><td style="text-align:left"><code>th:object</code> <code>th:with</code></td></tr><tr><td style="text-align:left">属性修改，支持 prepend,append</td><td style="text-align:left">General attribute modification</td><td style="text-align:left"><code>th:attr</code> <code>th:attrprepend</code> <code>th:attrappend</code></td></tr><tr><td style="text-align:left">修改指定属性默认值</td><td style="text-align:left">Specific attribute modification</td><td style="text-align:left"><code>th:value</code> <code>th:href</code> <code>th:src</code> <code>...</code></td></tr><tr><td style="text-align:left">修改标签体内容</td><td style="text-align:left">Text (tag body modification)是否转义</td><td style="text-align:left"><code>th:text</code>转义特殊字符<br><code>th:utext</code>不转义特殊字符</td></tr><tr><td style="text-align:left">声明片段</td><td style="text-align:left">Fragment specification</td><td style="text-align:left"><code>th:fragment</code></td></tr><tr><td style="text-align:left"></td><td style="text-align:left">Fragment removal</td><td style="text-align:left"><code>th:remove</code></td></tr></tbody></table></div><p><img src="/posts/1864766114/image-20210224160157281.png" alt="image-20210224160157281"></p><h5 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h5><h6 id="Simple-expressions"><a href="#Simple-expressions" class="headerlink" title="Simple expressions:"></a>Simple expressions:</h6><ol><li>Variable Expressions: <code>$&#123;...&#125;</code>：获取变量值</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Access to properties using the point (.). Equivalent to calling property getters.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$&#123;person.father.name&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Access to properties can also be made by using brackets ([]) and writing </span></span><br><span class="line"><span class="comment"> * the name of the property as a variable or between single quotes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$&#123;person[<span class="string">&#x27;father&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * If the object is a map, both dot and bracket syntax will be equivalent to </span></span><br><span class="line"><span class="comment"> * executing a call on its get(...) method.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$&#123;countriesByCode.ES&#125;</span><br><span class="line">$&#123;personsByName[<span class="string">&#x27;Stephen Zucchini&#x27;</span>].age&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Indexed access to arrays or collections is also performed with brackets, </span></span><br><span class="line"><span class="comment"> * writing the index without quotes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$&#123;personsArray[<span class="number">0</span>].name&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Methods can be called, even with arguments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$&#123;person.createCompleteName()&#125;</span><br><span class="line">$&#123;person.createCompleteNameWithSeparator(<span class="string">&#x27;-&#x27;</span>)&#125;</span><br></pre></td></tr></table></figure><ul><li><p>内置的基本对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#ctx: the context object.</span><br><span class="line">#vars: the context variables.</span><br><span class="line">#locale: the context locale.</span><br><span class="line"></span><br><span class="line">&lt;!--(only in Web Contexts)--&gt;</span><br><span class="line">#request:  the HttpServletRequest object.</span><br><span class="line">#response: the HttpServletResponse object.</span><br><span class="line">#session: the HttpSession object.</span><br><span class="line">#servletContext: the ServletContext object.</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>内置的工具对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#execInfo: information about the template being processed.</span><br><span class="line"></span><br><span class="line">#messages: methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using #&#123;…&#125; syntax.</span><br><span class="line"></span><br><span class="line">#uris: methods for escaping parts of URLs/URIs</span><br><span class="line"></span><br><span class="line">#conversions: methods for executing the configured conversion service (if any).</span><br><span class="line"></span><br><span class="line">#dates: methods for java.util.Date objects: formatting, component extraction, etc.</span><br><span class="line"></span><br><span class="line">#calendars: analogous to #dates, but for java.util.Calendar objects.</span><br><span class="line"></span><br><span class="line">#numbers: methods for formatting numeric objects.</span><br><span class="line">#strings: methods for String objects: contains, startsWith, prepending/appending, etc.</span><br><span class="line"></span><br><span class="line">#objects: methods for objects in general.</span><br><span class="line"></span><br><span class="line">#bools: methods for boolean evaluation.</span><br><span class="line"></span><br><span class="line">#arrays: methods for arrays.</span><br><span class="line"></span><br><span class="line">#lists: methods for lists.</span><br><span class="line"></span><br><span class="line">#sets: methods for sets.</span><br><span class="line"></span><br><span class="line">#maps: methods for maps.</span><br><span class="line"></span><br><span class="line">#aggregates: methods for creating aggregates on arrays or collections.</span><br><span class="line"></span><br><span class="line">#ids: methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).</span><br></pre></td></tr></table></figure></li></ul><ol><li><p>Selection Variable Expressions: <code>*&#123;...&#125;</code>:配合th:object使用</p><p><img src="/posts/1864766114/image-20210224165636820.png" alt="image-20210224165636820"></p></li><li><p>Message Expressions: <code>#&#123;...&#125;</code>获取国际化内容</p></li><li><p>Link URL Expressions: <code>@&#123;...&#125;</code>:定义URL</p></li></ol><ul><li>@{/order/process(execId=${execId},execType=’FAST’)}</li></ul><ol><li>Fragment Expressions: <code>~&#123;...&#125;</code></li></ol><h6 id="Literals-字面量"><a href="#Literals-字面量" class="headerlink" title="Literals 字面量"></a>Literals 字面量</h6><ul><li>Text literals: <code>&#39;one text&#39;</code>, <code>&#39;Another one!&#39;</code>,…</li><li>Number literals: <code>0</code>, <code>34</code>, <code>3.0</code>, <code>12.3</code>,…</li><li>Boolean literals: <code>true</code>, <code>false</code></li><li>Null literal: <code>null</code></li><li>Literal tokens: <code>one</code>, <code>sometext</code>, <code>main</code>,…</li></ul><h6 id="Text-operations-文本拼接"><a href="#Text-operations-文本拼接" class="headerlink" title="Text operations:文本拼接"></a>Text operations:文本拼接</h6><ul><li>String concatenation: <code>+</code></li><li>Literal substitutions: <code>|The name is $&#123;name&#125;|</code></li></ul><h6 id="Arithmetic-operations-数学运算"><a href="#Arithmetic-operations-数学运算" class="headerlink" title="Arithmetic operations:数学运算"></a>Arithmetic operations:数学运算</h6><ul><li>Binary operators: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></li><li>Minus sign (unary operator): <code>-</code></li></ul><h6 id="Boolean-operations-布尔运算"><a href="#Boolean-operations-布尔运算" class="headerlink" title="Boolean operations:布尔运算"></a>Boolean operations:布尔运算</h6><ul><li>Binary operators: <code>and</code>, <code>or</code></li><li>Boolean negation (unary operator): <code>!</code>, <code>not</code></li></ul><h6 id="Comparisons-and-equality-比较运算"><a href="#Comparisons-and-equality-比较运算" class="headerlink" title="Comparisons and equality:比较运算"></a>Comparisons and equality:比较运算</h6><ul><li>Comparators: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> (<code>gt</code>, <code>lt</code>, <code>ge</code>, <code>le</code>)</li><li>Equality operators: <code>_</code>, <code>!=</code> (<code>eq</code>, <code>ne</code>)</li></ul><h6 id="Conditional-operators-条件运算"><a href="#Conditional-operators-条件运算" class="headerlink" title="Conditional operators:条件运算"></a>Conditional operators:条件运算</h6><ul><li>If-then: <code>(if) ? (then)</code></li><li>If-then-else: <code>(if) ? (then) : (else)</code></li><li>Default: <code>(value) ?: (defaultvalue)</code></li></ul><h6 id="Special-tokens"><a href="#Special-tokens" class="headerlink" title="Special tokens:"></a>Special tokens:</h6><ul><li>No-Operation: <code>_</code></li></ul><p>All these features can be combined and nested:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;User is of type &#x27; + ($&#123;user.isAdmin()&#125; ? &#x27;Administrator&#x27; : ($&#123;user.type&#125; ?: &#x27;Unknown&#x27;))</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210224170722867.png" alt="image-20210224170722867"></p><p><img src="/posts/1864766114/image-20210224170708295.png" alt="image-20210224170708295"></p><h4 id="Thymeleaf请求转发实现机制"><a href="#Thymeleaf请求转发实现机制" class="headerlink" title="Thymeleaf请求转发实现机制"></a>Thymeleaf请求转发实现机制</h4><p><img src="/posts/1864766114/image-20210228193748674.png" alt="image-20210228193748674"></p><h5 id="redirect"><a href="#redirect" class="headerlink" title="redirect"></a>redirect</h5><blockquote><p>底层也是response.sendredirect 实现页面重定向</p></blockquote><p><img src="/posts/1864766114/image-20210228194341578.png" alt="image-20210228194341578"></p><p>渲染页面，并将model中属性转为request参数，并重定向到目标页面</p><p><img src="/posts/1864766114/image-20210228194628911.png" alt="image-20210228194628911"></p><h5 id="request"><a href="#request" class="headerlink" title="request"></a>request</h5><p><img src="/posts/1864766114/image-20210228195336959.png" alt="image-20210228195336959"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Render the internal resource given the specified model.</span></span><br><span class="line"><span class="comment"> * This includes setting the model as request attributes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">renderMergedOutputModel</span><span class="params">(</span></span><br><span class="line"><span class="params">    Map&lt;String, Object&gt; model, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Expose the model object as request attributes.</span></span><br><span class="line">    exposeModelAsRequestAttributes(model, request);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Expose helpers as request attributes, if any.</span></span><br><span class="line">    exposeHelpers(request);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine the path for the request dispatcher.</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">dispatcherPath</span> <span class="operator">=</span> prepareForRendering(request, response);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Obtain a RequestDispatcher for the target resource (typically a JSP).</span></span><br><span class="line">    <span class="type">RequestDispatcher</span> <span class="variable">rd</span> <span class="operator">=</span> getRequestDispatcher(request, dispatcherPath);</span><br><span class="line">    <span class="keyword">if</span> (rd _ <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServletException</span>(<span class="string">&quot;Could not get RequestDispatcher for [&quot;</span> + getUrl() +</span><br><span class="line">                                   <span class="string">&quot;]: Check that the corresponding file exists within your web application archive!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If already included or response already committed, perform include, else forward.</span></span><br><span class="line">    <span class="keyword">if</span> (useInclude(request, response)) &#123;</span><br><span class="line">        response.setContentType(getContentType());</span><br><span class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;Including [&quot;</span> + getUrl() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        rd.include(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Note: The forwarded resource is supposed to determine the content type itself.</span></span><br><span class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;Forwarding to [&quot;</span> + getUrl() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        rd.forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h3><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.4.3/reference/html/spring-boot-features.html#boot-features-developing-web-applications">官方文档</a></p><h4 id="SpringBoot-Web-MVC-Framework"><a href="#SpringBoot-Web-MVC-Framework" class="headerlink" title="SpringBoot Web MVC Framework"></a>SpringBoot Web MVC Framework</h4><h5 id="1-Inclusion-of-ContentNegotiatingViewResolver-and-BeanNameViewResolver-beans"><a href="#1-Inclusion-of-ContentNegotiatingViewResolver-and-BeanNameViewResolver-beans" class="headerlink" title="1. Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans."></a>1. Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</h5><ul><li><p>自动配置了视图解析器：根据方法返回值得到视图对象，视图对象决定页面如何渲染</p></li><li><p>ContentNegotiatingViewResolver：用于组合所有视图解析器</p><p><img src="/posts/1864766114/image-20210226163508330.png" alt="image-20210226163508330"></p><p><img src="/posts/1864766114/image-20210226163149713.png" alt="image-20210226163149713"></p><ul><li>将所有的viewResolvers装配到servletcontext中</li></ul><p><strong>可以自己给容器中添加一个ViewResolver;自动将其组合进IoC容器</strong></p></li></ul><h5 id="2-Support-for-serving-static-resources-including-support-for-WebJars"><a href="#2-Support-for-serving-static-resources-including-support-for-WebJars" class="headerlink" title="2. Support for serving static resources, including support for WebJars ."></a>2. Support for serving static resources, including support for WebJars .</h5><p>静态资源路径，支持webjars</p><h5 id="3-Static-index-html-support"><a href="#3-Static-index-html-support" class="headerlink" title="3. Static index.html support."></a>3. Static <code>index.html</code> support.</h5><p>静态首页访问</p><h5 id="4-Automatic-registration-of-Converter-GenericConverter-and-Formatter-beans"><a href="#4-Automatic-registration-of-Converter-GenericConverter-and-Formatter-beans" class="headerlink" title="4. Automatic registration of Converter, GenericConverter, and Formatter beans."></a>4. Automatic registration of <code>Converter</code>, <code>GenericConverter</code>, and <code>Formatter</code> beans.</h5><p><code>converter(转换器)</code>:前端提交的数据自动封装为相应的POJO</p><p><code>Formatter(格式化器)</code>:字符串_&gt;Date类型</p><ul><li><img src="/posts/1864766114/image-20210226164737142.png" alt="image-20210226164737142"></li></ul><p><img src="/posts/1864766114/image-20210226165131407.png" alt="image-20210226165131407"></p><p><strong>自己添加的 formatter，只需要注册到容器中即可</strong></p><h5 id="5-Support-for-HttpMessageConverters"><a href="#5-Support-for-HttpMessageConverters" class="headerlink" title="5. Support for HttpMessageConverters ."></a>5. Support for <code>HttpMessageConverters</code> .</h5><blockquote><p>SpringMVC用来转换Http请求和响应</p><p>​ POJO-User_&gt;JSON</p></blockquote><p><img src="/posts/1864766114/image-20210226165701261.png" alt="image-20210226165701261"></p><p>只有一个有参构造器，其参数都是从容器中获取</p><p><strong>自己添加的 HttpMessageConverters，只需要注册到容器中即可</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.http.HttpMessageConverters;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> HttpMessageConverters <span class="title function_">customConverters</span><span class="params">()</span> &#123;</span><br><span class="line">        HttpMessageConverter&lt;?&gt; additional = ...</span><br><span class="line">        HttpMessageConverter&lt;?&gt; another = ...</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HttpMessageConverters</span>(additional, another);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="6-Automatic-registration-of-MessageCodesResolver"><a href="#6-Automatic-registration-of-MessageCodesResolver" class="headerlink" title="6. Automatic registration of MessageCodesResolver ."></a>6. Automatic registration of <code>MessageCodesResolver</code> .</h5><p>消息编码解析器；定义错误代码生成规则</p><p><img src="/posts/1864766114/image-20210226170412960.png" alt="image-20210226170412960"></p><h5 id="7-Automatic-use-of-a-ConfigurableWebBindingInitializer-bean"><a href="#7-Automatic-use-of-a-ConfigurableWebBindingInitializer-bean" class="headerlink" title="7. Automatic use of a ConfigurableWebBindingInitializer bean."></a>7. Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean.</h5><p><img src="/posts/1864766114/image-20210226170618218.png" alt="image-20210226170618218"></p><p>从容器中获取一个组件</p><p><img src="/posts/1864766114/image-20210226170702724.png" alt="image-20210226170702724"></p><p>初始化WebDataBinder</p><p>请求数据__JavaBean</p><h4 id="扩展MVC功能"><a href="#扩展MVC功能" class="headerlink" title="扩展MVC功能"></a>扩展MVC功能</h4><p>If you want to keep those Spring Boot MVC customizations and make more <a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/5.3.4/reference/html/web.html#mvc">MVC customizations</a> (interceptors, formatters, view controllers, and other features), you can add your own <code>@Configuration</code> class of interface <code>WebMvcConfigurer</code> but <strong>without</strong> <code>@EnableWebMvc</code>.</p><p><img src="/posts/1864766114/image-20210224180352060.png" alt="image-20210224180352060"></p><h5 id="实现页面跳转-拦截器"><a href="#实现页面跳转-拦截器" class="headerlink" title="实现页面跳转+拦截器"></a>实现页面跳转+拦截器</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ToPageController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toHello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--拦截器配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--拦截这个请求下的所有请求--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置拦截器--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.kuang.config.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInteceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__方法执行前!__&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            * return true;放行</span></span><br><span class="line"><span class="comment">            * */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__方法完成后!__&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__清理__&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>扩展SpringMVC,_互补配置_</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * WebMvcConfigurer 用于扩展MVC</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/hello&quot;</span>).setViewName(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInteceptor</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyInteceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__方法执行前!__&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * return true;放行</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__方法完成后!__&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;__清理__&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="配置原则"><a href="#配置原则" class="headerlink" title="配置原则"></a>配置原则</h5><ul><li><p>SpringBoot自动配置组件，先看用户是否自己配置，若用户自定义用户配置，则用用户的；若没有则使用自动配置的；</p></li><li><p>对于同时可存在多个的组件(ViewResolver)，则组合使用。</p><p><img src="/posts/1864766114/image-20210224175103168.png" alt="image-20210224175103168"></p></li></ul><h4 id="自动配置生效原理"><a href="#自动配置生效原理" class="headerlink" title="自动配置生效原理"></a>自动配置生效原理</h4><p><img src="/posts/1864766114/image-20210226180354872.png" alt="image-20210226180354872"></p><ol><li><p>WebMvcAutoConfiguration是SpringMVC的自动配置类</p></li><li><p>@Import(EnableWebMvcConfiguration.class)</p><p><img src="/posts/1864766114/image-20210226184520287.png" alt="image-20210226184520287"></p><p><img src="/posts/1864766114/image-20210226184627774.png" alt="image-20210226184627774"></p><p><img src="/posts/1864766114/image-20210226190411112.png" alt="image-20210226190411112"></p><ul><li><code>addWebMvcConfigurers</code> 将所有实现了WebMvcConfigurer的configuration一起调用</li></ul><p>可见SpringBoot实现的自动配置会与自定义的自动配置一起调用形成_互补配置_</p></li></ol><h3 id="第一个MVC项目"><a href="#第一个MVC项目" class="headerlink" title="第一个MVC项目"></a>第一个MVC项目</h3><h4 id="1-环境搭建"><a href="#1-环境搭建" class="headerlink" title="1. 环境搭建"></a>1. 环境搭建</h4><h5 id="POJO"><a href="#POJO" class="headerlink" title="POJO"></a>POJO</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Department</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String departmentName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">    <span class="keyword">private</span> Department department;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">(Integer id, String lastName, String email, Integer gender, Department department)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.lastName = lastName;</span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">        <span class="built_in">this</span>.department = department;</span><br><span class="line">        <span class="built_in">this</span>.date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Dao"><a href="#Dao" class="headerlink" title="Dao"></a>Dao</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer, Department&gt; departments;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        departments.put(<span class="number">101</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">101</span>,<span class="string">&quot;教学部&quot;</span>));</span><br><span class="line">        departments.put(<span class="number">102</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">102</span>,<span class="string">&quot;市场部&quot;</span>));</span><br><span class="line">        departments.put(<span class="number">103</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">103</span>,<span class="string">&quot;教研部&quot;</span>));</span><br><span class="line">        departments.put(<span class="number">104</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">104</span>,<span class="string">&quot;运营部&quot;</span>));</span><br><span class="line">        departments.put(<span class="number">105</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">105</span>,<span class="string">&quot;后勤部&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;Department&gt; <span class="title function_">getDepartments</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departments.values();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Department <span class="title function_">getDepartmentById</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departments.get(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer,Employee&gt; employees = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        employees = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, Employee&gt;();</span><br><span class="line"></span><br><span class="line">        employees.put(<span class="number">1001</span>,<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1001</span>,<span class="string">&quot;A&quot;</span>,<span class="string">&quot;A123@email.com&quot;</span>,</span><br><span class="line">                <span class="number">1</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">101</span>,<span class="string">&quot;教学部&quot;</span>)));</span><br><span class="line">        employees.put(<span class="number">1002</span>,<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1002</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;B123@email.com&quot;</span>,</span><br><span class="line">                <span class="number">0</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">102</span>,<span class="string">&quot;市场部&quot;</span>)));</span><br><span class="line">        employees.put(<span class="number">1003</span>,<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1003</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;C123@email.com&quot;</span>,</span><br><span class="line">                <span class="number">1</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">103</span>,<span class="string">&quot;教研部&quot;</span>)));</span><br><span class="line">        employees.put(<span class="number">1004</span>,<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1004</span>,<span class="string">&quot;D&quot;</span>,<span class="string">&quot;D123@email.com&quot;</span>,</span><br><span class="line">                <span class="number">0</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">104</span>,<span class="string">&quot;运营部&quot;</span>)));</span><br><span class="line">        employees.put(<span class="number">1005</span>,<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1005</span>,<span class="string">&quot;E&quot;</span>,<span class="string">&quot;E123@email.com&quot;</span>,</span><br><span class="line">                <span class="number">1</span>,<span class="keyword">new</span> <span class="title class_">Department</span>(<span class="number">105</span>,<span class="string">&quot;后勤部&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Integer</span> <span class="variable">initId</span> <span class="operator">=</span> <span class="number">1006</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新增</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(employee.getId()_null)&#123;<span class="comment">//实现自增</span></span><br><span class="line">            employee.setId(initId++);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        employees.put(employee.getId(),employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查找全部</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;Employee&gt; <span class="title function_">getEmployees</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employees.values();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过id查找</span></span><br><span class="line">    <span class="keyword">public</span> Employee <span class="title function_">getEmployeeById</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employees.get(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过id删除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">        employees.remove(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-首页配置"><a href="#2-首页配置" class="headerlink" title="2. 首页配置"></a>2. 首页配置</h4><p>所有的静态资源都要使用 <code>Thymeleaf</code> 接管</p><h5 id="Thymeleaf依赖"><a href="#Thymeleaf依赖" class="headerlink" title="Thymeleaf依赖"></a>Thymeleaf依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-java8time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="Thymeleaf约束"><a href="#Thymeleaf约束" class="headerlink" title="Thymeleaf约束"></a>Thymeleaf约束</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:th=&quot;http://www.thymeleaf.org&quot;</span><br></pre></td></tr></table></figure><h5 id="关闭模板引擎的缓存"><a href="#关闭模板引擎的缓存" class="headerlink" title="关闭模板引擎的缓存"></a>关闭模板引擎的缓存</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">thymeleaf:</span></span><br><span class="line">    <span class="attr">cache:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h5 id="设置首页"><a href="#设置首页" class="headerlink" title="设置首页"></a>设置首页</h5><ol><li><p>不推荐</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> WebMvcConfigurerAdapter <span class="title function_">webMvcConfigurerAdapter</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">WebMvcConfigurerAdapter</span> <span class="variable">adapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurerAdapter</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">            registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">            registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> adapter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li></li></ol><p><img src="/posts/1864766114/image-20210224204653626.png" alt="image-20210224204653626"></p><ol><li>【推荐使用】</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="设置路径前缀"><a href="#设置路径前缀" class="headerlink" title="设置路径前缀"></a>设置路径前缀</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/t</span></span><br></pre></td></tr></table></figure><h5 id="将静态资源交给Thymeleaf统一管理"><a href="#将静态资源交给Thymeleaf统一管理" class="headerlink" title="将静态资源交给Thymeleaf统一管理"></a>将静态资源交给Thymeleaf统一管理</h5><p><img src="/posts/1864766114/image-20210224215124654.png" alt="image-20210224215124654"></p><h4 id="3-国际化"><a href="#3-国际化" class="headerlink" title="3. 国际化"></a>3. 国际化</h4><p><strong>之前</strong></p><ol><li>编写国际化配置文件</li><li>使用ResourceBUndleMessageSource管理国际化资源</li><li>在页面使用fmt:message取出国际化内容</li></ol><p><strong>SpringBoot原理</strong></p><p>国际化Locale(区域信息对象)</p><p>LocaleResolver(获取区域信息对象)</p><p><img src="/posts/1864766114/image-20210227093127936.png" alt="image-20210227093127936"></p><ul><li>给容器中添加LocaleResolver组件</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> LocaleResolver&#125; implementation that simply uses the primary locale specified in the &quot;accept-language&quot; header of the HTTP request (that is the locale sent by the client browser, normally that of the client&#x27;s OS).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AcceptHeaderLocaleResolver</span> <span class="keyword">implements</span> <span class="title class_">LocaleResolver</span> &#123;</span><br><span class="line">    <span class="comment">/*如果没有指定locale，则用浏览器默认的语言*/</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Locale <span class="title function_">resolveLocale</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">		<span class="type">Locale</span> <span class="variable">defaultLocale</span> <span class="operator">=</span> getDefaultLocale();</span><br><span class="line">		<span class="keyword">if</span> (defaultLocale != <span class="literal">null</span> &amp;&amp; request.getHeader(<span class="string">&quot;Accept-Language&quot;</span>) _ <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultLocale;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">Locale</span> <span class="variable">requestLocale</span> <span class="operator">=</span> request.getLocale();</span><br><span class="line">		List&lt;Locale&gt; supportedLocales = getSupportedLocales();</span><br><span class="line">		<span class="keyword">if</span> (supportedLocales.isEmpty() || supportedLocales.contains(requestLocale)) &#123;</span><br><span class="line">			<span class="keyword">return</span> requestLocale;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">Locale</span> <span class="variable">supportedLocale</span> <span class="operator">=</span> findSupportedLocale(request, supportedLocales);</span><br><span class="line">		<span class="keyword">if</span> (supportedLocale != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> supportedLocale;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> (defaultLocale != <span class="literal">null</span> ? defaultLocale : requestLocale);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(&quot;spring.web&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Locale to use. By default, this locale is overridden by the &quot;Accept-Language&quot;</span></span><br><span class="line"><span class="comment">	 * header.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> Locale locale;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Define how the locale should be resolved.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">LocaleResolver</span> <span class="variable">localeResolver</span> <span class="operator">=</span> LocaleResolver.ACCEPT_HEADER;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">LocaleResolver</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * Always use the configured locale.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		FIXED,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * Use the &quot;Accept-Language&quot; header or the configured locale if the header is not</span></span><br><span class="line"><span class="comment">		 * set.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		ACCEPT_HEADER</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>默认的就是根据请求头带来的区域信息获取Locale进行国际化</p><p><img src="/posts/1864766114/image-20210227093632333.png" alt="image-20210227093632333"></p><blockquote><p>自定义组件只需要实现 <code>LocaleResolver</code> 接口即可</p></blockquote><p><strong>步骤</strong></p><h5 id="1-编写到国际化配置文件中，抽取页面需要显示的国际化消息"><a href="#1-编写到国际化配置文件中，抽取页面需要显示的国际化消息" class="headerlink" title="1. 编写到国际化配置文件中，抽取页面需要显示的国际化消息"></a>1. 编写到国际化配置文件中，抽取页面需要显示的国际化消息</h5><p><img src="/posts/1864766114/image-20210224222417611.png" alt="image-20210224222417611"></p><p><img src="/posts/1864766114/image-20210224222954196.png" alt="image-20210224222954196"></p><p><img src="/posts/1864766114/image-20210227082052346.png" alt="image-20210227082052346"></p><h5 id="2-SpringBoot自动配置好了管理国际化的组件"><a href="#2-SpringBoot自动配置好了管理国际化的组件" class="headerlink" title="2. SpringBoot自动配置好了管理国际化的组件"></a>2. SpringBoot自动配置好了管理国际化的组件</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Conditional(ResourceBundleCondition.class)</span></span><br><span class="line"><span class="comment">//String basename = context.getEnvironment().getProperty(&quot;spring.messages.basename&quot;, &quot;messages&quot;);</span></span><br><span class="line"><span class="comment">//自定义的配置文件可以放在类路径下叫messages.properties</span></span><br><span class="line"><span class="comment">//若不指定，则从类路径下根路径寻找</span></span><br><span class="line"><span class="comment">//ConditionOutcome outcome = cache.get(basename);</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageSourceAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(prefix = &quot;spring.messages&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> MessageSourceProperties <span class="title function_">messageSourceProperties</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MessageSourceProperties</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MessageSource <span class="title function_">messageSource</span><span class="params">(MessageSourceProperties properties)</span> &#123;</span><br><span class="line">        <span class="type">ResourceBundleMessageSource</span> <span class="variable">messageSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceBundleMessageSource</span>();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.hasText(properties.getBasename())) &#123;</span><br><span class="line">            <span class="comment">//设置国际化资源文件的基础名（去掉语言国家代码）</span></span><br><span class="line">            messageSource.setBasenames(StringUtils</span><br><span class="line">                                       .commaDelimitedListToStringArray(StringUtils.trimAllWhitespace(properties.getBasename())));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (properties.getEncoding() != <span class="literal">null</span>) &#123;</span><br><span class="line">            messageSource.setDefaultEncoding(properties.getEncoding().name());</span><br><span class="line">        &#125;</span><br><span class="line">        messageSource.setFallbackToSystemLocale(properties.isFallbackToSystemLocale());</span><br><span class="line">        <span class="type">Duration</span> <span class="variable">cacheDuration</span> <span class="operator">=</span> properties.getCacheDuration();</span><br><span class="line">        <span class="keyword">if</span> (cacheDuration != <span class="literal">null</span>) &#123;</span><br><span class="line">            messageSource.setCacheMillis(cacheDuration.toMillis());</span><br><span class="line">        &#125;</span><br><span class="line">        messageSource.setAlwaysUseMessageFormat(properties.isAlwaysUseMessageFormat());</span><br><span class="line">        messageSource.setUseCodeAsDefaultMessage(properties.isUseCodeAsDefaultMessage());</span><br><span class="line">        <span class="keyword">return</span> messageSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-修改配置文件路径"><a href="#3-修改配置文件路径" class="headerlink" title="3. 修改配置文件路径"></a>3. 修改配置文件路径</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">messages:</span></span><br><span class="line">    <span class="attr">basename:</span> <span class="string">i18n.login</span></span><br></pre></td></tr></table></figure><h5 id="4-修改国际化的属性"><a href="#4-修改国际化的属性" class="headerlink" title="4. 修改国际化的属性"></a>4. 修改国际化的属性</h5><p><img src="/posts/1864766114/image-20210224223826116.png" alt="image-20210224223826116"></p><h5 id="5-自定义国际化组件"><a href="#5-自定义国际化组件" class="headerlink" title="5. 自定义国际化组件"></a>5. 自定义国际化组件</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.LocaleResolver;</span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Auspice Tian</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@time</span> 2021-02-27 9:56</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@current</span> springboot-03-web-com.springboot.component</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLocaleResolver</span> <span class="keyword">implements</span> <span class="title class_">LocaleResolver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Locale <span class="title function_">resolveLocale</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">//强制使用系统的区域信息   浏览器改语言失效</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">language</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;l&quot;</span>);</span><br><span class="line">        System.out.println(language);</span><br><span class="line"></span><br><span class="line">        <span class="type">Locale</span> <span class="variable">locale</span> <span class="operator">=</span> Locale.getDefault();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果链接携带了国际化参数</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(language))&#123;</span><br><span class="line">            String[] split = language.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">            locale = <span class="keyword">new</span> <span class="title class_">Locale</span>(split[<span class="number">0</span>],split[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> locale;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLocale</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Locale locale)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> LocaleResolver <span class="title function_">localeResolver</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyLocaleResolver</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-登录-拦截器"><a href="#4-登录-拦截器" class="headerlink" title="4. 登录+拦截器"></a>4. 登录+拦截器</h4><h5 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h5><ol><li>前端表单传入数据，LoginController处理，验证正确，则返回后台页面(dashboard)；验证错误，携带信息返回登录页面</li><li>开发期间，使用模板引擎的注意点<ul><li>禁用Thymeleaf缓存</li><li>页面修改完后，重新编译</li></ul></li><li>登录失败后，显示错误提示信息<ul><li>Thymeleaf属性优先级</li><li>th:if语法</li></ul></li></ol><p>实现：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;form-signin&quot;</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/asserts/img/bootstrap-solid.svg&#125;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">width</span>=<span class="string">&quot;72&quot;</span> <span class="attr">height</span>=<span class="string">&quot;72&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;h3 mb-3 font-weight-normal&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;#&#123;login.tip&#125;&quot;</span>&gt;</span>Please sign in<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;not #strings.isEmpty(msg)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">th:placeholder</span>=<span class="string">&quot;#&#123;login.username&#125;&quot;</span> <span class="attr">required</span>=<span class="string">&quot;&quot;</span> <span class="attr">autofocus</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">th:placeholder</span>=<span class="string">&quot;#&#123;login.password&#125;&quot;</span> <span class="attr">required</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String username,</span></span><br><span class="line"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span> String password,</span></span><br><span class="line"><span class="params">                        Map&lt;String ,Object&gt; map</span></span><br><span class="line"><span class="params">                        )</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username) &amp;&amp; password.equals(<span class="string">&quot;1&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">//若用户名不空，且密码等于1，登录成功</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;dashboard&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户密码错误!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>考虑到刷新页面 <code>重新提交表单</code>问题</p></blockquote><p><img src="/posts/1864766114/image-20210227113118384.png" alt="image-20210227113118384"></p><p>使用 return “redirect:/dashboard.html”</p><h5 id="防止表单重复提交——重定向"><a href="#防止表单重复提交——重定向" class="headerlink" title="防止表单重复提交——重定向"></a>防止表单重复提交——重定向</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String username,</span></span><br><span class="line"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span> String password,</span></span><br><span class="line"><span class="params">                        Map&lt;String ,Object&gt; map</span></span><br><span class="line"><span class="params">                        )</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username) &amp;&amp; password.equals(<span class="string">&quot;1&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">//若用户名不空，且密码等于1，登录成功</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/dashboard&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户密码错误!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>新问题：直接输入地址，会跳转到目标页面</p><p>解决：使用拦截器，拦截非法请求</p></blockquote><h5 id="拦截器进行登录检查"><a href="#拦截器进行登录检查" class="headerlink" title="拦截器进行登录检查"></a>拦截器进行登录检查</h5><ol><li><p>将登录状态加入到session中</p></li><li><p>拦截的情况：</p></li></ol><ul><li>没有登录_&gt;session中，user为null</li></ul><ol><li><p>放行的情况：</p><ul><li>用户已经登录</li></ul></li><li><p>注册拦截器<code>WebMvcConfigurerAdapter.addInterceptor</code></p><ul><li><p>使用拦截器的请求 <code>~.addPathPatterns()</code></p><p>所有请求</p></li><li><p>不使用拦截器的请求<code>~.excludePathPatterns()</code></p><p>首页、登录提交表单</p></li></ul></li></ol><p>实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String username,</span></span><br><span class="line"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span> String password,</span></span><br><span class="line"><span class="params">                        Map&lt;String ,Object&gt; map,</span></span><br><span class="line"><span class="params">                        HttpSession session</span></span><br><span class="line"><span class="params">                        )</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username) &amp;&amp; password.equals(<span class="string">&quot;1&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">//若用户名不空，且密码等于1，登录成功</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,username);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/dashboard&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户密码错误!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">                             HttpServletResponse response,</span></span><br><span class="line"><span class="params">                             Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">loginUser</span> <span class="operator">=</span> request.getSession().getAttribute(<span class="string">&quot;loginUser&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(loginUser _ <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//未登录，拦截</span></span><br><span class="line">            request.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;未登录，没有权限!&quot;</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">&quot;/&quot;</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//已登录，放行</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//SpringBoot已经做好了静态资源映射</span></span><br><span class="line">    registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInterceptor</span>())</span><br><span class="line">        .addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">        .excludePathPatterns(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;index.html&quot;</span>,<span class="string">&quot;/user/login&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-CRUD"><a href="#5-CRUD" class="headerlink" title="5. CRUD"></a>5. CRUD</h4><p>要求</p><ol><li><p>restfulCRUD:CRUD满足Rest风格</p><p>URI:资源名称/资源表示</p><p>HTTP请求方式区分对资源的CRUD操作</p></li></ol><div class="table-container"><table><thead><tr><th></th><th>普通CRUD(URI区分资源操作)</th><th>RestfulCRUD()</th></tr></thead><tbody><tr><td>查询</td><td>getEmp</td><td>emp————Get方式</td></tr><tr><td>添加</td><td>addEmp?XXX</td><td>emp————POST方式</td></tr><tr><td>修改</td><td>updateEmp?XXX</td><td>emp/{id}——PUT方式</td></tr><tr><td>删除</td><td>deleteEmp?id=</td><td>emp/{id}——DELETE方式</td></tr></tbody></table></div><ol><li>实验的请求架构</li></ol><div class="table-container"><table><thead><tr><th></th><th>请求URI</th><th>请求方式</th></tr></thead><tbody><tr><td>查询所有员工</td><td>emps</td><td>GET</td></tr><tr><td>查询某个员工</td><td>emp/{id}</td><td>GET</td></tr><tr><td>跳转添加页面</td><td>emp</td><td>GET</td></tr><tr><td>添加员工</td><td>emp</td><td>POST</td></tr><tr><td>跳转修改页面(查出员工进行信息回显)</td><td>emp/{id}</td><td>GET</td></tr><tr><td>修改员工</td><td>emp</td><td>PUT</td></tr><tr><td>删除员工</td><td>emp/{id}</td><td>GET</td></tr></tbody></table></div><h5 id="R——列表页面"><a href="#R——列表页面" class="headerlink" title="R——列表页面"></a>R——列表页面</h5><ol><li><p>前端点击 员工信息 _&gt; 发送emps请求</p><p><img src="/posts/1864766114/image-20210227213638344.png" alt="image-20210227213638344"></p></li><li><p>EmpController处理，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeDao employeeDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/emps&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">emps</span><span class="params">(Model model)</span>&#123;</span><br><span class="line"></span><br><span class="line">        Collection&lt;Employee&gt; employees = employeeDao.getEmployees();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//将信息放在请求域中返回</span></span><br><span class="line">        model.addAttribute(<span class="string">&quot;emps&quot;</span>,employees);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//thymeleaf默认拼串</span></span><br><span class="line">        <span class="comment">//classpath:/templates/xxx.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;emp/list&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>公共元素抽取</p><ol><li><p>公共片段抽取 th:fragment</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:fragment</span>=<span class="string">&quot;copy&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>引入公共片段</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;footer::copy&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">~&#123;templatename::selector&#125; 模板名::选择器</span><br><span class="line">~&#123;templatename::fragmentname&#125; 模板名::片段名</span><br></pre></td></tr></table></figure></li></ol><p>三种引入功能片段的th属性</p><p>th:insert 将公共片段整个插入到声明引入的元素中</p><p>th:replace 将声明引入的元素替换为公共片段</p><p>th:include 将被引入的片段的内容包含进声明引入的元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">th:fragment</span>=<span class="string">&quot;copy&quot;</span>&gt;</span></span><br><span class="line">  <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!----&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;footer :: copy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;footer :: copy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:include</span>=<span class="string">&quot;footer :: copy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!----&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">        <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>导航栏+侧边栏</p><p><img src="/posts/1864766114/image-20210227214229599.png" alt="image-20210227214229599"></p><p><img src="/posts/1864766114/image-20210227214157642.png" alt="image-20210227214157642"></p></li></ol><h6 id="链接高亮——页面块参数"><a href="#链接高亮——页面块参数" class="headerlink" title="链接高亮——页面块参数"></a>链接高亮——页面块参数</h6><ol><li>抽取公共块到一个文件下</li></ol><p><img src="/posts/1864766114/image-20210227222235836.png" alt="image-20210227222235836"></p><p><img src="/posts/1864766114/image-20210227224116202.png" alt="image-20210227224116202"></p><p><img src="/posts/1864766114/image-20210227224123870.png" alt="image-20210227224123870"></p><p><img src="/posts/1864766114/image-20210227224056842.png" alt="image-20210227224056842"></p><h6 id="Thymeleaf遍历取出数据-数据格式调整-列表界面"><a href="#Thymeleaf遍历取出数据-数据格式调整-列表界面" class="headerlink" title="Thymeleaf遍历取出数据+数据格式调整+列表界面"></a>Thymeleaf遍历取出数据+数据格式调整+列表界面</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-success&quot;</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;table-responsive&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-striped table-sm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>LashName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>DepartmentName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;emp:$&#123;emps&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.lastName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.gender&#125;_0?&#x27;女&#x27;:&#x27;男&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.department.departmentName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(emp.birth,&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-primary&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="C——新增"><a href="#C——新增" class="headerlink" title="C——新增"></a>C——新增</h5><h6 id="跳转到新增页面-表单"><a href="#跳转到新增页面-表单" class="headerlink" title="跳转到新增页面+表单"></a>跳转到新增页面+表单</h6><p><img src="/posts/1864766114/image-20210228122338104.png" alt="image-20210228122338104"></p><p><img src="/posts/1864766114/image-20210228122351983.png" alt="image-20210228122351983"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">main</span> <span class="attr">role</span>=<span class="string">&quot;main&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-md-9 ml-sm-auto col-lg-10 pt-3 px-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">        编辑员工信息</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emps/add&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;auspicetian&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;auspicetian@email.com&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">checked</span> <span class="attr">th:value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Department<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">&quot;depart:$&#123;departments&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;depart.id&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;depart.departmentName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;2021-02-28&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br></pre></td></tr></table></figure><h6 id="新增行为"><a href="#新增行为" class="headerlink" title="新增行为"></a>新增行为</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/emps/toAdd&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toAdd</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    <span class="comment">//跳转添加页面</span></span><br><span class="line">    <span class="comment">//返回部门信息</span></span><br><span class="line">    Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line"></span><br><span class="line">    model.addAttribute(<span class="string">&quot;departments&quot;</span>,departments);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;emp/add&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;/emps/add&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Employee&quot;</span>+employee);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//转发到指定请求，直接返回会由Thymeleaf进行拼串</span></span><br><span class="line">    <span class="comment">//redirect:重定向到一个地址  /代表当前项目</span></span><br><span class="line">    <span class="comment">//forward:转发到一个地址</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="添加数据-日期类型格式转换"><a href="#添加数据-日期类型格式转换" class="headerlink" title="添加数据+日期类型格式转换"></a>添加数据+日期类型格式转换</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/emps/toAdd&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toAdd</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    <span class="comment">//跳转添加页面</span></span><br><span class="line">    <span class="comment">//返回部门信息</span></span><br><span class="line">    Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line"></span><br><span class="line">    model.addAttribute(<span class="string">&quot;departments&quot;</span>,departments);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;emp/add&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;/emps/add&quot;)</span></span><br><span class="line"><span class="comment">//SpringMVC自动将请求参数可前端参数的属性进行一一绑定</span></span><br><span class="line"><span class="comment">//前提：javaBean属性和前端的name属性名一致</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Employee&quot;</span>+employee);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//转发到指定请求，直接返回会由Thymeleaf进行拼串</span></span><br><span class="line">    <span class="comment">//redirect:重定向到一个地址  /代表当前项目</span></span><br><span class="line">    <span class="comment">//forward:转发到一个地址</span></span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>提交的数据格式不对 ：生日:日期;</p><p>日期格式化；SpringMVC将页面提交的值需要转换为指定类型</p><p>类型转换，格式化</p><p>默认日期是按照 <code>2021/02/28</code> 方式</p><p><img src="/posts/1864766114/image-20210228202206435.png" alt="image-20210228202206435"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"> <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">format:</span></span><br><span class="line">      <span class="attr">date:</span> <span class="string">yyyy-MM-dd</span></span><br></pre></td></tr></table></figure><h5 id="UD有天坑——开启HiddenHttpMethodFilter"><a href="#UD有天坑——开启HiddenHttpMethodFilter" class="headerlink" title="UD有天坑——开启HiddenHttpMethodFilter"></a>UD有天坑——开启<code>HiddenHttpMethodFilter</code></h5><p>对于POST请求，接收 <code>_method</code>参数，判断URI类型</p><p><img src="/posts/1864766114/image-20210301101454202.png" alt="image-20210301101454202"></p><p><img src="/posts/1864766114/image-20210301101706862.png" alt="image-20210301101706862"></p><p>springBoot装配SpringMVC时，默认关闭请求过滤器，所以需要在配置文件中开启</p><p>虽然请求方式仍为POST，但会转发为PUT请求方式</p><h5 id="U——修改-Thymeleaf条件判断"><a href="#U——修改-Thymeleaf条件判断" class="headerlink" title="U——修改+Thymeleaf条件判断"></a>U——修改+Thymeleaf条件判断</h5><ol><li>参数跳转</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-primary&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/emps/update/&#x27;+$&#123;emp.id&#125;&#125;&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li><p>到修改页面，信息回显</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/emps/update/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toupdate</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id,Model model)</span>&#123;</span><br><span class="line"></span><br><span class="line">    Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">    model.addAttribute(<span class="string">&quot;departments&quot;</span>,departments);</span><br><span class="line"></span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeDao.getEmployeeById(id);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;emp&quot;</span>,employee);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//回到新增页面。复用</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;emp/add&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.lastName&#125;:&#x27;&#x27;&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;auspicetian&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;auspicetian@email.com&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.email&#125;:&#x27;&#x27;&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">checked</span> <span class="attr">th:value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.gender&#125;_1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.gender&#125;_0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Department<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;depart.id_emp.id&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;depart:$&#123;departments&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;depart.id&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;depart.departmentName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;#dates.format(emp.birth,&#x27;yyyy-MM-dd HH-mm-ss&#x27;)&#125;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;2021-02-28&quot;</span> <span class="attr">required</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp!=null&#125;?&#x27;修改&#x27;:&#x27;添加&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>修改请求方式</p><p>之前的 <code>PutMapping</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--发送put请求修改员工数据</span></span><br><span class="line"><span class="comment">1. SpringMVC中配置HiddenHttpMethodFilter(SpringBoot自动配置)</span></span><br><span class="line"><span class="comment">2. 页面创建一个post表单</span></span><br><span class="line"><span class="comment">3. 创建一个input项，name=&quot;_method&quot;，值就是指定的请求方式</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emps/au&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--发送put请求修改员工数据</span></span><br><span class="line"><span class="comment">1. SpringMVC中配置HiddenHttpMethodFilter(SpringBoot自动配置)</span></span><br><span class="line"><span class="comment">2. 页面创建一个post表单</span></span><br><span class="line"><span class="comment">3. 创建一个input项，name=&quot;_method&quot;，值就是指定的请求方式</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;emp!=null&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping(&quot;/emps/au&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">update</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;修改的员工数据&quot;</span>+employee);</span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>参数为 <code>id</code>，避免重复添加</p></li></ol><p><img src="/posts/1864766114/image-20210228205649247.png" alt="image-20210228205649247"></p><h5 id="D——Thymeleaf自定义属性值"><a href="#D——Thymeleaf自定义属性值" class="headerlink" title="D——Thymeleaf自定义属性值"></a>D——Thymeleaf自定义属性值</h5><p><img src="/posts/1864766114/image-20210301110306283.png" alt="image-20210301110306283"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;/emps/delete/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line"></span><br><span class="line">    employeeDao.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>问题：每一个表项都会创建一个表单</p></blockquote><h6 id="Thymeleaf自定义属性值"><a href="#Thymeleaf自定义属性值" class="headerlink" title="Thymeleaf自定义属性值"></a>Thymeleaf自定义属性值</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../images/gtvglogo.png&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">th:attr</span>=<span class="string">&quot;src=@&#123;/images/gtvglogo.png&#125;,title=#&#123;logo&#125;,alt=#&#123;logo&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210301120113925.png" alt="image-20210301120113925"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    $(<span class="string">&quot;.delBtn&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $(<span class="string">&#x27;#delForm&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&quot;action&quot;</span>,$(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&quot;delUri&quot;</span>)).<span class="title function_">submit</span>()</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;/emps/delete/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line"></span><br><span class="line">    employeeDao.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="错误处理机制"><a href="#错误处理机制" class="headerlink" title="错误处理机制"></a>错误处理机制</h2><ol><li>返回一个默认错误页面</li></ol><p><img src="/posts/1864766114/image-20210301120429885.png" alt="image-20210301120429885"></p><p><img src="/posts/1864766114/image-20210301163342791.png" alt="image-20210301163342791"></p><ol><li>其他客户端，默认响应一个JSON数据</li></ol><p><img src="/posts/1864766114/image-20210301120530935.png" alt="image-20210301120530935"></p><p><img src="/posts/1864766114/image-20210301163439031.png" alt="image-20210301163439031"></p><h3 id="处理机制"><a href="#处理机制" class="headerlink" title="处理机制"></a>处理机制</h3><blockquote><p>参照<code>ErrorMvcAutoConfiguration</code></p></blockquote><h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤:"></a>步骤:</h4><p>一旦系统出现4XX或者5XX，<code>ErrorPageCustomizer</code> 就会生效（定制错误的响应规则）； 发送<code>/error</code>请求，由 <code>BasicErrorController</code> 处理 /error 请求；响应处理中携带的信息由<code>DefaultErrorAttriute</code>指定</p><p>返回结果_&gt;</p><ul><li><p>响应页面:去哪个页面由<code>DefaultErrorViewResolver</code>解析得到，将错误信息(status,model)发送给所有的ErrorViewResolver,得到ModelAndView</p><ul><li>若有 ErrorViewResolver ，使用自定义的</li><li>若没有ErrorViewResolver,则时候用 <code>DefaultErrorViewResolver</code></li></ul><p><img src="/posts/1864766114/image-20210301181722341.png" alt="image-20210301181722341"></p></li><li><p>响应JSON数据</p></li></ul><h4 id="涉及到的组件"><a href="#涉及到的组件" class="headerlink" title="涉及到的组件"></a>涉及到的组件</h4><ol><li><p>ErrorPageCustomizer</p><p><img src="/posts/1864766114/image-20210301122623056.png" alt="image-20210301122623056"></p><p>系统出现错误以后，来到 <code>/error请求</code> 进行处理</p></li><li><p>BasicErrorController</p><p><img src="/posts/1864766114/image-20210301180355956.png" alt="image-20210301180355956"></p><ul><li>浏览器发来的请求用 <code>errorHtml()</code> 方法处理,产生html类型的数据</li><li>其他客户端发来的数据用 <code>ResponseEntity()</code>,产生JSON类型的数据</li></ul></li><li><p>DefaultErroViewResolver</p><p><img src="/posts/1864766114/image-20210301183137958.png" alt="image-20210301183137958"></p></li><li><p>DefaultErrorAttributes</p><p><img src="/posts/1864766114/image-20210301184222365.png" alt="image-20210301184222365"></p><p>由errorAattributes指定返回给页面的错误信息</p></li></ol><h3 id="如何定制错误页面？"><a href="#如何定制错误页面？" class="headerlink" title="如何定制错误页面？"></a>如何定制错误页面？</h3><h4 id="1-有模板引擎"><a href="#1-有模板引擎" class="headerlink" title="_1. 有模板引擎_"></a>_1. 有模板引擎_</h4><ul><li>将错误页面命名为 <code>错误状态.html</code>，放在模板引擎文件文件夹下的error文件夹下</li><li>发生哪个错误状态码，跳转到哪个页面 <code>error/状态码</code></li></ul><p>可以使用4XX,和5XX作为错误页面的文件名用于匹配这种类型的所有错误</p><p><strong>优先寻找精确的状态码.html</strong></p><p><img src="/posts/1864766114/image-20210301164601358.png" alt="image-20210301164601358"></p><p>页面能获取的信息</p><ul><li>timestamp</li><li>status</li><li>error错误提示</li><li>exception：异常对象</li><li>message：异常消息</li><li>errors:JSR303数据校验错误</li></ul><h5 id="Thymeleaf开启接收异常信息"><a href="#Thymeleaf开启接收异常信息" class="headerlink" title="Thymeleaf开启接收异常信息"></a>Thymeleaf开启接收异常信息</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">    <span class="attr">error:</span></span><br><span class="line">      <span class="attr">include-exception:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">include-message:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210301202423757.png" alt="image-20210301202423757"></p><h4 id="2-模板引擎找不到错误页面"><a href="#2-模板引擎找不到错误页面" class="headerlink" title="2. 模板引擎找不到错误页面"></a>2. 模板引擎找不到错误页面</h4><p>静态资源文件夹下</p><h4 id="3-以上都没有"><a href="#3-以上都没有" class="headerlink" title="3. 以上都没有"></a>3. 以上都没有</h4><p>SpringBoot默认的错误提示页面</p><p><img src="/posts/1864766114/image-20210301185226902.png" alt="image-20210301185226902"></p><p>默认空白页内容：</p><p><img src="/posts/1864766114/image-20210301185220385.png" alt="image-20210301185220385"></p><p><img src="/posts/1864766114/image-20210301185226902.png" alt="image-20210301185226902"></p><h3 id="如何定制错误的JSON数据"><a href="#如何定制错误的JSON数据" class="headerlink" title="如何定制错误的JSON数据?"></a>如何定制错误的JSON数据?</h3><h4 id="1-ExceptionHandler-XXX-class"><a href="#1-ExceptionHandler-XXX-class" class="headerlink" title="1. @ExceptionHandler(XXX.class)"></a>1. @ExceptionHandler(XXX.class)</h4><p>自定义异常</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserNotExistException</span> <span class="keyword">extends</span> <span class="title class_">Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserNotExistException</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>(<span class="string">&quot;用户不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异常处理器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(UserNotExistException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">handleException</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;user.notexist&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;message&quot;</span>,e.getMessage());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异常验证</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionController</span> &#123;</span><br><span class="line">	<span class="comment">//浏览器客户端都是JSON数据</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/exception&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">exception</span><span class="params">(<span class="meta">@RequestParam(&quot;u&quot;)</span> String u)</span> <span class="keyword">throws</span> UserNotExistException &#123;</span><br><span class="line">        <span class="keyword">if</span>(u.equals(<span class="string">&quot;u&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UserNotExistException</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210301192540428.png" alt="image-20210301192540428"></p><p>问题：没有自适应效果</p><ul><li>浏览器，客户端的返回都是JSON</li></ul><p>_&gt;如何变成错误请求自适应响应</p><h4 id="2-转发到-error-请求"><a href="#2-转发到-error-请求" class="headerlink" title="2. 转发到 /error 请求"></a>2. 转发到 /error 请求</h4><p><img src="/posts/1864766114/image-20210301192812288.png" alt="image-20210301192812288"></p><p>由 <code>BasicErrorController</code>处理</p><p><img src="/posts/1864766114/image-20210301204415789.png" alt="image-20210301204415789"></p><p>响应的的是默认空白页面，想要的是跳转到自定义的错误页面</p><p><img src="/posts/1864766114/image-20210301200549284.png" alt="image-20210301200549284"></p><p>原因</p><blockquote><p>状态码，2开头表示请求成功，之前的错误视图都是4开头</p></blockquote><p>响应页面设置状态码</p><blockquote><p>从HttpRequest中获取状态码</p></blockquote><p><img src="/posts/1864766114/image-20210301201247349.png" alt="image-20210301201247349"></p><p><img src="/posts/1864766114/image-20210301201101370.png" alt="image-20210301201101370"></p><blockquote><p>传入自己的错误状态码</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(UserNotExistException.class)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">handleException</span><span class="params">(Exception e, HttpServletRequest request)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">/*必须传入 错误代码status  否则不会进入自定义错误页面</span></span><br><span class="line"><span class="comment">        * Integer statusCode = (Integer) request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;javax.servlet.error.status_code&quot;</span>,<span class="number">500</span>);</span><br><span class="line">    map.put(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;user.notexist&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;message&quot;</span>,e.getMessage());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/error&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>问题：没有将定制属性携带出去</p><h4 id="3-携带自定义属性实现自适应响应处理"><a href="#3-携带自定义属性实现自适应响应处理" class="headerlink" title="_3. 携带自定义属性实现自适应响应处理_"></a>_3. 携带自定义属性实现自适应响应处理_</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p><img src="/posts/1864766114/image-20210301204615309.png" alt="image-20210301204615309"></p><p><img src="/posts/1864766114/image-20210301205128756.png" alt="image-20210301205128756"></p><p><img src="/posts/1864766114/image-20210301203415376.png" alt="image-20210301203415376"></p><p>出现错误后，请求转发的方式转发到 /error，会被BasicErrorController处理，响应出去可以获取的数据都是通过 <code>getErrorAttributes()</code>方式添加到返回信息中，而getErrorAttributes()是类<code>AbstractErrorController</code>中的方法(implements ErrorController)</p><p>所以将自定义属性添加到返回信息中，有两种思路</p><ul><li>完全编写一个ErrorController的实现类【或者编写AbstractErrorController】,放在容器中</li><li>返回的数据，都是通过getErrorAttributes获取。容器中<code>DefaultErrorAttributes</code>进行数据处理</li></ul><p><img src="/posts/1864766114/image-20210301205905147.png" alt="image-20210301205905147"></p><h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(UserNotExistException.class)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">handleException</span><span class="params">(Exception e, HttpServletRequest request)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">/*必须传入 错误代码status  否则不会进入自定义错误页面</span></span><br><span class="line"><span class="comment">        * Integer statusCode = (Integer) request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;javax.servlet.error.status_code&quot;</span>,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将要携带的信息传入request</span></span><br><span class="line">    map.put(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;user.notexist&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;message&quot;</span>,<span class="string">&quot;用户信息错误&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;ext&quot;</span>,map);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/error&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210301210935040.png" alt="image-20210301210935040"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyErrorAttribute</span> <span class="keyword">extends</span> <span class="title class_">DefaultErrorAttributes</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getErrorAttributes</span><span class="params">(WebRequest webRequest, ErrorAttributeOptions options)</span> &#123;</span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="built_in">super</span>.getErrorAttributes(webRequest, options);</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;author&quot;</span>,<span class="string">&quot;tian&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//异常携带的信息</span></span><br><span class="line">        Map&lt;String,Object&gt; ext = (Map&lt;String, Object&gt;) webRequest.getAttribute(<span class="string">&quot;ext&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        map.put(<span class="string">&quot;ext&quot;</span>,ext);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210301211355035.png" alt="image-20210301211355035"></p><h2 id="Servlet容器"><a href="#Servlet容器" class="headerlink" title="Servlet容器"></a>Servlet容器</h2><p>SpringBoot默认是用嵌入式Servlet容器（Tomcat）</p><p><img src="/posts/1864766114/image-20210301212438367.png" alt="image-20210301212438367"></p><p>SpringBoot默认是将应用打包为jar包，启动嵌入式的Servlet容器，进而启动SpringBoot的web应用。</p><h3 id="1-如何定制和修改Servet容器的相关配置"><a href="#1-如何定制和修改Servet容器的相关配置" class="headerlink" title="1. 如何定制和修改Servet容器的相关配置"></a>1. 如何定制和修改Servet容器的相关配置</h3><ol><li>修改和 <code>server</code> 有关的配置</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通用的Servlet容器配置</span></span><br><span class="line"><span class="string">server.xxx</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/web</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Tomcat的设置</span></span><br><span class="line"><span class="string">server.tomcat.xxx</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"> <span class="attr">tomcat:</span></span><br><span class="line">  <span class="attr">uri-path:</span> <span class="string">UTF-8</span></span><br></pre></td></tr></table></figure><ol><li><p>编写一个EmbeddedServletContainerCustomizer:嵌入式Servlet容器的定制器；用于修改Servlet默认配置</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServerConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WebServerFactoryCustomizer <span class="title function_">webServerFactoryCustomizer</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebServerFactoryCustomizer</span>&lt;ConfigurableWebServerFactory&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">customize</span><span class="params">(ConfigurableWebServerFactory factory)</span> &#123;</span><br><span class="line">                factory.setPort(<span class="number">8081</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="2-注册三大组件——Servlet、Filter、Listener"><a href="#2-注册三大组件——Servlet、Filter、Listener" class="headerlink" title="2. 注册三大组件——Servlet、Filter、Listener"></a>2. 注册三大组件——Servlet、Filter、Listener</h3><h4 id="ServletRegistrationBean"><a href="#ServletRegistrationBean" class="headerlink" title="ServletRegistrationBean"></a>ServletRegistrationBean</h4><p><img src="/posts/1864766114/image-20210301221835357.png" alt="image-20210301221835357"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">//自定义Servlet实现</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;Hello SpringBoot Servlet!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServerConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//每个Servlet作为一个组件，注入容器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletRegistrationBean <span class="title function_">myservlet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//新建一个Servlet类及Servlet映射</span></span><br><span class="line">        <span class="type">ServletRegistrationBean</span> <span class="variable">servletRegistrationBean</span> </span><br><span class="line">            <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>(<span class="keyword">new</span> <span class="title class_">MyServlet</span>(),<span class="string">&quot;/servlet&quot;</span>);</span><br><span class="line">        <span class="comment">//servlet配置</span></span><br><span class="line">        servletRegistrationBean.setLoadOnStartup(<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="DispatcherServlet的注册"><a href="#DispatcherServlet的注册" class="headerlink" title="DispatcherServlet的注册"></a>DispatcherServlet的注册</h5><p>SpringBoot绑我们自动注册SpringMVC时，自动注册SpringMVC的前端控制器DispatcherServlet</p><p><img src="/posts/1864766114/image-20210301225101806.png" alt="image-20210301225101806"></p><p>默认拦截: /所有请求，包括静态资源</p><p>可以通过server.servletPath来修改SpringMVC前端控制器默认拦截的请求路径</p><h4 id="FilterRegistrationBean"><a href="#FilterRegistrationBean" class="headerlink" title="FilterRegistrationBean"></a>FilterRegistrationBean</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyFilter process...&quot;</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServerConfig</span> &#123;</span><br><span class="line">    <span class="comment">//每个Servlet作为一个组件，注入容器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean <span class="title function_">myFilter</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">FilterRegistrationBean</span> <span class="variable">filterRegistrationBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>();</span><br><span class="line">        filterRegistrationBean.setFilter(<span class="keyword">new</span> <span class="title class_">MyFilter</span>());</span><br><span class="line">        <span class="comment">//设置过滤路径</span></span><br><span class="line">        filterRegistrationBean.setUrlPatterns(Arrays.asList(<span class="string">&quot;/servlet&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextInitialized。。。。。web应用启动&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextDestroyed.....web应用销毁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServerConfig</span> &#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletListenerRegistrationBean <span class="title function_">myListener</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ServletListenerRegistrationBean</span> <span class="variable">servletListenerRegistrationBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletListenerRegistrationBean</span>();</span><br><span class="line"></span><br><span class="line">        servletListenerRegistrationBean.setListener(<span class="keyword">new</span> <span class="title class_">MyListener</span>());</span><br><span class="line">        <span class="keyword">return</span> servletListenerRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-切换嵌入式Servlet容器"><a href="#3-切换嵌入式Servlet容器" class="headerlink" title="3. 切换嵌入式Servlet容器"></a>3. 切换嵌入式Servlet容器</h3><ul><li><p>jetty</p><ul><li>长连接应用——聊天</li></ul></li><li><p>Undertow(不支持JSP)</p><ul><li>高性能非阻塞，并发性性能好</li></ul></li></ul><p><img src="/posts/1864766114/image-20210303150602155.png" alt="image-20210303150602155"></p><p>嵌入式工厂：创建嵌入式容器</p><p><img src="/posts/1864766114/image-20210302122802542.png" alt="image-20210302122802542"></p><p>选中需要排除的容器 <code>shift+delete</code>，引入其他Servlet容器</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--移除tomcat--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--引入jetty容器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210302131413918.png" alt="image-20210302131413918"></p><h3 id="4-嵌入式Servlet容器自动配置原理"><a href="#4-嵌入式Servlet容器自动配置原理" class="headerlink" title="4. 嵌入式Servlet容器自动配置原理"></a>4. 嵌入式Servlet容器自动配置原理</h3><p>步骤：</p><ol><li><p>SpringBoot根据依赖的导入情况，给容器中添加相应的 <code>XXXServletWebServerFactory</code></p></li><li><p>只要是ServletWebServerFactory创建组件，就会触发后置处理器 <code>WebServerFactoryCustomizerBeanPostProcessor</code></p><p>只要是嵌入式的Servlet容器工厂，后置处理器就工作</p></li><li><p>后置处理器是从容器中获取所有的<code>WebServerFactoryCustomizer</code>，调用定制器的定制方法给工厂添加配置</p></li></ol><h4 id="自动配置原理"><a href="#自动配置原理" class="headerlink" title="自动配置原理"></a>自动配置原理</h4><h5 id="ServletWebServerFactoryAutoConfiguration——Servlet容器自动配置类"><a href="#ServletWebServerFactoryAutoConfiguration——Servlet容器自动配置类" class="headerlink" title="ServletWebServerFactoryAutoConfiguration——Servlet容器自动配置类"></a>ServletWebServerFactoryAutoConfiguration——Servlet容器自动配置类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnClass(ServletRequest.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(type = Type.SERVLET)</span><span class="comment">//如果是Web应用，则生效</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(ServerProperties.class)</span></span><br><span class="line"><span class="comment">//允许通过ServerProperties修改属性的值</span></span><br><span class="line"><span class="comment">//可以在 application配置文件中修改</span></span><br><span class="line"><span class="meta">@Import(&#123; ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,</span></span><br><span class="line"><span class="meta">		ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,</span></span><br><span class="line"><span class="meta">		ServletWebServerFactoryConfiguration.EmbeddedJetty.class,</span></span><br><span class="line"><span class="meta">		ServletWebServerFactoryConfiguration.EmbeddedUndertow.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletWebServerFactoryAutoConfiguration</span> &#123;</span><br></pre></td></tr></table></figure><h5 id="ServletWebServerFactory"><a href="#ServletWebServerFactory" class="headerlink" title="ServletWebServerFactory"></a>ServletWebServerFactory</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断当前是否引入了Tomcat依赖；</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123;Servlet.class, Tomcat.class, UpgradeProtocol.class&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *判断当前容器没有用户自己定义ServletWebServerFactory：嵌入式的web服务器工厂；</span></span><br><span class="line"><span class="comment"> *作用：创建嵌入式的web服务器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(</span></span><br><span class="line"><span class="meta">    value = &#123;ServletWebServerFactory.class&#125;,</span></span><br><span class="line"><span class="meta">    search = SearchStrategy.CURRENT</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EmbeddedTomcat</span> &#123;</span><br><span class="line">    <span class="type">TomcatServletWebServerFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TomcatServletWebServerFactory</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> factory;<span class="comment">//返回TomcatServletWebServerFactory</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ServletWebServerFactory 作用是返回ServletWebSercer</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ServletWebServerFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Gets a new fully configured but paused &#123;<span class="doctag">@link</span> WebServer&#125; instance. </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> initializers &#123;<span class="doctag">@link</span> ServletContextInitializer&#125;s that should be applied as the server starts</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> a fully configured and started &#123;<span class="doctag">@link</span> WebServer&#125;</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">    </span><br><span class="line">     <span class="comment">//工厂类的作用是获取Servlet容器</span></span><br><span class="line">	WebServer <span class="title function_">getWebServer</span><span class="params">(ServletContextInitializer... initializers)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210303162147435.png" alt="image-20210303162147435"></p><p>可见 <code>xxxServletWebServerFactory</code> 主要作用是返回一个 <code>WebServer</code></p><blockquote><p>换言之，只要实现了 <code>ServletWebServerFactory</code> 的类都可以作为 servlet 容器的工厂类</p></blockquote><p><img src="/posts/1864766114/image-20210303170640201.png" alt="image-20210303170640201"></p><p>SpringBoot已经帮我们实现了三个Servlet容器工厂</p><blockquote><p>实现了 <code>WebServer</code> 的类可以作为Servlet容器</p></blockquote><p><img src="/posts/1864766114/image-20210303171804782.png" alt="image-20210303171804782"></p><p>SpringBoot已经实现的Servlet容器</p><h5 id="eg：EmbeddedTomcatWebServerFactory"><a href="#eg：EmbeddedTomcatWebServerFactory" class="headerlink" title="eg：EmbeddedTomcatWebServerFactory"></a>eg：EmbeddedTomcatWebServerFactory</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> WebServer <span class="title function_">getWebServer</span><span class="params">(ServletContextInitializer... initializers)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.disableMBeanRegistry) &#123;</span><br><span class="line">        Registry.disableRegistry();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建Tomcat</span></span><br><span class="line">    <span class="type">Tomcat</span> <span class="variable">tomcat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tomcat</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//Tomcat的基本配置</span></span><br><span class="line">    <span class="type">File</span> <span class="variable">baseDir</span> <span class="operator">=</span> (<span class="built_in">this</span>.baseDirectory != <span class="literal">null</span>) ? <span class="built_in">this</span>.baseDirectory : createTempDir(<span class="string">&quot;tomcat&quot;</span>);</span><br><span class="line">    tomcat.setBaseDir(baseDir.getAbsolutePath());</span><br><span class="line">    <span class="type">Connector</span> <span class="variable">connector</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Connector</span>(<span class="built_in">this</span>.protocol);</span><br><span class="line">    connector.setThrowOnFailure(<span class="literal">true</span>);</span><br><span class="line">    tomcat.getService().addConnector(connector);</span><br><span class="line">    customizeConnector(connector);</span><br><span class="line">    tomcat.setConnector(connector);</span><br><span class="line">    tomcat.getHost().setAutoDeploy(<span class="literal">false</span>);</span><br><span class="line">    configureEngine(tomcat.getEngine());</span><br><span class="line">    <span class="keyword">for</span> (Connector additionalConnector : <span class="built_in">this</span>.additionalTomcatConnectors) &#123;</span><br><span class="line">        tomcat.getService().addConnector(additionalConnector);</span><br><span class="line">    &#125;</span><br><span class="line">    prepareContext(tomcat.getHost(), initializers);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//将配置好的Tomcat传递出去，返回一个EmbeddedsServletContainer，启动Tomcat服务器</span></span><br><span class="line">    <span class="keyword">return</span> getTomcatWebServer(tomcat);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> TomcatWebServer <span class="title function_">getTomcatWebServer</span><span class="params">(Tomcat tomcat)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TomcatWebServer</span>(tomcat, getPort() &gt;= <span class="number">0</span>, getShutdown());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatWebServer</span> <span class="keyword">implements</span> <span class="title class_">WebServer</span> &#123;</span><br><span class="line">    	<span class="keyword">public</span> <span class="title function_">TomcatWebServer</span><span class="params">(Tomcat tomcat, </span></span><br><span class="line"><span class="params">                               <span class="type">boolean</span> autoStart, Shutdown shutdown)</span> &#123;</span><br><span class="line">    Assert.notNull(tomcat, <span class="string">&quot;Tomcat Server must not be null&quot;</span>);</span><br><span class="line">    <span class="built_in">this</span>.tomcat = tomcat;</span><br><span class="line">    <span class="built_in">this</span>.autoStart = autoStart;</span><br><span class="line">    <span class="built_in">this</span>.gracefulShutdown = (shutdown _ Shutdown.GRACEFUL) ? <span class="keyword">new</span> <span class="title class_">GracefulShutdown</span>(tomcat) : <span class="literal">null</span>;</span><br><span class="line">    initialize();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="配置修改原理"><a href="#配置修改原理" class="headerlink" title="配置修改原理"></a>配置修改原理</h4><p>在自动装配Servlet容器时，还注册了一个组件 <code>BeanPostProcessorsRegistrar</code></p><p><code>BeanPostProcessorsRegistrar</code>：后置处理器注册器(也是给容器注入一些组件)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BeanPostProcessorsRegistrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span>, BeanFactoryAware &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> ConfigurableListableBeanFactory beanFactory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata,</span></span><br><span class="line"><span class="params">	BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.beanFactory _ <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">//向容器中注入两个组件 </span></span><br><span class="line">    registerSyntheticBeanIfMissing(registry,</span><br><span class="line">   	<span class="string">&quot;webServerFactoryCustomizerBeanPostProcessor&quot;</span>,                                WebServerFactoryCustomizerBeanPostProcessor.class,                          WebServerFactoryCustomizerBeanPostProcessor::<span class="keyword">new</span>);</span><br><span class="line">        </span><br><span class="line">    registerSyntheticBeanIfMissing(registry,</span><br><span class="line">	<span class="string">&quot;errorPageRegistrarBeanPostProcessor&quot;</span>,                                   	 ErrorPageRegistrarBeanPostProcessor.class,                                   ErrorPageRegistrarBeanPostProcessor::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>webServerFactoryCustomizerBeanPostProcessor</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebServerFactoryCustomizerBeanPostProcessor</span> &#123;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//在Bean初始化之前</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="comment">//判断添加的Bean是不是WebServerFactory类型的</span></span><br><span class="line">        <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> WebServerFactory) &#123;</span><br><span class="line">            <span class="built_in">this</span>.postProcessBeforeInitialization((WebServerFactory)bean);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">postProcessBeforeInitialization</span><span class="params">(WebServerFactory webServerFactory)</span> &#123;</span><br><span class="line">    <span class="comment">//获取所有的定制器，调用每一个定制器的customize方法来给Servlet容器进行属性赋值；</span></span><br><span class="line">    ((Callbacks)LambdaSafe.callbacks(</span><br><span class="line">        WebServerFactoryCustomizer.class,<span class="built_in">this</span>.getCustomizers(), </span><br><span class="line">        webServerFactory,</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]).withLogger(</span><br><span class="line">        	WebServerFactoryCustomizerBeanPostProcessor.class)).invoke((customizer) -&gt; &#123;</span><br><span class="line">            customizer.customize(webServerFactory);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>而 appplication.yaml中的配置由注解注入</p><p><img src="/posts/1864766114/image-20210303173725150.png" alt="image-20210303173725150"></p><h4 id="2-xx以下"><a href="#2-xx以下" class="headerlink" title="2.xx以下"></a>2.xx以下</h4><h5 id="EmbeddedServletContainerAutoConfiguration"><a href="#EmbeddedServletContainerAutoConfiguration" class="headerlink" title="EmbeddedServletContainerAutoConfiguration"></a>EmbeddedServletContainerAutoConfiguration</h5><p><img src="/posts/1864766114/image-20210303145024390.png" alt="image-20210303145024390"></p><ol><li><p>EmbeddedServletContainerFactory(嵌入式Servlet容器工厂)</p><p><img src="/posts/1864766114/image-20210303145136752.png" alt="image-20210303145136752"></p><p><img src="/posts/1864766114/image-20210303145335036.png" alt="image-20210303145335036"></p></li><li><p>EmbeddedServletContainer(嵌入式Servlet容器)</p><p><img src="/posts/1864766114/image-20210303145433524.png" alt="image-20210303145433524"></p><p>移除Tomcat依赖，导入Jetty依赖</p></li></ol><p><img src="/posts/1864766114/image-20210303150703527.png" alt="image-20210303150703527"></p><p><img src="/posts/1864766114/image-20210303150733376.png" alt="image-20210303150733376"></p><p><img src="/posts/1864766114/image-20210303150739664.png" alt="image-20210303150739664"></p><ol><li>以嵌入式Tomcat容器工厂为例</li></ol><p><img src="/posts/1864766114/image-20210303151532231.png" alt="image-20210303151532231"></p><ol><li><p>对嵌入式容器配置的修改</p><ul><li><p>修改 serverProperties属性</p></li><li><p>EmbeddedServletContainerCustomizer:定制器帮我们修改了Servlet容器的一些配置(端口号)</p><p>怎么修改</p><p><img src="/posts/1864766114/image-20210303151825997.png" alt="image-20210303151825997"></p><p><img src="/posts/1864766114/image-20210303151853199.png" alt="image-20210303151853199"><img src="/posts/1864766114/image-20210303151945285.png" alt="image-20210303151945285"></p></li></ul></li></ol><ol><li>容器中导入了EmbeddedServletContainerCustomizerBeanPostProcessor</li></ol><p><img src="/posts/1864766114/image-20210303152356183.png" alt="image-20210303152356183"></p><p><img src="/posts/1864766114/image-20210303152548713.png" alt="image-20210303152548713"></p><p>application.yaml中的属性怎么配置上的</p><p><img src="/posts/1864766114/image-20210303152654981.png" alt="image-20210303152654981"></p><h3 id="5-嵌入式Servlet容器启动原理"><a href="#5-嵌入式Servlet容器启动原理" class="headerlink" title="5. 嵌入式Servlet容器启动原理"></a>5. 嵌入式Servlet容器启动原理</h3><blockquote><p>嵌入式容器工厂什么时候创建Servlet容器</p><p>什么时候获取嵌入是Servlet容器，并启动Servlet容器</p></blockquote><ol><li><p>SpringBoot应用启动运行run方法</p><p><img src="/posts/1864766114/image-20210303181715679.png" alt="image-20210303181715679"></p><p><img src="/posts/1864766114/image-20210303181501723.png" alt="image-20210303181501723"></p><p><img src="/posts/1864766114/image-20210303182722927.png" alt="image-20210303182722927"></p></li><li><p>创建IoC容器对象，并初始化容器(包括创建容器中的每一个组件)</p><p>如果是web应用，创建<strong>AnnotationConfigEmbeddedWebApplicationContext</strong>，否则创建默认的IoC容器<strong>AnnotationConfigApplicationContext</strong></p><p><img src="/posts/1864766114/image-20210303181538977.png" alt="image-20210303181538977"></p><p><img src="/posts/1864766114/image-20210303183213136.png" alt="image-20210303183213136"></p></li><li><p>refresh(context)，刷新刚才创建好的ioc容器</p><p><img src="/posts/1864766114/image-20210303181600074.png" alt="image-20210303181600074"></p></li><li><p>onRefresh(),web的IoC容器重写了onRefresh()方法</p></li><li><p>webIoC容器会创建嵌入式Servlet容器 <strong>createEmbeddedServletContainer()</strong></p></li><li><p>获取嵌入式 Servlet 容器工厂</p><p>EmbeddedServletContainerFactory containerFactory = getEmbeddedServletContainerFactory();</p><p>从IoC容器中获取 <strong>EmbeddedServletContainerFactory</strong> 组件</p><p><strong>TomcatEmbeddedServletContainerFactory</strong> 创建对象，后置处理器获取所有定制器，先处理定制ServletContainerFactory的相关配置</p></li><li><p>使用容器工厂获取嵌入式Servlet容器</p><p>this.embeddedServletContainer = containerFactory.getEmbeddedServletContainer(getSelfInitializer());</p></li><li><p>嵌入式Servlet容器创建对象并启动servlet容器</p></li></ol><p><strong>先启动Servlet容器，再将IoC容器中剩下没有创建出来的对象获取出来</strong></p><p><strong>IoC容器启动，创建Servlet容器</strong></p><h3 id="6-切换外部Servlet容器"><a href="#6-切换外部Servlet容器" class="headerlink" title="6. 切换外部Servlet容器"></a>6. 切换外部Servlet容器</h3><blockquote><p>嵌入式Servlet容器:应用打包方式jar</p></blockquote><p>缺点：</p><ul><li>默认不支持JSP</li><li>优化定制复杂<ul><li>使用定制器EmbeddedServletContainerCustomizer</li><li>ServerProperties</li><li>自己编写嵌入式ServletContainerFactory</li></ul></li></ul><blockquote><p>外置Servlet容器：应用打包方式war</p></blockquote><h4 id="外部Servlet容器启动SpringBoot应用原理"><a href="#外部Servlet容器启动SpringBoot应用原理" class="headerlink" title="外部Servlet容器启动SpringBoot应用原理"></a>外部Servlet容器启动SpringBoot应用原理</h4><blockquote><ul><li><p>jar:执行SpringBoot主类的main方法，启动IoC容器，创建嵌入式的servlet容器</p></li><li><p>war:启动服务器，服务器启动SpringBoot应用[<code>SpringBootServletInitializer</code>]，启动IoC容器</p></li></ul></blockquote><p>Servlet3规则:Shared Lobraries/runntimes pluggability</p><ol><li>服务器启动时(web应用启动)会创建当前web应用里面每一个jar包里的ServletContainerInitializer实例</li><li>ServletContainerInitializer实现类的全类名放在jar包的 META/INF/services文件夹下，有一个名为 javax.servlet.ServletContainerInitializer的文件</li><li>还可以使用 @HandlesTypes，在应用启动的时候加载我们需要的类</li></ol><blockquote><p>流程</p></blockquote><ol><li><p>启动外部Tomcat，根据Servlet3.0标准：服务器启动时(web应用启动)会创建当前web应用里面每一个jar包里的ServletContainerInitializer实例</p></li><li><p>ServletContainerInitializer实现类的全类名放在 org\springframework\spring-web\5.3.4\spring-web-5.3.4.jar\META-INF\services\javax.servlet.ServletContainerInitializer</p><p><img src="/posts/1864766114/image-20210303195936200.png" alt="image-20210303195936200"></p><ol><li><p>ServletContainerInitializer扫描由@HandlesTypes标注的类，存到 onStartup方法中的<code>Set&lt;Class&lt;?&gt;&gt;</code> ,并为这些WebApplicationInitializer类型的类创建实例</p><p><img src="/posts/1864766114/image-20210303210945785.png" alt="image-20210303210945785"></p></li><li><p>每一个WebApplicationInitializer都调用自己的onStartUp:</p><p><img src="/posts/1864766114/image-20210303211040914.png" alt="image-20210303211040914"></p></li><li><p>相当于我们创建的ServletInitializer（继承了SpringBootServletInitializer的类）会被创建对象，并执行onStartUp方法</p><p><img src="/posts/1864766114/image-20210303211459760.png" alt="image-20210303211459760"></p><p>会调用createRootApplicationContext方法，创建应用容器</p></li><li><p>createRootApplicationContext</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">createRootApplicationContext</span><span class="params">(ServletContext servletContext)</span> &#123;</span><br><span class="line">    <span class="comment">//创建SpringApplicationBuilder</span></span><br><span class="line">    <span class="type">SpringApplicationBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> createSpringApplicationBuilder();</span><br><span class="line">    builder.main(getClass());</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">parent</span> <span class="operator">=</span> getExistingRootWebApplicationContext(servletContext);</span><br><span class="line">    <span class="keyword">if</span> (parent != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.logger.info(<span class="string">&quot;Root context already created (using as parent).&quot;</span>);</span><br><span class="line">        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, <span class="literal">null</span>);</span><br><span class="line">        builder.initializers(<span class="keyword">new</span> <span class="title class_">ParentContextApplicationContextInitializer</span>(parent));</span><br><span class="line">    &#125;</span><br><span class="line">    builder.initializers(<span class="keyword">new</span> <span class="title class_">ServletContextApplicationContextInitializer</span>(servletContext));</span><br><span class="line">    builder.contextFactory((webApplicationType) -&gt; <span class="keyword">new</span> <span class="title class_">AnnotationConfigServletWebServerApplicationContext</span>());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调用configure方法，子类重写了这个方法，将SpringBoot主程序传进来</span></span><br><span class="line">    builder = configure(builder);</span><br><span class="line">    builder.listeners(<span class="keyword">new</span> <span class="title class_">WebEnvironmentPropertySourceInitializer</span>(servletContext));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//创建一个Spring应用</span></span><br><span class="line">    <span class="type">SpringApplication</span> <span class="variable">application</span> <span class="operator">=</span> builder.build();</span><br><span class="line">    <span class="keyword">if</span> (application.getAllSources().isEmpty()</span><br><span class="line">        &amp;&amp; MergedAnnotations.from(getClass(), SearchStrategy.TYPE_HIERARCHY).isPresent(Configuration.class)) &#123;</span><br><span class="line">        application.addPrimarySources(Collections.singleton(getClass()));</span><br><span class="line">    &#125;</span><br><span class="line">    Assert.state(!application.getAllSources().isEmpty(),</span><br><span class="line">                 <span class="string">&quot;No SpringApplication sources have been defined. Either override the &quot;</span></span><br><span class="line">                 + <span class="string">&quot;configure method or add an @Configuration annotation&quot;</span>);</span><br><span class="line">    <span class="comment">// Ensure error pages are registered</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.registerErrorPageFilter) &#123;</span><br><span class="line">        application.addPrimarySources(Collections.singleton(ErrorPageFilterConfiguration.class));</span><br><span class="line">    &#125;</span><br><span class="line">    application.setRegisterShutdownHook(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//启动Spring应用</span></span><br><span class="line">    <span class="keyword">return</span> run(application);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210303212023419.png" alt="image-20210303212023419"></p></li><li><p>加载@SpringBootApplication主类，启动IoC容器</p></li></ol></li></ol><h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h4><ol><li><p>必须创建一个 war 项目</p><p><img src="/posts/1864766114/image-20210303185133410.png" alt="image-20210303185133410"></p></li><li><p>将嵌入式的Tomcat指定为provided</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>将当前项目改造为一个web项目</p><p><img src="/posts/1864766114/image-20210303185440444.png" alt="image-20210303185440444"></p><p><img src="/posts/1864766114/image-20210303190359260.png" alt="image-20210303190359260"></p></li><li><p>必须编写一个SpringBootServletInitializer的子类，并调用configure方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletInitializer</span> <span class="keyword">extends</span> <span class="title class_">SpringBootServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> SpringApplicationBuilder <span class="title function_">configure</span><span class="params">(SpringApplicationBuilder application)</span> &#123;</span><br><span class="line">        <span class="comment">//传入SpringBoot应用的主程序</span></span><br><span class="line">        <span class="keyword">return</span> application.sources(Springboot03WarwebApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>启用服务器即可</p><p>配置Tomcat</p><p><img src="/posts/1864766114/image-20210303190901784.png" alt="image-20210303190901784"></p></li></ol><p>可以指定前后缀</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="attr">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br></pre></td></tr></table></figure><div style="page-break-after:always"><h2 id="数据访问"><a href="#数据访问" class="headerlink" title="数据访问"></a>数据访问</h2><ul><li>JDBC</li><li>MyBatis</li><li>Spring Data JPA</li></ul><p>SpringBoot数据访问都是基于Spring Data</p><h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><ol><li><p>新建项目</p><p><img src="/posts/1864766114/image-20210307195651382.png" alt="image-20210307195651382"></p></li><li><p>导入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>配置数据源</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">Aa12345+</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://8.140.130.91:3306/jdbc?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br></pre></td></tr></table></figure></li><li><p>测试连接</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">DataSource dataSource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//com.zaxxer.hikari.HikariDataSource</span></span><br><span class="line">    System.out.println(dataSource.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> dataSource.getConnection();</span><br><span class="line">    System.out.println(connection);</span><br><span class="line"></span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>默认使用 <code>com.zaxxer.hikari.HikariDataSource</code> 作为数据源</p><p>数据源的相关配置在 <code>DataSourceProperties</code></p><h4 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h4><h5 id="数据源配置原理"><a href="#数据源配置原理" class="headerlink" title="数据源配置原理"></a>数据源配置原理</h5><ol><li><p>参考 <code>DataSourceConfiguration</code> ,根据配置创建数据源，默认使用 <code>Hikari</code> 连接池，可以使用 <code>spring.datasource.type</code> 指定默认数据源类型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">支持的数据源类型</span><br><span class="line">oracle.ucp.jdbc.PoolDataSource</span><br><span class="line">org.apache.commons.dbcp2.BasicDataSource</span><br><span class="line">com.zaxxer.hikari.HikariDataSource</span><br><span class="line">org.apache.tomcat.jdbc.pool.DataSource</span><br></pre></td></tr></table></figure></li><li><p>自定义数据源类型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Generic DataSource configuration.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(DataSource.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(name = &quot;spring.datasource.type&quot;)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Generic</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    DataSource <span class="title function_">dataSource</span><span class="params">(DataSourceProperties properties)</span> &#123;</span><br><span class="line">        <span class="comment">//使用DataSourceBuilder创建数据源，利用反射创建响应type的数据源，并且绑定相关属性</span></span><br><span class="line">        <span class="keyword">return</span> properties.initializeDataSourceBuilder().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h5 id="sql语句执行原理"><a href="#sql语句执行原理" class="headerlink" title="sql语句执行原理"></a>sql语句执行原理</h5><p>在 <code>DataSourceInitializationConfiguration</code> 中注册了 <code>DataSourceInitializerPostProcessor</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">	DataSourceInitializationConfiguration</span><br><span class="line">=&gt;	DataSourceInitializerPostProcessor</span><br><span class="line">=&gt;	DataSourceInitializerInvoker</span><br><span class="line">=&gt;	DataSourceInitializer</span><br></pre></td></tr></table></figure><p>所以SpringBoot在创建连接池后还会运行预定义的SQL脚本文件</p><p><img src="/posts/1864766114/image-20210307211857197.png" alt="image-20210307211857197"></p><ul><li><p>如果用户指定脚本路径，则直接去找用户的脚本</p></li><li><p>如果没有在配置文件中配置脚本的具体位置，就会在classpath下找<code>schema-all.sql</code>和<code>schema.sql</code> ，platform获取的是all，platform可以在配置文件中修改</p></li></ul><p><strong>默认只需要将待执行的sql脚本命名为 schema-*.sql、data-*.sql</strong></p><p>可以使用</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">schema:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">classpath:department.sql</span></span><br></pre></td></tr></table></figure><p>指定脚本名</p><h5 id="执行sql语句"><a href="#执行sql语句" class="headerlink" title="执行sql语句"></a>执行sql语句</h5><p>程序启动后发现表并没有被创建，DEBUG查看以下，发现在运行之前会有一个判断</p><p><img src="/posts/1864766114/image-20210307213620036.png" alt="image-20210307213620036"></p><p><img src="/posts/1864766114/image-20210307213602303.png" alt="image-20210307213602303"></p><p>在配置文件中改为 true</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">initialization-mode:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210307213854993.png" alt="image-20210307213854993"></p><h4 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h4><p>自动配置了 <code>JDBCTemplate</code> 操作数据库</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/query1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">query1</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Map&lt;String,Object&gt;&gt; list = jdbcTemplate.queryForList(<span class="string">&quot;select * from department&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/posts/1864766114/image-20210307214921663.png" alt="image-20210307214921663"></p><h4 id="Durid"><a href="#Durid" class="headerlink" title="Durid"></a>Durid</h4></div></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------<i class="fa fa-hand-peace-o"></i>本文结束-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者 </strong>AmosTian</li><li class="post-copyright-link"><strong>本文链接 </strong><a href="https://amostian.github.io/posts/1864766114/" title="SpringBoot">https://amostian.github.io/posts/1864766114/</a></li><li class="post-copyright-license"><strong>版权声明 </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E5%BC%80%E5%8F%91/" rel="tag"><i class="fa fa-tags"></i> 开发</a> <a href="/tags/%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6/" rel="tag"><i class="fa fa-tags"></i> 后端框架</a> <a href="/tags/SpringBoot/" rel="tag"><i class="fa fa-tags"></i> SpringBoot</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/2920256992/" rel="prev" title="SpringMVC"><i class="fa fa-chevron-left"></i> SpringMVC</a></div><div class="post-nav-item"><a href="/posts/1175195952/" rel="next" title="微服务">微服务 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringBoot"><span class="nav-text">SpringBoot</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-text">简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%99%A8"><span class="nav-text">启动器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E5%A4%A7%E7%89%B9%E7%82%B9"><span class="nav-text">两大特点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8"><span class="nav-text">开箱即用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%A6%E5%AE%9A%E5%A4%A7%E4%BA%8E%E9%85%8D%E7%BD%AE"><span class="nav-text">约定大于配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-text">优点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="nav-text">Spring如何构建微服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hello%E7%A8%8B%E5%BA%8F"><span class="nav-text">Hello程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0-%E7%8E%AF%E5%A2%83"><span class="nav-text">0. 环境</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E7%B1%BB%E4%BD%8D%E7%BD%AE"><span class="nav-text">修改主类位置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Maven"><span class="nav-text">Maven</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%96%B0%E5%BB%BAProject"><span class="nav-text">1. 新建Project</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%A0%87%E6%B3%A8%E4%B8%BB%E7%A8%8B%E5%BA%8F%E7%B1%BB"><span class="nav-text">2.标注主程序类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%AF%BC%E5%85%A5web%E4%BE%9D%E8%B5%96"><span class="nav-text">3. 导入web依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E6%94%B9%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="nav-text">4. 改端口号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E9%83%A8%E7%BD%B2"><span class="nav-text">5.部署</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-text">自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E7%A4%BA%E4%BE%8B"><span class="nav-text">自动装配示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-text">什么是自动装配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBootApplication"><span class="nav-text">@SpringBootApplication</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SpringBootConfiguration"><span class="nav-text">@SpringBootConfiguration</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ComponentScan"><span class="nav-text">@ComponentScan</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EnableAutoConfiguration"><span class="nav-text">@EnableAutoConfiguration</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#AutoconfigurationPackage"><span class="nav-text">@AutoconfigurationPackage</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Import-AutoConfigurationImportSelector-class"><span class="nav-text">@Import({AutoConfigurationImportSelector.class})</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94XXXAutoConfiguration"><span class="nav-text">自动装配核心配置——XXXAutoConfiguration</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ConditionalOnXXX"><span class="nav-text">@ConditionalOnXXX</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringApplication-run-Springboot01Application-class-args"><span class="nav-text">SpringApplication.run(Springboot01Application.class, args);</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BB%80%E4%B9%88%E4%BC%9A%E8%A2%AB%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-text">1. 什么会被自动装配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-XXXAutoConfiguration"><span class="nav-text">2.XXXAutoConfiguration</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%AF%8F%E4%B8%80%E4%B8%AAXXXAutoConfiguration%E8%BF%9B%E8%A1%8C%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8A%9F%E8%83%BD"><span class="nav-text">3. 每一个XXXAutoConfiguration进行自动配置功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E8%83%BD%E9%85%8D%E7%BD%AE%E7%9A%84%E5%B1%9E%E6%80%A7%E9%83%BD%E5%9C%A8XXXProperties%E4%B8%AD%E5%B0%81%E8%A3%85"><span class="nav-text">4. 配置文件中能配置的属性都在XXXProperties中封装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E6%98%AF%E5%90%A6%E7%94%9F%E6%95%88"><span class="nav-text">检测自动配置类是否生效</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#yaml"><span class="nav-text">yaml</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#yaml%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-text">yaml基本语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8D%A0%E4%BD%8D%E7%AC%A6"><span class="nav-text">配置文件占位符</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0-random-XXXX"><span class="nav-text">随机数${random.XXXX}</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E4%B9%8B%E5%89%8D%E7%9A%84%E5%80%BC%EF%BC%8C%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="nav-text">获取之前的值，指定默认值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%85%A5%EF%BC%8C%E7%BB%99%E5%AE%9E%E4%BD%93%E7%B1%BB%E8%B5%8B%E5%80%BC"><span class="nav-text">注入，给实体类赋值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ConfigurationProperties"><span class="nav-text">@ConfigurationProperties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PropertySource"><span class="nav-text">@PropertySource</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%BA%E5%88%AB"><span class="nav-text">区别</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%BE%E6%95%A3%E7%BB%91%E5%AE%9A"><span class="nav-text">松散绑定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#JSR303%E6%A0%A1%E9%AA%8C"><span class="nav-text">JSR303校验</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-text">结论</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">全局配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%8A%A0%E8%BD%BD%E4%BD%8D%E7%BD%AE"><span class="nav-text">全局配置文件的加载位置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%86%85"><span class="nav-text">项目内</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-text">优先级</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD%E9%A1%BA%E5%BA%8F"><span class="nav-text">外部配置加载顺序</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%88%99"><span class="nav-text">原则</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%8A%A0%E8%BD%BD"><span class="nav-text">其他配置文件的加载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PropertySource-value-quot-quot-quot-quot"><span class="nav-text">@PropertySource(value&#x3D;{&quot;&quot;,&quot;&quot;})</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ImportResource-location-quot-quot-quot-quot"><span class="nav-text">@ImportResource(location&#x3D;{&quot;&quot;,&quot;&quot;})</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SpringBoot%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE"><span class="nav-text">SpringBoot推荐使用配置类编写配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%88%87%E6%8D%A2%E2%80%94%E2%80%94Profile"><span class="nav-text">多环境切换——Profile</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BF%80%E6%B4%BB%E6%96%B9%E5%BC%8F"><span class="nav-text">激活方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="nav-text">命令行</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jvm%E5%8F%82%E6%95%B0"><span class="nav-text">jvm参数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#yaml%E5%A4%9A%E6%96%87%E6%A1%A3%E5%9D%97"><span class="nav-text">yaml多文档块</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97"><span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%97%A5%E5%BF%97%E4%BE%9D%E8%B5%96"><span class="nav-text">默认日志依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%96%87%E6%A1%A3%E4%B8%8E%E6%A1%86%E6%9E%B6%E5%85%B3%E7%B3%BB"><span class="nav-text">日志文档与框架关系</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%A1%86%E6%9E%B6%E7%9A%84%E7%BB%9F%E4%B8%80%E8%BD%AC%E6%8D%A2%E4%B8%BASLF4J"><span class="nav-text">其他框架的统一转换为SLF4J</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%87%E6%8D%A2%E6%97%A5%E5%BF%97%E5%AE%9E%E7%8E%B0%E6%A1%86%E6%9E%B6"><span class="nav-text">切换日志实现框架</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBoot%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE"><span class="nav-text">SpringBoot默认配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0-%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="nav-text">0.配置原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AF%BC%E5%8C%85"><span class="nav-text">1. 导包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB"><span class="nav-text">2. 日志级别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%8C%87%E5%AE%9A%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E7%9A%84%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="nav-text">3. 指定日志信息的输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%E8%B7%AF%E5%BE%84"><span class="nav-text">4. 日志输出路径</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%9C%A8%E5%BD%93%E5%89%8D%E8%B7%AF%E5%BE%84%E4%B8%8B%E8%BE%93%E5%87%BA"><span class="nav-text">1.在当前路径下输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%8C%87%E5%AE%9A%E8%BE%93%E5%87%BA%E5%88%B0%E6%9F%90%E4%B8%80%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6"><span class="nav-text">2. 指定输出到某一目录下的文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%9C%AC%E9%A1%B9%E7%9B%AE%E4%B8%8B%E7%9A%84%E7%9B%AE%E5%BD%95%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E4%B8%BAspring-log"><span class="nav-text">3. 本项目下的目录，默认的文件名为spring.log</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBoot%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="nav-text">SpringBoot自定义日志配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA"><span class="nav-text">多环境日志输出</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8"><span class="nav-text">日志使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">1. 自定义日志配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="nav-text">2. 日志配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-root-gt"><span class="nav-text">&lt;root&gt;</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-contextName-gt"><span class="nav-text">&lt;contextName&gt;</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-property-gt"><span class="nav-text">&lt;property&gt;</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-appender-gt"><span class="nav-text">&lt;appender&gt;</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BAConsoleAppender"><span class="nav-text">控制台输出ConsoleAppender</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E5%88%B0%E6%96%87%E4%BB%B6-RollingFileAppender"><span class="nav-text">输出到文件 RollingFileAppender</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-loger-gt"><span class="nav-text">&lt;loger&gt;</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8"><span class="nav-text">3. 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AOP%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97"><span class="nav-text">AOP实现自定义日志</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%88%87%E7%82%B9%E6%B3%A8%E8%A7%A3"><span class="nav-text">定义切点注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%88%87%E9%9D%A2"><span class="nav-text">定义切面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E5%88%87%E7%82%B9%E5%88%87%E5%85%A5"><span class="nav-text">在切点切入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web"><span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="nav-text">导入静态资源</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-webjars"><span class="nav-text">1. webjars</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E9%BB%98%E8%AE%A4%E6%9F%A5%E6%89%BE%E4%BD%8D%E7%BD%AE"><span class="nav-text">2. 静态资源的默认查找位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A6%96%E9%A1%B5"><span class="nav-text">首页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E7%BD%AE"><span class="nav-text">位置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E2%80%94%E2%80%94ThymeLeaf"><span class="nav-text">模板引擎——ThymeLeaf</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%99%A8-1"><span class="nav-text">启动器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E4%BD%8D%E7%BD%AE"><span class="nav-text">默认位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5thymeleaf%E7%BA%A6%E6%9D%9F"><span class="nav-text">导入thymeleaf约束</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-text">基本语法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-text">属性优先级</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Simple-expressions"><span class="nav-text">Simple expressions:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Literals-%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="nav-text">Literals 字面量</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Text-operations-%E6%96%87%E6%9C%AC%E6%8B%BC%E6%8E%A5"><span class="nav-text">Text operations:文本拼接</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Arithmetic-operations-%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text">Arithmetic operations:数学运算</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Boolean-operations-%E5%B8%83%E5%B0%94%E8%BF%90%E7%AE%97"><span class="nav-text">Boolean operations:布尔运算</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Comparisons-and-equality-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="nav-text">Comparisons and equality:比较运算</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Conditional-operators-%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97"><span class="nav-text">Conditional operators:条件运算</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Special-tokens"><span class="nav-text">Special tokens:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Thymeleaf%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="nav-text">Thymeleaf请求转发实现机制</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#redirect"><span class="nav-text">redirect</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#request"><span class="nav-text">request</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MVC"><span class="nav-text">MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SpringBoot-Web-MVC-Framework"><span class="nav-text">SpringBoot Web MVC Framework</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-Inclusion-of-ContentNegotiatingViewResolver-and-BeanNameViewResolver-beans"><span class="nav-text">1. Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-Support-for-serving-static-resources-including-support-for-WebJars"><span class="nav-text">2. Support for serving static resources, including support for WebJars .</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-Static-index-html-support"><span class="nav-text">3. Static index.html support.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-Automatic-registration-of-Converter-GenericConverter-and-Formatter-beans"><span class="nav-text">4. Automatic registration of Converter, GenericConverter, and Formatter beans.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-Support-for-HttpMessageConverters"><span class="nav-text">5. Support for HttpMessageConverters .</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-Automatic-registration-of-MessageCodesResolver"><span class="nav-text">6. Automatic registration of MessageCodesResolver .</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-Automatic-use-of-a-ConfigurableWebBindingInitializer-bean"><span class="nav-text">7. Automatic use of a ConfigurableWebBindingInitializer bean.</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A9%E5%B1%95MVC%E5%8A%9F%E8%83%BD"><span class="nav-text">扩展MVC功能</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC-%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-text">实现页面跳转+拦截器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%8E%9F%E5%88%99"><span class="nav-text">配置原则</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%94%9F%E6%95%88%E5%8E%9F%E7%90%86"><span class="nav-text">自动配置生效原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAMVC%E9%A1%B9%E7%9B%AE"><span class="nav-text">第一个MVC项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">1. 环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#POJO"><span class="nav-text">POJO</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Dao"><span class="nav-text">Dao</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%A6%96%E9%A1%B5%E9%85%8D%E7%BD%AE"><span class="nav-text">2. 首页配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Thymeleaf%E4%BE%9D%E8%B5%96"><span class="nav-text">Thymeleaf依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Thymeleaf%E7%BA%A6%E6%9D%9F"><span class="nav-text">Thymeleaf约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E7%BC%93%E5%AD%98"><span class="nav-text">关闭模板引擎的缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E9%A6%96%E9%A1%B5"><span class="nav-text">设置首页</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80"><span class="nav-text">设置路径前缀</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B0%86%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E4%BA%A4%E7%BB%99Thymeleaf%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86"><span class="nav-text">将静态资源交给Thymeleaf统一管理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%9B%BD%E9%99%85%E5%8C%96"><span class="nav-text">3. 国际化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%BC%96%E5%86%99%E5%88%B0%E5%9B%BD%E9%99%85%E5%8C%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E6%8A%BD%E5%8F%96%E9%A1%B5%E9%9D%A2%E9%9C%80%E8%A6%81%E6%98%BE%E7%A4%BA%E7%9A%84%E5%9B%BD%E9%99%85%E5%8C%96%E6%B6%88%E6%81%AF"><span class="nav-text">1. 编写到国际化配置文件中，抽取页面需要显示的国际化消息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-SpringBoot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%A5%BD%E4%BA%86%E7%AE%A1%E7%90%86%E5%9B%BD%E9%99%85%E5%8C%96%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="nav-text">2. SpringBoot自动配置好了管理国际化的组件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="nav-text">3. 修改配置文件路径</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E4%BF%AE%E6%94%B9%E5%9B%BD%E9%99%85%E5%8C%96%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-text">4. 修改国际化的属性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9B%BD%E9%99%85%E5%8C%96%E7%BB%84%E4%BB%B6"><span class="nav-text">5. 自定义国际化组件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E7%99%BB%E5%BD%95-%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-text">4. 登录+拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%99%BB%E5%BD%95"><span class="nav-text">登录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%98%B2%E6%AD%A2%E8%A1%A8%E5%8D%95%E9%87%8D%E5%A4%8D%E6%8F%90%E4%BA%A4%E2%80%94%E2%80%94%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">防止表单重复提交——重定向</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8%E8%BF%9B%E8%A1%8C%E7%99%BB%E5%BD%95%E6%A3%80%E6%9F%A5"><span class="nav-text">拦截器进行登录检查</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-CRUD"><span class="nav-text">5. CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#R%E2%80%94%E2%80%94%E5%88%97%E8%A1%A8%E9%A1%B5%E9%9D%A2"><span class="nav-text">R——列表页面</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5%E9%AB%98%E4%BA%AE%E2%80%94%E2%80%94%E9%A1%B5%E9%9D%A2%E5%9D%97%E5%8F%82%E6%95%B0"><span class="nav-text">链接高亮——页面块参数</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Thymeleaf%E9%81%8D%E5%8E%86%E5%8F%96%E5%87%BA%E6%95%B0%E6%8D%AE-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E8%B0%83%E6%95%B4-%E5%88%97%E8%A1%A8%E7%95%8C%E9%9D%A2"><span class="nav-text">Thymeleaf遍历取出数据+数据格式调整+列表界面</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#C%E2%80%94%E2%80%94%E6%96%B0%E5%A2%9E"><span class="nav-text">C——新增</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%96%B0%E5%A2%9E%E9%A1%B5%E9%9D%A2-%E8%A1%A8%E5%8D%95"><span class="nav-text">跳转到新增页面+表单</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E8%A1%8C%E4%B8%BA"><span class="nav-text">新增行为</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE-%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-text">添加数据+日期类型格式转换</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UD%E6%9C%89%E5%A4%A9%E5%9D%91%E2%80%94%E2%80%94%E5%BC%80%E5%90%AFHiddenHttpMethodFilter"><span class="nav-text">UD有天坑——开启HiddenHttpMethodFilter</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#U%E2%80%94%E2%80%94%E4%BF%AE%E6%94%B9-Thymeleaf%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="nav-text">U——修改+Thymeleaf条件判断</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#D%E2%80%94%E2%80%94Thymeleaf%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="nav-text">D——Thymeleaf自定义属性值</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Thymeleaf%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="nav-text">Thymeleaf自定义属性值</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6"><span class="nav-text">错误处理机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6"><span class="nav-text">处理机制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4"><span class="nav-text">步骤:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="nav-text">涉及到的组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2%EF%BC%9F"><span class="nav-text">如何定制错误页面？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%9C%89%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="nav-text">_1. 有模板引擎_</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Thymeleaf%E5%BC%80%E5%90%AF%E6%8E%A5%E6%94%B6%E5%BC%82%E5%B8%B8%E4%BF%A1%E6%81%AF"><span class="nav-text">Thymeleaf开启接收异常信息</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E6%89%BE%E4%B8%8D%E5%88%B0%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2"><span class="nav-text">2. 模板引擎找不到错误页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BB%A5%E4%B8%8A%E9%83%BD%E6%B2%A1%E6%9C%89"><span class="nav-text">3. 以上都没有</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6%E9%94%99%E8%AF%AF%E7%9A%84JSON%E6%95%B0%E6%8D%AE"><span class="nav-text">如何定制错误的JSON数据?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-ExceptionHandler-XXX-class"><span class="nav-text">1. @ExceptionHandler(XXX.class)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%BD%AC%E5%8F%91%E5%88%B0-error-%E8%AF%B7%E6%B1%82"><span class="nav-text">2. 转发到 &#x2F;error 请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%90%BA%E5%B8%A6%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%AE%9E%E7%8E%B0%E8%87%AA%E9%80%82%E5%BA%94%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86"><span class="nav-text">_3. 携带自定义属性实现自适应响应处理_</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="nav-text">实现</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E5%AE%B9%E5%99%A8"><span class="nav-text">Servlet容器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6%E5%92%8C%E4%BF%AE%E6%94%B9Servet%E5%AE%B9%E5%99%A8%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 如何定制和修改Servet容器的相关配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%B3%A8%E5%86%8C%E4%B8%89%E5%A4%A7%E7%BB%84%E4%BB%B6%E2%80%94%E2%80%94Servlet%E3%80%81Filter%E3%80%81Listener"><span class="nav-text">2. 注册三大组件——Servlet、Filter、Listener</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ServletRegistrationBean"><span class="nav-text">ServletRegistrationBean</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#DispatcherServlet%E7%9A%84%E6%B3%A8%E5%86%8C"><span class="nav-text">DispatcherServlet的注册</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FilterRegistrationBean"><span class="nav-text">FilterRegistrationBean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Listener"><span class="nav-text">Listener</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%88%87%E6%8D%A2%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8"><span class="nav-text">3. 切换嵌入式Servlet容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="nav-text">4. 嵌入式Servlet容器自动配置原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="nav-text">自动配置原理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ServletWebServerFactoryAutoConfiguration%E2%80%94%E2%80%94Servlet%E5%AE%B9%E5%99%A8%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="nav-text">ServletWebServerFactoryAutoConfiguration——Servlet容器自动配置类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ServletWebServerFactory"><span class="nav-text">ServletWebServerFactory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#eg%EF%BC%9AEmbeddedTomcatWebServerFactory"><span class="nav-text">eg：EmbeddedTomcatWebServerFactory</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9%E5%8E%9F%E7%90%86"><span class="nav-text">配置修改原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-xx%E4%BB%A5%E4%B8%8B"><span class="nav-text">2.xx以下</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#EmbeddedServletContainerAutoConfiguration"><span class="nav-text">EmbeddedServletContainerAutoConfiguration</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86"><span class="nav-text">5. 嵌入式Servlet容器启动原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E5%88%87%E6%8D%A2%E5%A4%96%E9%83%A8Servlet%E5%AE%B9%E5%99%A8"><span class="nav-text">6. 切换外部Servlet容器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%83%A8Servlet%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8SpringBoot%E5%BA%94%E7%94%A8%E5%8E%9F%E7%90%86"><span class="nav-text">外部Servlet容器启动SpringBoot应用原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C"><span class="nav-text">操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE"><span class="nav-text">数据访问</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JDBC"><span class="nav-text">JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-1"><span class="nav-text">原理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="nav-text">数据源配置原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#sql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="nav-text">sql语句执行原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%A7%E8%A1%8Csql%E8%AF%AD%E5%8F%A5"><span class="nav-text">执行sql语句</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">操作数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Durid"><span class="nav-text">Durid</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="AmosTian" src="/images/avatar.png"><p class="site-author-name" itemprop="name">AmosTian</p><div class="site-description" itemprop="description">知道的越多，不知道的越多</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">412</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">66</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">83</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AmosTian" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AmosTian" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/qq_40479037?type=blog" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_40479037?type&#x3D;blog" rel="noopener" target="_blank"><i class="fa fa-fw fa-crosshairs"></i>CSDN</a> </span><span class="links-of-author-item"><a href="mailto:17636679561@163.com" title="E-Mail → mailto:17636679561@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("01/27/2022 15:13:14"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-grav"></i> </span><span class="author" itemprop="copyrightHolder">AmosTian</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">站点总字数 </span><span title="站点总字数">1175.7k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">47:55</span></div></div></footer></div><script color="0,0,0" opacity="0.5" zindex="-1" count="150" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'neutral',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}</script><script async src="/js/cursor/fireworks.js"></script><script src="/js/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"live2d-widget-model-hijiki"},display:{position:"right",width:150,height:300},mobile:{show:!1},log:!1})</script></body></html>