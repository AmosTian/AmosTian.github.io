<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa:300,300italic,400,400italic,700,700italic|Ma Shan Zheng:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"amostian.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="基本的文件权限与目录配置（Linux是多用户多任务的环境，文件权限的管理很重要） Linux文件与目录管理 用户身份 磁盘与文件系统管理 挂载、虚拟内存容量扩充 文件的压缩与打包"><meta property="og:type" content="article"><meta property="og:title" content="Linux文件系统"><meta property="og:url" content="https://amostian.github.io/posts/2763264027/index.html"><meta property="og:site_name" content="AmosTian"><meta property="og:description" content="基本的文件权限与目录配置（Linux是多用户多任务的环境，文件权限的管理很重要） Linux文件与目录管理 用户身份 磁盘与文件系统管理 挂载、虚拟内存容量扩充 文件的压缩与打包"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250729094207666.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250806200639071.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/ubuntu2204%E7%9B%AE%E5%BD%95%E6%A0%91.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250806225628149.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250809184940788.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250809184945687.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250810192928754.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250903112013144.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250903171310971.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250902184129938.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909140257677.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909140352531.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909140412685.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909140436217.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909140752135.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250909183952470.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250911110808290.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826162455972.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826170010171.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826170044081.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826170226427.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826170150945.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826174514279.png"><meta property="og:image" content="https://amostian.github.io/posts/2763264027/image-20250826174627256.png"><meta property="article:published_time" content="2025-07-29T01:04:55.000Z"><meta property="article:modified_time" content="2025-12-07T02:55:03.106Z"><meta property="article:author" content="AmosTian"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://amostian.github.io/posts/2763264027/image-20250729094207666.png"><link rel="canonical" href="https://amostian.github.io/posts/2763264027/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Linux文件系统 | AmosTian</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">AmosTian</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">68</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">83</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">236</span></a></li><li class="menu-item menu-item-essay"><a href="/categories/%E9%9A%8F%E7%AC%94/" rel="section"><i class="fa fa-fw fa-pied-piper"></i>随笔</a></li><li class="menu-item menu-item-dynamic-resume"><a href="/dynamic-resume/" rel="section"><i class="fa fa-fw fa-cog"></i>动态简历</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a href="https://github.com/AmosTian" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://amostian.github.io/posts/2763264027/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="AmosTian"><meta itemprop="description" content="知道的越多，不知道的越多"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="AmosTian"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Linux文件系统</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间 2025-07-29 09:04:55" itemprop="dateCreated datePublished" datetime="2025-07-29T09:04:55+08:00">2025-07-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间 2025-12-07 10:55:03" itemprop="dateModified" datetime="2025-12-07T10:55:03+08:00">2025-12-07</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数 </span><span title="本文字数">23.2k字 </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>46 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><ul><li>基本的文件权限与目录配置（Linux是多用户多任务的环境，文件权限的管理很重要）</li><li>Linux文件与目录管理</li><li>用户身份</li><li>磁盘与文件系统管理</li><li>挂载、虚拟内存容量扩充</li><li>文件的压缩与打包</li></ul></blockquote><span id="more"></span><h2 id="1-文件信息、权限、操作"><a href="#1-文件信息、权限、操作" class="headerlink" title="1. 文件信息、权限、操作"></a>1. 文件信息、权限、操作</h2><h3 id="文件信息查看"><a href="#文件信息查看" class="headerlink" title="文件信息查看"></a>文件信息查看</h3><p><code>ls -al</code> ：列出所有的文件详细权限与属性</p><p><img src="/posts/2763264027/image-20250729094207666.png" alt="image-20250729094207666"></p><blockquote><p><code>ls</code> 指令的选项， <code>-a</code> 表示显示隐藏文件</p></blockquote><h4 id="第一栏：文件类型-不同用户身份的权限"><a href="#第一栏：文件类型-不同用户身份的权限" class="headerlink" title="第一栏：文件类型+不同用户身份的权限"></a>第一栏：文件类型+不同用户身份的权限</h4><p>第一个字符表示文件类型</p><ul><li><code>d</code> ：表示目录（directory）</li><li><code>-</code>：表示文件，包括：<ul><li>纯文本文件（ASCII）</li><li>二进制文件——指令或可执行程序</li><li>数据格式文件：特殊的编码格式</li></ul></li><li><code>l</code> ：表示链接文件</li><li>设备与装置文件（device）<ul><li><code>b</code>（block，区块设备文件） ：表示设备文件中的可随机存取设备</li><li><code>c</code>（character，字符设备文件） ：表示设备文件中的串口设备（一次性读取设备）</li></ul></li><li><code>s</code>（sockets，数据接口文件）：服务端可以将一个文件配置为socket来监听客户端要求，客户端通过socket文件便可进行数据沟通</li><li><code>p</code>（FIFO.pipe，数据输送文件）：解决多个程序同时存取一个文件</li></ul><p>之后的9个字符，三个一组，表示不同身份的用户对当前文件的权限，若没有相应权限，则会用 <code>-</code> 占位</p><ul><li>第一组：文件拥有者具有的权限</li><li>第二组：同群组拥有的权限</li><li>第三组：others身份的用户拥有的权限</li></ul><h4 id="第二栏：链接数"><a href="#第二栏：链接数" class="headerlink" title="第二栏：链接数"></a>第二栏：链接数</h4><blockquote><p>表示多少文件被链接到此文件的 <strong>i-node</strong> 中</p></blockquote><p>每个文件都会将其权限与属性记录到文件系统的 <strong>inode</strong> 中</p><p>目录树采用文件名标识</p><p>每个文件名都会有链接到一个元数据文件（inode）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可仅查看目标目录的链接数</span></span><br><span class="line">ls -ld 目标目录</span><br></pre></td></tr></table></figure><h4 id="第三栏：文件拥有者与所属群组"><a href="#第三栏：文件拥有者与所属群组" class="headerlink" title="第三栏：文件拥有者与所属群组"></a>第三栏：文件拥有者与所属群组</h4><blockquote><p>文件与目录的可存取身份分为三个类别：owner、group、others</p><p>每个身份有read/write/excute等权限</p></blockquote><h4 id="第五栏：文件大小"><a href="#第五栏：文件大小" class="headerlink" title="第五栏：文件大小"></a>第五栏：文件大小</h4><p>默认单位为bytes</p><h4 id="第六栏：文件最近的修改日期"><a href="#第六栏：文件最近的修改日期" class="headerlink" title="第六栏：文件最近的修改日期"></a>第六栏：文件最近的修改日期</h4><blockquote><p>文件创建日期或最近的修改日期</p></blockquote><p>显示完整的时间格式：<code>ls -l --full-time</code></p><h4 id="Linux文件的其他属性"><a href="#Linux文件的其他属性" class="headerlink" title="Linux文件的其他属性"></a>Linux文件的其他属性</h4><p><strong>扩展名</strong>：Linux下的文件是否可被执行由 <code>x</code> 权限确定，与文件扩展名无关</p><ul><li><p>但具体是否可被执行成功由文件内容决定</p></li><li><p>常用扩展名：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*.sh：脚本或批处理文件</span><br><span class="line">*.Z 、*.tar、 *.tar.gz、 *.tgz：压缩包</span><br></pre></td></tr></table></figure></li></ul><p><strong>文件名的限制</strong>：</p><ul><li><p>长度限制：传统的EXT2/EXT3/EXT4文件系统，以及XFS文件系统</p><ul><li>单一文件或目录的文件名最多占用255B（ASCII的英文，最多255个字符）</li></ul></li><li><p>命名限制：</p><ul><li><p>避免特殊字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* ? &gt; &lt; ; &amp; ! [ ] | \ &#x27; &quot; ` ( ) &#123; &#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><h4 id="普通文件"><a href="#普通文件" class="headerlink" title="普通文件"></a>普通文件</h4><p>普通文件是存放数据、程序等信息的文件，包括：文本文件、数据文件、可执行的二进制程序文件等</p><p>通过 <code>file [文件名]</code> 指令查看指定文件的类型。</p><ul><li>支持通配符 <code>file *</code> 查看目录下所有文件的类型</li></ul><h4 id="目录文件"><a href="#目录文件" class="headerlink" title="目录文件"></a>目录文件</h4><p>目录是一种特殊的文件</p><p>仅root权限的用户可修改目录文件，用户进程可以读取目录内容，但不允许修改</p><h4 id="设备文件"><a href="#设备文件" class="headerlink" title="设备文件"></a>设备文件</h4><p>在Unix/Linux中，每个设备都被映射为一个文件，即设备文件。</p><p>用于向I/O设备提供连接的文件，分为：字符设备和块设备文件</p><ul><li>字符设备：以字节为单位存取数据</li><li>块设备：以字符块为单位，</li></ul><p>每种I/O设备对应一种设备文件</p><h4 id="管道文件"><a href="#管道文件" class="headerlink" title="管道文件"></a>管道文件</h4><p>用于进程间的通信</p><h4 id="链接文件"><a href="#链接文件" class="headerlink" title="链接文件"></a>链接文件</h4><p>软链接（符号链接）</p><p>硬链接</p><h3 id="文件权限"><a href="#文件权限" class="headerlink" title="文件权限"></a>文件权限</h3><blockquote><p>文件权限是文件的访问控制权限，即哪些用户和群组可以访问文件以及可以进行什么样的操作</p><ul><li>每个文件或目录都包含访问权限</li></ul><p>文件权限的最大作用体现在 <strong>数据安全性</strong> 上</p><ul><li>系统文件保护</li><li>团队开发软件或数据共享的功能</li></ul></blockquote><h4 id="访问用户"><a href="#访问用户" class="headerlink" title="访问用户"></a>访问用户</h4><p>owner——文件拥有者</p><ul><li>具有该文件的所有权限</li><li>root用户具有最高权限，即使不是文件拥有者</li></ul><p>group——群组</p><ul><li>群组内成员，具有对某个文件相同的权限</li><li>一个用户可属于多个群组</li></ul><p>others——其他</p><ul><li>对一个文件而言，除上述两种身份，则都为others身份</li></ul><blockquote><p>用户信息记录文件：包括一般身份使用者与root用户，都记录在 <em>/etc/passwd</em> 文件内</p><p>用户密码：记录在 <em>/etc/shadow</em> 文件内</p><p>群组名：记录在 <em>/etc/group</em> 文件内</p></blockquote><h5 id="用户与用户组修改"><a href="#用户与用户组修改" class="headerlink" title="用户与用户组修改"></a>用户与用户组修改</h5><p><strong>chgrp</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">递归低修改目录下所有文件</span></span><br><span class="line">chgrp 群组名 -R dirname/filename</span><br></pre></td></tr></table></figure><blockquote><p>群组名 必须在 <em>/etc/group</em> 文件内</p></blockquote><p><strong>chown</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R 用户名:群组名 dirname/filename</span><br></pre></td></tr></table></figure><ul><li>用户名与群组名之间用 <code>.</code> 或 <code>:</code> 分隔（用户名可包含 <code>.</code>，所以最好用 <code>:</code>）</li><li>缺省用户名可仅修改群组，<code>chown .群组名 filename</code></li></ul><blockquote><p>复制行为，会将执行者的属性与权限都拷贝，所以会涉及到文件权限的修改</p></blockquote><h4 id="普通权限——rwx"><a href="#普通权限——rwx" class="headerlink" title="普通权限——rwx"></a>普通权限——rwx</h4><div class="table-container"><table><thead><tr><th></th><th>内容</th><th>r</th><th>w</th><th>x</th><th></th></tr></thead><tbody><tr><td>文件</td><td>文本、数据内容、二进制可执行文件等</td><td>读取文件的实际内容</td><td>修改文件内容<br>（不包括删除文件）</td><td>执行文件内容</td><td>针对文件内容的权限</td></tr><tr><td>目录</td><td>文件名列表</td><td>读取文件名</td><td>修改文件名</td><td>进入该目录的权限</td><td>操作目录文件就是操作目录中的文件</td></tr></tbody></table></div><p>目录的权限：</p><ul><li><strong>r</strong> ：具有读取目录结构的权限，返回文件名列表</li><li><strong>w</strong><ul><li>建立新的文件与目录</li><li>删除已存在的文件与目录</li><li>将已存在的文件或目录更名</li><li>移动目录内的文件</li><li>移动目录的位置</li></ul></li><li><strong>x</strong>：进入该目录的权限</li></ul><blockquote><p>浏览目录下的文件，至少需要 <em>rx</em> 权限</p><p><strong>w</strong> 权限，谨慎赋予</p><p>用户dmtsai，root用户在其根目录下，新建 <em>/home/dmtsai/the_root.data</em> ，并且将其权限修改为 <code>rwx------</code>。尽管dmtsai用户不能读取和修改文件内容，但由于具有家目录权限 <code>rwx</code>，所以可以删除该文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 首先，使用root用户创建示例</span></span></span><br><span class="line">[root@study ~]# cd /tmp &lt;==切换工作目录到/tmp</span><br><span class="line">[root@study tmp]# mkdir testing &lt;==建立新目录</span><br><span class="line">[root@study tmp]# chmod 744 testing &lt;==变更权限</span><br><span class="line">[root@study tmp]# touch testing/testing &lt;==建立空的文件</span><br><span class="line">[root@study tmp]# chmod 600 testing/testing &lt;==变更权限</span><br><span class="line">[root@study tmp]# ls -ald testing testing/testing</span><br><span class="line">drwxr--r--. 2 root root 20 Jun 3 01:00 testing</span><br><span class="line">-rw-------. 1 root root 0 Jun 3 01:00 testing/testing</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 然后，切换dmtsai用户，访问该目录</span></span></span><br><span class="line">[dmtsai@study ~]$ cd /tmp</span><br><span class="line">[dmtsai@study tmp]$ ls -l testing/</span><br><span class="line">ls: cannot access testing/testing: Permission denied</span><br><span class="line">total 0</span><br><span class="line">?????????? ? ? ? ? ? testing</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">虽然有告知权限不足，但因为具有 r 的权限可以查询档名。由于权限不足(没有x)，所以会有一堆问号。</span></span><br><span class="line">[dmtsai@study tmp]$ cd testing/</span><br><span class="line">-bash: cd: testing/: Permission denied</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">因为不具有 x ，所以当然没有进入的权限啦！有没有呼应前面的权限说明啊！</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 最后，修改目录拥有者为 dmtsai</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 先用 root 的身份来搞定 /tmp/testing 的属性、权限设定：</span></span><br><span class="line">[root@study tmp]# chown dmtsai /tmp/testing</span><br><span class="line">[root@study tmp]# ls -ld /tmp/testing</span><br><span class="line">drwxr--r--. 2 dmtsai root 20 6 月 3 01:00 /tmp/testing # dmtsai 是具有全部权限的！</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 再用 dmtsai 的账号来处理一下 /tmp/testing/testing 这个文件看看：</span></span><br><span class="line">[dmtsai@study tmp]$ cd /tmp/testing</span><br><span class="line">[dmtsai@study testing]$ ls -l &lt;==确实是可以进入目录</span><br><span class="line">-rw-------. 1 root root 0 Jun 3 01:00 testing &lt;==文件不是vbird 的！</span><br><span class="line">[dmtsai@study testing]$ rm testing &lt;==尝试杀掉这个文件看看！</span><br><span class="line">rm: remove write-protected regular empty file `testing&#x27;? y</span><br></pre></td></tr></table></figure></blockquote><h4 id="特殊权限"><a href="#特殊权限" class="headerlink" title="特殊权限"></a>特殊权限</h4><h5 id="SUID权限"><a href="#SUID权限" class="headerlink" title="SUID权限"></a>SUID权限</h5><blockquote><p>Set UID：执行者通过可执行文件（指令）对其他文件操作时，执行者将具有可执行文件的拥有者权限</p></blockquote><p>条件：</p><ul><li>仅对二进制可执行文件有效</li><li>执行者对可执行文件，具有x可执行权限</li><li>仅在指令运行期间有效</li></ul><blockquote><p>如：/etc/shadow记录所有用户与密码信息，且权限为”————— 1 root root”，表明仅root用户可修改</p><p>但任意用户，可使用/usr/bin/passwd指令可修改任意用户的密码</p><ul><li><em>/usr/bin/passwd</em> 的文件权限为 “-rwsr-xr-x”，即所有用户具有该指令的可执行权限</li><li>passwd的拥有者为root</li><li>用户dmtsai执行passwd指令时，将暂时具有root用户的权限</li><li>dmtsai用户可通过 passwd指令对 <em>/etc/shadow</em> 进行修改</li></ul><p><img src="/posts/2763264027/image-20250806200639071.png" alt="image-20250806200639071"></p></blockquote><h5 id="SGID权限"><a href="#SGID权限" class="headerlink" title="SGID权限"></a>SGID权限</h5><p><strong>作用于可执行文件</strong>：</p><ul><li><p>执行者通过可执行文件（指令）对其他文件操作时，执行者将具有可执行文件的群组权限</p></li><li><p>条件：</p><ul><li><p>SGID仅作用于可执行文件</p></li><li><p>程序执行者对可执行文件，具有x可执行权限‘</p></li></ul></li><li><blockquote><p>[root@study ~]# ll /usr/bin/locate /var/lib/mlocate/mlocate.db<br>-rwx—s—x. 1 root slocate 40496 Jun 10 2014 /usr/bin/locate<br>-rw-r——-. 1 root slocate 2349055 Jun 15 03:44 /var/lib/mlocate/mlocate.db</p><p>可见，所有用户拥有对locate指令的执行权限，但mlocate.db文件非root用户及slocate用户不可查看</p><p>因为locate有SGID权限，所以任何执行locate指令时，将被赋予slocate群组权限</p></blockquote></li></ul><p><strong>作用于目录</strong>：</p><ul><li>对目录赋予SGID权限，新建文件的群组将与执行者一致</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0. 创建用户及群组</span></span><br><span class="line">[root@study ~]# groupadd project &lt;==增加新的群组</span><br><span class="line">[root@study ~]# useradd -G project alex &lt;==建立 alex 账号，且支持 project</span><br><span class="line">[root@study ~]# useradd -G project arod &lt;==建立 arod 账号，且支持 project</span><br><span class="line">[root@study ~]# id alex &lt;==查阅 alex 账号的属性</span><br><span class="line">uid=1001(alex) gid=1002(alex) groups=1002(alex),1001(project) &lt;==确实有支持！</span><br><span class="line">[root@study ~]# id arod</span><br><span class="line">uid=1002(arod) gid=1003(arod) groups=1003(arod),1001(project) &lt;==确实有支持！</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 创建目录</span></span><br><span class="line">[root@study ~]# mkdir /srv/ahome</span><br><span class="line">[root@study ~]# chgrp project /srv/ahome</span><br><span class="line">[root@study ~]# chmod 770 /srv/ahome</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 可见，目录群组为project</span></span></span><br><span class="line">[root@study ~]# ll -d /srv/ahome</span><br><span class="line">drwxrwx---. 2 root project 6 Jun 17 00:22 /srv/ahome</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 一个用户创建文件</span></span><br><span class="line">[root@study ~]# su - alex &lt;==先切换身份成为 alex 来处理</span><br><span class="line">[alex@www ~]$ cd /srv/ahome &lt;==切换到群组的工作目录去</span><br><span class="line">[alex@www ahome]$ touch abcd &lt;==建立一个空的文件出来！</span><br><span class="line">[alex@www ahome]$ ll abcd</span><br><span class="line">-rw-rw-r--. 1 alex alex 0 Jun 17 00:23 abcd</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 由于群组是 alex ，arod 并不可访问alex创建的abcd文件</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># alex具有ahome目录的xw权限，所以可以删除abcd</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. 为目录设置SGID权限</span></span><br><span class="line">[root@study ~]# chmod 2770 /srv/ahome</span><br><span class="line">[root@study ~]# su - alex</span><br><span class="line">[alex@www ~]$ cd /srv/ahome</span><br><span class="line">[alex@www ahome]$ touch 1234</span><br><span class="line">[alex@www ahome]$ ll 1234</span><br><span class="line">-rw-rw-r--. 1 alex project 0 Jun 17 00:25 1234</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># alex所属群组为project，执行touch指令创建的文件，会属于project群组</span></span></span><br></pre></td></tr></table></figure><h5 id="SBIT权限"><a href="#SBIT权限" class="headerlink" title="SBIT权限"></a>SBIT权限</h5><blockquote><p>Set Stricky Bit：当目录被赋予SBIT权限后，用户仅能对自己建立的文件/目录进行操作，无法修改其他人的文件</p><p>root仍拥有该目录的最高操作权限</p></blockquote><p>条件：</p><ul><li>用户对当前目录具有w，x权限，即具有进入与写入的权限</li></ul><blockquote><p><em>/tmp</em> 目录的权限为 “drwxrwxrwt”，任何人都可在 <em>/tmp</em> 内新增、修改文件，但仅文件拥有者与root用户可删除自建的文件或目录</p></blockquote><h4 id="权限的修改——chmod"><a href="#权限的修改——chmod" class="headerlink" title="权限的修改——chmod"></a>权限的修改——chmod</h4><h5 id="数字类型改变文件权限"><a href="#数字类型改变文件权限" class="headerlink" title="数字类型改变文件权限"></a>数字类型改变文件权限</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chmod -R sxyz/xyz 文件名</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">s表示特殊权限</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">x表示拥有者的权限值</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">y表示群组的权限值</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">z表示others群组的权限值</span></span><br></pre></td></tr></table></figure><p>普通权限：每种身份的权限为三种权限的累加，如赋予读、写、执行权限，则为7</p><div class="table-container"><table><thead><tr><th>权限占位</th><th>拥有者权限</th><th>群组权限</th><th>其他人权限</th></tr></thead><tbody><tr><td>1</td><td>r：4</td><td>r：4</td><td>r：4</td></tr><tr><td>2</td><td>w：2</td><td>w：2</td><td>w：2</td></tr><tr><td>3</td><td>x：1</td><td>x：1</td><td>x：1</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 775 文件名</span><br></pre></td></tr></table></figure><p>特殊权限：拥有的特殊权限累加</p><div class="table-container"><table><thead><tr><th>权限占位</th><th>拥有者权限</th><th>群组权限</th><th>其他人权限</th></tr></thead><tbody><tr><td>3</td><td>s(SUID)：4</td><td>s(SGID)：2</td><td>t(SBIT)：1</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# cd /tmp</span><br><span class="line">[root@study tmp]# touch test &lt;==建立一个测试用空档</span><br><span class="line">[root@study tmp]# chmod 4755 test; ls -l test &lt;==加入具有 SUID 的权限</span><br><span class="line">-rwsr-xr-x 1 root root 0 Jun 16 02:53 test</span><br><span class="line"></span><br><span class="line">[root@study tmp]# chmod 6755 test; ls -l test &lt;==加入具有 SUID/SGID 的权限</span><br><span class="line">-rwsr-sr-x 1 root root 0 Jun 16 02:53 test</span><br></pre></td></tr></table></figure><p>对于不具有特殊权限条件，但设定特殊权限，会以S,T占位</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@study tmp]# chmod 7666 test; ls -l test &lt;==具有空的 SUID/SGID 权限</span><br><span class="line">-rwSrwSrwT 1 root root 0 Jun 16 02:53 test</span><br></pre></td></tr></table></figure><ul><li>首先赋予test文件rw权限，但不具有x权限，所以实际上不具备所有特殊权限，故用S和T占位</li></ul><h5 id="符号类型修改文件权限"><a href="#符号类型修改文件权限" class="headerlink" title="符号类型修改文件权限"></a>符号类型修改文件权限</h5><p>指令格式</p><div class="table-container"><table><thead><tr><th>chmod</th><th>u：用户<br>g：群组<br>o：其他群组<br>a：全部</th><th>+：赋予权限<br>-：解除权限<br>=：设定权限</th><th>s<br>r<br>w<br>x</th><th>文件或目录</th></tr></thead><tbody><tr><td></td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">例子</span></span><br><span class="line">chmod u=rwxs,go=rx 文件名</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">赋予所有用户写权限</span></span><br><span class="line">chmod a+w 文件名</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解除所有用户的写权限</span></span><br><span class="line">chmod a-w 文件名</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设定权限成为 -rws--x--x 的模样：</span></span><br><span class="line">[root@study tmp]# chmod u=rwxs,go=x test; ls -l test</span><br><span class="line">-rws--x--x 1 root root 0 Jun 16 02:53 test</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">承上，加上 SGID 与 SBIT 在上述的文件权限中！</span></span><br><span class="line">[root@study tmp]# chmod g+s,o+t test; ls -l test</span><br><span class="line">-rws--s--t 1 root root 0 Jun 16 02:53 test</span><br></pre></td></tr></table></figure><h4 id="默认权限"><a href="#默认权限" class="headerlink" title="默认权限"></a>默认权限</h4><p>系统的预设权限</p><ul><li>对于文件，默认不开放执行权限，预设权限为666，即 <strong>-rw-rw-rw-</strong></li><li>对于目录，默认开放执行权限，预设权限为777，即 <strong>drwxrwxrwx</strong></li></ul><p><code>umask</code> 为系统预设权限的掩码，进而指定当前用户在创建文件或目录时的默认权限</p><blockquote><p>当设定 <code>umask 003</code></p><ul><li>对于文件：(-rw-rw-rw-) - (———-wx) ==&gt; -rw-rw-r—</li><li>对于目录：(drwxrwxrwx) - (d———-wx) = drwxrwxr—</li></ul><p>计算方式：掩码二进制取反，和预设权限的二进制相与，得出修改后的默认权限</p></blockquote><h3 id="文件隐藏属性"><a href="#文件隐藏属性" class="headerlink" title="文件隐藏属性"></a>文件隐藏属性</h3><p>在Linux传统的Ext2/Ext3/Ext4文件系统下，可以为文件设定其他隐藏属性</p><h4 id="查看隐藏属性——lsattr"><a href="#查看隐藏属性——lsattr" class="headerlink" title="查看隐藏属性——lsattr"></a>查看隐藏属性——lsattr</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsattr [-选项] 文件/目录</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td></td><td>显示隐藏的属性</td></tr><tr><td>-d</td><td></td><td>若是目录，仅列与目录本身的属性，不显示目录内文件</td></tr><tr><td>-R</td><td></td><td>连同目录内文件的隐藏属性也显示</td></tr></tbody></table></div><h4 id="配置隐藏属性——chattr"><a href="#配置隐藏属性——chattr" class="headerlink" title="配置隐藏属性——chattr"></a>配置隐藏属性——chattr</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chattr [+-=][属性] 文件/目录</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>操作</th><th>选项</th><th>含义</th></tr></thead><tbody><tr><td>+</td><td></td><td>添加权限</td></tr><tr><td>-</td><td></td><td>移除权限</td></tr><tr><td>=</td><td></td><td>设定权限</td></tr><tr><td></td><td>A</td><td>存取当前文件，访问时间atime不会被改变</td></tr><tr><td></td><td>S</td><td>对文件的修改，同步下刷到磁盘</td></tr><tr><td></td><td>c</td><td>自动压缩文件<br>写入时，自动压缩再落盘；读取时，自动解压缩</td></tr><tr><td></td><td>d</td><td>不会被dump程序备份</td></tr><tr><td></td><td>i</td><td>文件不可被删除、更名、设定链接等，同时也无法写入数据</td></tr><tr><td></td><td>a</td><td>文件仅能追加数据，仅root用户可设定</td></tr><tr><td></td><td>s</td><td>若文件删除，直接移除硬盘，无法撤回</td></tr><tr><td></td><td>u</td><td>若文件删除，则数据内容仍存在硬盘</td></tr></tbody></table></div><ul><li>XFS文件系统仅支持 AadiS</li></ul><h3 id="对文件的操作"><a href="#对文件的操作" class="headerlink" title="对文件的操作"></a>对文件的操作</h3><p><code>cat</code> ：由第一行开始显示文件内容</p><p><code>tac</code>：由文件最后一行显示文件内容</p><p><code>nl</code>：显示文件内容时，输出行号</p><p><code>more</code>：按页显示文件内容</p><p><code>less</code>：按页显示文件内容，可以向前翻页</p><p><code>head</code> ：仅显示前几行</p><p><code>tail</code> ：显示尾行</p><p><code>od</code> ：以二进制形式读取文件内容</p><h4 id="查看文件基本数据——file"><a href="#查看文件基本数据——file" class="headerlink" title="查看文件基本数据——file"></a>查看文件基本数据——file</h4><blockquote><p>判断文件属于文本文件，还是二进制文件</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file 文件名</span><br></pre></td></tr></table></figure><h4 id="查看文本文件内容"><a href="#查看文本文件内容" class="headerlink" title="查看文本文件内容"></a>查看文本文件内容</h4><h5 id="直接查看文件内容"><a href="#直接查看文件内容" class="headerlink" title="直接查看文件内容"></a>直接查看文件内容</h5><h6 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat -AbEnTv</span><br></pre></td></tr></table></figure><p>con<strong>cat</strong>enat（连续）</p><div class="table-container"><table><thead><tr><th>选项</th><th>含义</th><th></th></tr></thead><tbody><tr><td>-A</td><td>显示所有字符，包括换行符、Tab符、不可打印的特殊字符（-vET）</td><td></td></tr><tr><td></td><td>-v</td><td>列出不可打印的特殊字符</td></tr><tr><td></td><td>-E</td><td>显示结尾换行符，用 <code>$</code> 代替</td></tr><tr><td></td><td>-T</td><td>显示Tab符，以 <code>^I</code> 代替</td></tr><tr><td>-b</td><td>对内容列出行号，但空白行不标注</td><td></td></tr><tr><td>-n</td><td>对内容列出行号，空白行也会标注</td></tr></tbody></table></div><h6 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h6><blockquote><p>添加行号打印</p></blockquote><div class="table-container"><table><thead><tr><th>选项</th><th>含义</th><th></th></tr></thead><tbody><tr><td>-b</td><td>空白行是否显示行号</td><td></td></tr><tr><td></td><td>-b a</td><td>空白行也显示行号，同 <code>cat -n</code></td></tr><tr><td></td><td>-b t</td><td>空白行不显示行号</td></tr><tr><td>-n</td><td>行号表示方法</td><td></td></tr><tr><td></td><td>-n ln</td><td>行号在行最左侧显示</td></tr><tr><td></td><td>-n rn</td><td>行号在行最右侧显示，不用0占位</td></tr><tr><td></td><td>-n rz</td><td>行号在行最右侧显示，用0占位</td></tr><tr><td>-w</td><td>指定行号字段的占用字符数</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# nl -b a -n rz -w 3 /etc/issue</span><br><span class="line">001	Ubuntu 22.04.5 LTS \n \l</span><br><span class="line">002	</span><br></pre></td></tr></table></figure><h5 id="翻页查看文件内容"><a href="#翻页查看文件内容" class="headerlink" title="翻页查看文件内容"></a>翻页查看文件内容</h5><blockquote><p>适用于查看大量内容的文件，每次只显示一页</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more/less 路径</span><br></pre></td></tr></table></figure><p>more的操作键</p><ul><li>翻页与跳转<ul><li>空格 <code>space</code>：向下翻一<strong>页</strong></li><li>回车 <code>Enter</code>：向下翻一<strong>行</strong></li><li><code>b</code> 或 <code>CTRL+b</code>：向前翻一页，但仅可单行执行，管道输出的内容无效</li><li><code>p</code> 查看下一屏</li></ul></li><li>查找<ul><li><code>/[字符串]</code>：在当前显示的内容中，向下搜索[字符串]这个关键词</li></ul></li><li><code>:f</code>：立即显示文件名及目前显示的行数</li><li><code>q</code>：离开more输出的内容</li></ul><p>less的操作键</p><ul><li>翻页与跳转<ul><li>空格 <code>space</code>：下翻一<strong>页</strong></li><li><code>pagedown</code>：向下翻一<strong>页</strong></li><li><code>pageup</code>：向上翻一<strong>页</strong></li><li>回车 <code>Enter</code>：向下翻一<strong>行</strong></li><li><code>g</code>：跳转到首行</li><li><code>G</code>：跳转到末行</li><li><code>p</code> 查看下一屏</li></ul></li><li>查找<ul><li><code>/[字符串]</code>：在当前显示的内容中，向<strong>下</strong>搜索[字符串]</li><li><code>?[字符串]</code>：在当前显示的内容中，向<strong>上</strong>搜索[字符串]</li><li><code>n</code>（next）：向后搜索下一个</li><li><code>N</code>：向前搜索下一个</li></ul></li><li><code>:f</code>：立即显示文件名及目前显示的行数</li><li><code>q</code>：离开more输出的内容</li><li><code>b</code> 或 <code>CTRL+b</code>：向前翻一页，但仅可单行执行，管道输出的内容无效</li></ul><h5 id="内容截取"><a href="#内容截取" class="headerlink" title="内容截取"></a>内容截取</h5><h6 id="从前截取head"><a href="#从前截取head" class="headerlink" title="从前截取head"></a>从前截取head</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">head -n 数字 文件名</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取前20行内容</span></span><br><span class="line">head -n 20 /root/.bashrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取除后100行的前面所有内容</span></span><br><span class="line">head -n -100 /root/.bashrc</span><br></pre></td></tr></table></figure><h6 id="从后截取tail"><a href="#从后截取tail" class="headerlink" title="从后截取tail"></a>从后截取tail</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tail -n 数字 文件名</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取后20行内容</span></span><br><span class="line">tail -n 20 /root/.bashrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取除前100行外的后面所有聂荣</span></span><br><span class="line">tail -n +100 /root/.bashrc</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">持续检测文件内容，直至 CTRL+C后，才离开<span class="built_in">tail</span>的输出页面</span> </span><br><span class="line">tail -f 文件名</span><br></pre></td></tr></table></figure><h4 id="查看非文本文档内容——od"><a href="#查看非文本文档内容——od" class="headerlink" title="查看非文本文档内容——od"></a>查看非文本文档内容——od</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">od -t TYPE 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-t</td><td></td><td>调整非文本文档输出的格式</td></tr><tr><td></td><td>a</td><td>利用默认的字符输出</td></tr><tr><td></td><td>c</td><td>使用ASCII字符输出</td></tr><tr><td></td><td>d[size]</td><td>十进制输出数据，每个整数占size字节</td></tr><tr><td></td><td>f[size]</td><td>浮点数输出数据，每个数占size字节</td></tr><tr><td></td><td>o[size]</td><td>八进制输出数据，每个整数占size字节</td></tr><tr><td></td><td>x[size]</td><td>十六进制输出数据，每个整数占size字节</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出问价内容，以八进制列出值与其ASCII的对照表</span></span><br><span class="line">od -t oCc 文件名</span><br></pre></td></tr></table></figure><h4 id="创建文件或修改文件时间——touch"><a href="#创建文件或修改文件时间——touch" class="headerlink" title="创建文件或修改文件时间——touch"></a>创建文件或修改文件时间——touch</h4><blockquote><p>如果文件不存在，创建空白文件</p><p>如果文件存在，则修改时间</p></blockquote><p>一个文件有三种时间</p><ul><li>modification time（mtime）：文件内容数据最近的修改时间</li><li>status time（ctime）：文件状态修改时间，如权限或属性</li><li>access time（atime）：文件内容被读取，会更新该时间</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch [-选项] 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>含义</th><th></th></tr></thead><tbody><tr><td>-a</td><td>修改access time</td><td></td></tr><tr><td>-m</td><td>修改mtime</td><td></td></tr><tr><td>-c</td><td>修改文件的时间，不存在，则建立新文件</td><td></td></tr><tr><td>-d</td><td>修改为指定的日期</td><td></td></tr><tr><td>-t</td><td>修改为指定的时间，格式为YYYYMMDDhhmm</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">touch -d 时间 文件名</span><br><span class="line">atime 和mtime会被修改，由于文件的时间属性是当前修改的，所以ctime为当前时间</span><br><span class="line"></span><br><span class="line">touch -d &quot;2 days ago&quot; bashrc</span><br><span class="line">touch -t 201406150202 bashrc</span><br></pre></td></tr></table></figure><h4 id="文件搜索"><a href="#文件搜索" class="headerlink" title="文件搜索"></a>文件搜索</h4><h5 id="指令搜索"><a href="#指令搜索" class="headerlink" title="指令搜索"></a>指令搜索</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">which -a 指令</span><br></pre></td></tr></table></figure><p>根据PATH环境变量规定的路径搜索可执行文件名，并输出文件路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# which ifconfig</span><br><span class="line">/sbin/ifconfig</span><br></pre></td></tr></table></figure><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type</span><br></pre></td></tr></table></figure><p><code>history</code> 是bash支持的指令，并不在PATH环境变量的路径中</p><h2 id="目录管理"><a href="#目录管理" class="headerlink" title="目录管理"></a>目录管理</h2><h3 id="目录与路径"><a href="#目录与路径" class="headerlink" title="目录与路径"></a>目录与路径</h3><blockquote><p>在确定文件、目录位置时，DOS和Unix/Linux都采用 <strong>路径名+文件名</strong> 的方式。</p><ul><li><p>绝对路径：由根目录（<em>/</em>）开始写起的文件名或目录名</p><p>正确性更高</p></li><li><p>相对路径：相对当前目录的路径</p><p>使用更灵活</p></li></ul></blockquote><h4 id="特殊目录"><a href="#特殊目录" class="headerlink" title="特殊目录"></a>特殊目录</h4><ul><li><em>.</em>：当前目录</li><li><em>..</em>：上一层目录</li><li><em>-</em>：前一个工作目录</li><li><em>~</em>：当前用户的家目录</li><li><em>~[用户名]</em>：[用户名]的家目录</li></ul><blockquote><p>根目录下，也会存在 <em>.</em>与 <em>..</em> 这两个目录，其上层目录为根目录本身</p></blockquote><h4 id="获取路径-文件名"><a href="#获取路径-文件名" class="headerlink" title="获取路径/文件名"></a>获取路径/文件名</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# basename /usr/bin/ls</span><br><span class="line">ls</span><br><span class="line">root@tzj-virtual-machine:~# dirname /usr/bin/ls</span><br><span class="line">/usr/bin</span><br></pre></td></tr></table></figure><h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h4><blockquote><p>环境变量 <code>$PATH</code>：保存执行文件路径的系统变量</p></blockquote><ul><li>系统会按照 <code>$PATH</code> 环境变量的设定去搜索目标可执行文件</li><li>环境变量下存在多个同名目标可执行文件时，执行排序更靠前的</li><li>不同的用户环境变量不同</li><li>环境变量的每个目录中间，用 <code>:</code> 分隔</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br></pre></td></tr></table></figure><p>以<code>ls</code> 指令为例，了解 <code>$PATH</code> 的重要性：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0. 由目录树可见，<span class="built_in">ls</span>可执行文件所在的路径为/usr/bin</span></span><br><span class="line">root@tzj-virtual-machine:~# cd /usr/bin &amp;&amp; ls -al ls</span><br><span class="line">-rwxr-xr-x 1 root root 138216  2月  8  2024 ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 将<span class="built_in">ls</span>可执行文件移动位置</span></span><br><span class="line">root@tzj-virtual-machine:/usr/bin# mv /usr/bin/ls /root</span><br><span class="line">root@tzj-virtual-machine:/usr/bin# ls</span><br><span class="line">-bash: /usr/bin/ls: 没有那个文件或目录</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 使用绝对路径执行<span class="built_in">ls</span>指令</span></span><br><span class="line">root@tzj-virtual-machine:~# /root/ls -a</span><br><span class="line">.   .bash_history  .cache    ls        snap  .viminfo</span><br><span class="line">..  .bashrc	   .lesshst  .profile  .vim  .Xauthority</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. 将/root路径加入环境变量，再执行<span class="built_in">ls</span>指令</span></span><br><span class="line">root@tzj-virtual-machine:~# PATH=&quot;$&#123;PATH&#125;:/root&quot;</span><br><span class="line">root@tzj-virtual-machine:~# ls -a</span><br><span class="line">.   .bash_history  .cache    ls        snap  .viminfo</span><br><span class="line">..  .bashrc        .lesshst  .profile  .vim  .Xauthority</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">移动回原目录</span></span><br><span class="line">mv /root/ls /usr/bin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 即使ls移动回原目录，可能无法执行</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 可能是指令被缓存，只需注销（`exit`） 再登入即可（`su -`）</span></span></span><br></pre></td></tr></table></figure><h3 id="目录配置"><a href="#目录配置" class="headerlink" title="目录配置"></a>目录配置</h3><blockquote><p>Linux 于1994年对根目录做了统一的规范，推出 FHS ( Filesystem Hierarchy Standard ) 的 <em>文件系统层次结构标准</em></p><ul><li><p>FHS 标准规定了 Linux 根目录各文件夹的名称及作用</p></li><li><p>每套Linux distributions的目录配置都遵循FHS标准（Filesystem Hierarchy Standard）</p></li></ul></blockquote><p>FHS规定了根目录各目录的名称及每个特定目录下放置的数据文件类型</p><ul><li><em>/</em> （root，根目录）：与开机系统有关</li><li><em>/usr</em> （unix software resource）：与软件安装/执行有关</li><li><em>/var</em> （variable）：与系统运行过程有关</li></ul><p>FHS对目录的分类：</p><ul><li>可分享的（shareable）：能够分享给网络上其他主机挂载的目录</li><li>不可分享的：本机相关的文件，如设备文件或与程序相关的socket文件</li><li>不变的（static）：即使distributions变化，一些数据是变动不大，如依赖库，文件说明文件、系统配置文件</li><li>可变的（variable）：经常变化的文件</li></ul><div class="table-container"><table><thead><tr><th></th><th>shareable</th><th>unshareable</th></tr></thead><tbody><tr><td>static</td><td><em>/usr</em> （distributions提供的软件放置目录）</td><td><em>/etc</em> （配置文件）</td></tr><tr><td></td><td><em>/opt</em>（非distribution提供的第三方软件）</td><td><em>/boot</em>（开机与内核文件）</td></tr><tr><td>variable</td><td></td><td><em>/var/run</em>（程序相关）</td></tr><tr><td></td><td></td><td><em>/var/lock</em>（程序相关）</td></tr></tbody></table></div><h4 id="目录配置规范——FHS"><a href="#目录配置规范——FHS" class="headerlink" title="目录配置规范——FHS"></a>目录配置规范——FHS</h4><h5 id="根目录（-）"><a href="#根目录（-）" class="headerlink" title="根目录（/）"></a>根目录（<em>/</em>）</h5><blockquote><p>系统开机相关的文件：特定的开机软件、核心文件、开机所需程序、依赖库等</p><p>与文件系统修复相关的程序</p></blockquote><p><strong>根目录的分区槽小越好，且应用程序安装的软件不要与根目录放在一个分区</strong> ，避免频繁读写系统分区，降低出错概率</p><p><strong>根目录下的次目录</strong></p><blockquote><p>单人维护模式：以root用户登录，对系统进行维护</p><p>救援模式：从安装介质启动，以拷贝硬盘系统受损或丢失的文件，支持挂载本机文件系统</p><ul><li>早期的Linux，救援模式仅挂载根目录，所以重要目录必须放置在同一个分区（<em>/etc</em>，<em>/bin</em>，<em>/dev</em>，<em>/sbin</em>，<em>/lib</em>）</li><li>现代Linux distributions，已将许多非必要的文件移出 <em>/usr</em> 目录，因此，也建议挂载 <em>/usr</em> （该目录即使挂载为只读，系统也可以正常运行）</li></ul></blockquote><h6 id="必需目录"><a href="#必需目录" class="headerlink" title="必需目录"></a>必需目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/boot</em></td><td>在启动过程用到的文件，包括Linux核心文件（vmlinuz）、系统引导程序、开机选单与开机所需的配置文件等<br>若开机管理程序使用grub*，还会存在 <em>/boot/grub*</em> 这个目录</td></tr><tr><td><em>/dev</em></td><td>各设备以文件形式保存在该目录中，存取文件相当于存取设备<br><em>/dev/null</em> ，<em>/dev/zero</em>，<em>/dev/tty</em>，<em>/dev/loop**，</em>/dev/sd**</td></tr><tr><td><em>/bin</em></td><td>在单人维护模式下也可使用的指令（可执行的二进制文件）<br>这些指令可被root与一般用户使用</td></tr><tr><td><em>/sbin</em></td><td>用于系统设定的指令，仅root用户可执行，一般用户仅可查看<br>包括开机、修复、还原系统所需的指令<br>服务器软件程序的可执行文件，放置于<em>/usr/sbin</em>中，<br>本机自行安装产生的可执行文件，放置于<em>/usr/local/sbin</em></td></tr><tr><td><em>/etc</em></td><td>系统的配置文件，一般用户可以查看，仅root用户可修改<br>建议不要放置可执行文件<br>FHS规范的次级目录<br>- <em>/etc/opt</em>： <em>/opt</em>中第三方软件的配置文件</td></tr><tr><td><em>/lib</em></td><td>开机过程会使用的函数库，以及在 <em>/bin</em>或<em>/sbin</em>下的指令会调用的函数库<br>- <em>/lib/modules</em>：可替换的核心相关模块（驱动程序）</td></tr><tr><td><em>/opt</em></td><td>第三方软件的安装目录</td></tr><tr><td><em>/run</em></td><td>系统开机后产生的各项信息<br>旧版的FHS规定放置于<em>/var/run</em>，新版直接放置于根目录下</td></tr><tr><td><em>/tmp</em></td><td>临时文件目录</td></tr><tr><td><em>/srv</em></td><td>网络服务启动后，这些服务的数据目录<br>如：WWW服务器需要的网页资料放置在 <em>/srv/www</em>中</td></tr><tr><td><em>/usr</em></td><td></td></tr><tr><td><em>var</em></td></tr></tbody></table></div><h6 id="建议目录"><a href="#建议目录" class="headerlink" title="建议目录"></a>建议目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/home</em></td><td>系统默认的用户家目录<br>多用户模式下，每个用户都在 home 目录下创建专属的用户目录</td></tr><tr><td><em>/root</em></td><td>root用户家目录，如果进入单人维护模式，仅挂载根目录，root用户的家目录也会被挂载</td></tr></tbody></table></div><h6 id="非FHS规定，但重要的目录"><a href="#非FHS规定，但重要的目录" class="headerlink" title="非FHS规定，但重要的目录"></a>非FHS规定，但重要的目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/lost+found</em></td><td>使用ex2/ex3/ex4文件系统才会产生的目录<br>当文件系统发生错误，放置遗失的片段<br>xfs文件系统不会存在该目录</td></tr><tr><td><em>/proc</em></td><td>虚拟文件系统，数据实际放置于内存<br>包括系统内核、进程信息、外围设备及网络状态信息<br><em>/proc/cpuinfo</em>，<em>/proc/dma</em>、<em>/proc/interrupts</em>、<em>/proc/ioports</em>、<em>/proc/net/*</em>等</td></tr><tr><td><em>/sys</em></td><td>虚拟文件系统，数据实际放置于内存<br>记录内核与系统硬件的相关信息，包括目前已加载的内核模块与侦测到的硬件设备信息</td></tr></tbody></table></div><h5 id="usr-目录"><a href="#usr-目录" class="headerlink" title="/usr 目录"></a><em>/usr</em> 目录</h5><blockquote><p>Unix Software Resource，Unix软件资源所放置的目录</p></blockquote><p>FHS建议所有软件开发者将其数据放置于该目录的次级目录，不要创建独立的软件目录</p><p>因此，通常在安装时就会占用较大硬盘空间</p><h6 id="必需目录-1"><a href="#必需目录-1" class="headerlink" title="必需目录"></a>必需目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/usr/bin</em></td><td>放置所有用户能够使用的可执行文件（指令），<br>CentOS7将<em>/bin</em> 链接到该目录</td></tr><tr><td><em>/usr/lib</em></td><td>依赖库，<em>/lib</em>也链接到该目录</td></tr><tr><td><em>/usr/sbin</em></td><td>非系统正常运行所需的系统指令，<em>/sbin</em>连接到此目录</td></tr><tr><td><em>/usr/local</em></td><td>自行安装的第三方软件（非distributions默认提供）</td></tr><tr><td><em>/usr/share</em></td><td>放置只读的数据文件，文本文件为主<br>- <em>/usr/share/man</em>：联机帮助文件<br>- <em>/usr/share/doc</em>：软件的文件说明<br>- <em>/usr/share/zoneinfo</em>：时区相关的文件</td></tr></tbody></table></div><h6 id="建议目录-1"><a href="#建议目录-1" class="headerlink" title="建议目录"></a>建议目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/usr/src</em></td><td>源码的放置目录，内核源码放置于 <em>/usr/src/linux/</em>目录下</td></tr><tr><td><em>/usr/libexec</em></td><td>某些不被普通用户使用的可执行文件或脚本</td></tr><tr><td><em>/usr/include</em></td><td>头文件的放置目录</td></tr></tbody></table></div><h5 id="var目录"><a href="#var目录" class="headerlink" title="/var目录"></a><em>/var</em>目录</h5><p><em>/var</em>目录随系统运行逐渐占用硬盘容量，主要包含的文件为快取（cache）、登录文件（log file）以及某些软件运行产生的文件</p><blockquote><p>根据FHS定义，最好将 <em>/var</em> 独立出来</p></blockquote><h6 id="必需目录-2"><a href="#必需目录-2" class="headerlink" title="必需目录"></a>必需目录</h6><div class="table-container"><table><thead><tr><th>目录</th><th>目录内容</th></tr></thead><tbody><tr><td><em>/var/cache</em></td><td>应用程序运行过程产生的缓存文件</td></tr><tr><td><em>/var/lib</em></td><td>程序本身执行过程，需要使用到的数据文件放置目录</td></tr><tr><td><em>/var/lock</em></td><td>同一时刻只能有一个应用程序使用的设备或文件，需要上锁<br>目前已被移动到 <em>/run/lock</em>目录</td></tr><tr><td><em>/var/log</em></td><td>登录文件放置的目录，较为重要的文件为<br>- <em>/var/log/messages</em><br>- <em>/var/log/wtmp</em> （记录登入者信息）</td></tr><tr><td><em>/var/mail</em></td><td>电子邮件的目录，与<em>/var/spool/mail</em>互为链接文件</td></tr><tr><td><em>/var/spool</em></td><td>放置队列数据，使用后会被删除</td></tr><tr><td><em>/var/run</em></td><td>某些程序或服务启动后，会将其PID放置在该目录下<br>目前已链接到<em>/run</em>目录中</td></tr></tbody></table></div><h4 id="目录树"><a href="#目录树" class="headerlink" title="目录树"></a>目录树</h4><ul><li>所有文件与目录都由根目录开始</li><li>每个目录可挂载到本地或网络文件系统</li><li>每个文件在此目录树中的文件名唯一（完整的绝对路径）</li></ul><p>以ubuntu22.04的目录树为例，</p><p><img src="/posts/2763264027/ubuntu2204目录树.png" alt="ubuntu2204目录树"></p><blockquote><p>Windows的文件系统，每个硬盘驱动器都有自己的目录树</p></blockquote><h4 id="LSB规范"><a href="#LSB规范" class="headerlink" title="LSB规范"></a>LSB规范</h4><blockquote><p>Linux Standard Base标准，、LSB标准查看方式</p></blockquote><p><strong>LInux核心查看方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出内核全部信息</span></span><br><span class="line">root@tzj-virtual-machine:/# uname -a</span><br><span class="line">Linux tzj-virtual-machine 6.8.0-65-generic #68~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jul 15 18:06:34 UTC 2 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出内核版本</span></span><br><span class="line">root@tzj-virtual-machine:/# uname -r</span><br><span class="line">6.8.0-65-generic</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出内核平台</span></span><br><span class="line">root@tzj-virtual-machine:/# uname -m</span><br><span class="line">x86_64</span><br></pre></td></tr></table></figure><p><strong>LSB版本查看方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装lsb_release依赖</span></span><br><span class="line">apt install lsb-core</span><br><span class="line">yum install redhat-lsb</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看</span></span><br><span class="line">root@tzj-virtual-machine:/etc/apt# lsb_release -a</span><br><span class="line">LSB Version:	core-11.1.0ubuntu4-noarch:security-11.1.0ubuntu4-noarch</span><br><span class="line">Distributor ID:	Ubuntu</span><br><span class="line">Description:	Ubuntu 22.04.5 LTS</span><br><span class="line">Release:	22.04</span><br><span class="line">Codename:	jammy</span><br></pre></td></tr></table></figure><h3 id="对目录的操作"><a href="#对目录的操作" class="headerlink" title="对目录的操作"></a>对目录的操作</h3><p><code>cd</code>（change directory，切换目录）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd 目标路径</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:left">含义</th></tr></thead><tbody><tr><td style="text-align:center">cd 、cd ~</td><td style="text-align:left">切换当前用户的主目录</td></tr><tr><td style="text-align:center">cd .</td><td style="text-align:left">当前目录</td></tr><tr><td style="text-align:center">cd ..</td><td style="text-align:left">上层目录</td></tr><tr><td style="text-align:center">cd -</td><td style="text-align:left">在最近两次目录之间切换</td></tr></tbody></table></div><p><code>pwd</code>（print working direcory，显示当前所在目录）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwd -P</span><br><span class="line">对于链接文件，显示真实路径</span><br></pre></td></tr></table></figure><p><code>mkdir</code>（make directory，创建新目录）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -mp 目录名</span><br><span class="line">-m：配置目录权限</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若不指定，则使用默认设定的权限——<span class="built_in">umask</span></span></span><br><span class="line">mkdir -m 711 test2</span><br><span class="line"></span><br><span class="line">-p：递归建立目录</span><br><span class="line">mkdir -p test1/test2/test3/test4</span><br></pre></td></tr></table></figure><p><code>rmdir</code>（remove directory，删除目录）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rmdir -p 目录名</span><br><span class="line">递归删除目录</span><br></pre></td></tr></table></figure><p><code>tree</code> （以树状图列出文件目录结构）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree -d 只显示目录</span><br></pre></td></tr></table></figure><h3 id="对文件与目录的管理"><a href="#对文件与目录的管理" class="headerlink" title="对文件与目录的管理"></a>对文件与目录的管理</h3><ul><li><code>ls</code> ：查看文件或目录属性</li><li><code>cp</code> ：复制文件或目录</li><li><code>rm</code>：删除文件或目录</li><li><code>mv</code>：移动文件或目录</li><li><code>basename</code> / <code>dirname</code>获取文件名或目录名</li></ul><h4 id="输出信息ls"><a href="#输出信息ls" class="headerlink" title="输出信息ls"></a>输出信息ls</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls [-选项] [--参数] [文件名]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">windows</span> </span><br><span class="line">dir </span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>分类</th><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>显示特定文件</td><td></td><td></td><td></td></tr><tr><td></td><td>-a</td><td></td><td>全部文件，包括隐藏文件与 <em>.</em> 以及 <em>..</em></td></tr><tr><td></td><td>-A</td><td></td><td>全部文件，包括隐藏文件，不包括 <em>.</em> 与 <em>..</em></td></tr><tr><td></td><td>-d</td><td></td><td>仅列出目录</td></tr><tr><td>输出格式</td><td></td><td></td><td></td></tr><tr><td></td><td>-F</td><td></td><td>根据文件、目录等信息，在文件名后添加标识<br>- [文件名]*<br>- [目录名/]<br>- [socket文件名]=<br>- [FIFO文件名]\</td><td></td></tr><tr><td></td><td>-h</td><td></td><td>文件/目录容量表示为易读的方式（GB、KB等）</td></tr><tr><td></td><td>-l</td><td></td><td>逐行显示每个文件的信息</td></tr><tr><td></td><td>-R</td><td></td><td>列出子目录内容</td></tr><tr><td></td><td></td><td>—color=never</td><td>不依据文件类型显示不同颜色</td></tr><tr><td></td><td></td><td>—color=always</td><td>依据文件类型显示不同颜色</td></tr><tr><td></td><td></td><td>—color=auto</td><td>系统自行判断是否给予颜色</td></tr><tr><td></td><td></td><td>—full-time</td><td>以完整时间模式输出</td></tr><tr><td></td><td></td><td>—time=[atime,ctime]</td><td>输出文件最近被获取(atime)或改变属性（ctime）的时间</td></tr><tr><td>文件名排序</td><td></td><td></td><td></td></tr><tr><td></td><td>-f-</td><td></td><td>直接列出结果，不进行排序（默认以文件名排序）</td></tr><tr><td></td><td>-r</td><td></td><td>逆序输出文件列表</td></tr><tr><td></td><td>-S</td><td></td><td>以文件容量大小排序</td></tr><tr><td></td><td>-t</td><td></td><td>以时间顺序对文件排列</td></tr><tr><td>文件特殊属性</td><td>-i</td><td></td><td>列出文件的inode号</td></tr><tr><td></td><td>-n</td><td></td><td>列出UID与GID，而非字符名</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# ls</span><br><span class="line">snap</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# ls -al</span><br><span class="line">总计 44</span><br><span class="line">drwx------  5 root root 4096  8月  6 14:54 .</span><br><span class="line">drwxr-xr-x 20 root root 4096  8月  4 15:57 ..</span><br><span class="line">-rw-------  1 root root 2229  8月  6 00:51 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 10月 15  2021 .bashrc</span><br><span class="line">drwx------  2 root root 4096  8月  4 21:27 .cache</span><br><span class="line">-rw-------  1 root root   20  8月  6 00:11 .lesshst</span><br><span class="line">-rw-r--r--  1 root root  161  7月  9  2019 .profile</span><br><span class="line">drwx------  5 root root 4096  8月  4 16:04 snap</span><br><span class="line">drwxr-xr-x  2 root root 4096  8月  4 16:24 .vim</span><br><span class="line">-rw-------  1 root root 2513  8月  4 21:01 .viminfo</span><br><span class="line">-rw-------  1 root root   65  8月  6 14:54 .Xauthority</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# ls -alF</span><br><span class="line">总计 44</span><br><span class="line">drwx------  5 root root 4096  8月  6 14:54 ./</span><br><span class="line">drwxr-xr-x 20 root root 4096  8月  4 15:57 ../</span><br><span class="line">-rw-------  1 root root 2229  8月  6 00:51 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 10月 15  2021 .bashrc</span><br><span class="line">drwx------  2 root root 4096  8月  4 21:27 .cache/</span><br><span class="line">-rw-------  1 root root   20  8月  6 00:11 .lesshst</span><br><span class="line">-rw-r--r--  1 root root  161  7月  9  2019 .profile</span><br><span class="line">drwx------  5 root root 4096  8月  4 16:04 snap/</span><br><span class="line">drwxr-xr-x  2 root root 4096  8月  4 16:24 .vim/</span><br><span class="line">-rw-------  1 root root 2513  8月  4 21:01 .viminfo</span><br><span class="line">-rw-------  1 root root   65  8月  6 14:54 .Xauthority</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# ls -al --full-time</span><br><span class="line">总计 44</span><br><span class="line">drwx------  5 root root 4096 2025-08-06 14:54:30.804000106 +0800 .</span><br><span class="line">drwxr-xr-x 20 root root 4096 2025-08-04 15:57:22.783334996 +0800 ..</span><br><span class="line">-rw-------  1 root root 2229 2025-08-06 00:51:58.600146220 +0800 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 2021-10-15 18:06:05.000000000 +0800 .bashrc</span><br><span class="line">drwx------  2 root root 4096 2025-08-04 21:27:51.256886989 +0800 .cache</span><br><span class="line">-rw-------  1 root root   20 2025-08-06 00:11:48.507418817 +0800 .lesshst</span><br><span class="line">-rw-r--r--  1 root root  161 2019-07-09 18:05:50.000000000 +0800 .profile</span><br><span class="line">drwx------  5 root root 4096 2025-08-04 16:04:27.138000325 +0800 snap</span><br><span class="line">drwxr-xr-x  2 root root 4096 2025-08-04 16:24:03.115327213 +0800 .vim</span><br><span class="line">-rw-------  1 root root 2513 2025-08-04 21:01:31.093924724 +0800 .viminfo</span><br><span class="line">-rw-------  1 root root   65 2025-08-06 14:54:30.804000106 +0800 .Xauthority</span><br></pre></td></tr></table></figure><h4 id="复制cp"><a href="#复制cp" class="headerlink" title="复制cp"></a>复制cp</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp [-选项] [源文件1 源文件2 ...] 目标目录</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td></td><td>同 -dr —preserve=all</td></tr><tr><td>-d</td><td></td><td>若源文件为链接文件，复制链接文件的属性</td></tr><tr><td>-r</td><td></td><td>递归复制，用于复制目录</td></tr><tr><td>-f</td><td></td><td>强制复制，若目标文件已经存在且无法开启，则移除后复制</td></tr><tr><td>-i</td><td></td><td>若目标文件已存在，则覆盖前进行提示（information）</td></tr><tr><td>-p</td><td></td><td>连同文件属性复制（权限、用户、时间），不使用默认属性</td></tr><tr><td>-s</td><td></td><td>复制为符号链接文件（symbolic link）</td></tr><tr><td>-l</td><td></td><td>复制为硬链接文件（hard link）</td></tr><tr><td>-u</td><td></td><td>（update）目标路径比源文件旧，或目标路径不存在，才会更新目标路径<br>仅当目标文件与源文件存在差异，才会复制</td></tr><tr><td></td><td>—preserve=all</td><td>所有属性，包括SELinux属性，links，xattr也会复制</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">直接复制，用户名、文件创建时间等属性会被改变</span></span><br><span class="line">root@tzj-virtual-machine:~# cd /tmp/</span><br><span class="line">root@tzj-virtual-machine:/tmp# cp /var/log/wtmp .</span><br><span class="line">root@tzj-virtual-machine:/tmp# ls -l /var/log/wtmp wtmp </span><br><span class="line">-rw-rw-r-- 1 root utmp 12672  8月  6 14:54 /var/log/wtmp</span><br><span class="line">-rw-r--r-- 1 root root 12672  8月  6 16:01 wtmp</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">全量复制</span></span><br><span class="line">root@tzj-virtual-machine:/tmp# cp -a /var/log/wtmp wtmp1</span><br><span class="line">root@tzj-virtual-machine:/tmp# ls -l /var/log/wtmp wtmp1 </span><br><span class="line">-rw-rw-r-- 1 root utmp 12672  8月  6 14:54 /var/log/wtmp</span><br><span class="line">-rw-rw-r-- 1 root utmp 12672  8月  6 14:54 wtmp1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换用户，注意文件拥有者</span></span><br><span class="line">tzj@tzj-virtual-machine:/tmp$ cp -a /var/log/wtmp wtmp2</span><br><span class="line">tzj@tzj-virtual-machine:/tmp$ ls -l /var/log/wtmp wtmp2</span><br><span class="line">-rw-rw-r-- 1 root utmp 12672  8月  6 14:54 /var/log/wtmp</span><br><span class="line">-rw-rw-r-- 1 tzj  tzj  12672  8月  6 14:54 wtmp2</span><br></pre></td></tr></table></figure><ul><li>复制行为，目标文件的拥有者为指令操作者</li></ul><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">链接文件</span></span><br><span class="line">root@tzj-virtual-machine:~# ls -l .bashrc </span><br><span class="line">-rw-r--r-- 1 root root 3106 10月 15  2021 .bashrc</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# cp -s .bashrc .bashrc_slink</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# cp -l .bashrc .bashrc_hlink</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# ls -l .bashrc .bashrc_slink .bashrc_hlink</span><br><span class="line">-rw-r--r-- 2 root root 3106 10月 15  2021 .bashrc</span><br><span class="line">-rw-r--r-- 2 root root 3106 10月 15  2021 .bashrc_hlink</span><br><span class="line">lrwxrwxrwx 1 root root    7  8月  6 16:08 .bashrc_slink -&gt; .bashrc</span><br></pre></td></tr></table></figure><ul><li>软链接，仅是新建符号链接文件，指向源文件</li><li>硬链接，创建新的文件名，与源文件指向同一inode</li></ul><hr><p>复制软链接文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">对于软链接文件，默认会复制源文件</span></span><br><span class="line">root@tzj-virtual-machine:~# cp .bashrc_slink .bashrc_slink1</span><br><span class="line">root@tzj-virtual-machine:~# ls -l .bashrc .bashrc_slink .bashrc_slink1</span><br><span class="line">-rw-r--r-- 2 root root 3106 10月 15  2021 .bashrc</span><br><span class="line">lrwxrwxrwx 1 root root    7  8月  6 16:08 .bashrc_slink -&gt; .bashrc</span><br><span class="line">-rw-r--r-- 1 root root 3106  8月  6 16:42 .bashrc_slink1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若仅复制链接文件，则需要加-d选项</span></span><br><span class="line">root@tzj-virtual-machine:~# cp -d .bashrc_slink .bashrc_slink2</span><br><span class="line">root@tzj-virtual-machine:~# ls -l .bashrc .bashrc_slink .bashrc_slink2</span><br><span class="line">-rw-r--r-- 2 root root 3106 10月 15  2021 .bashrc</span><br><span class="line">lrwxrwxrwx 1 root root    7  8月  6 16:08 .bashrc_slink -&gt; .bashrc</span><br><span class="line">lrwxrwxrwx 1 root root    7  8月  6 16:43 .bashrc_slink2 -&gt; .bashrc</span><br></pre></td></tr></table></figure><h4 id="删除rm"><a href="#删除rm" class="headerlink" title="删除rm"></a>删除rm</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm [-选项] 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td></td><td>强制移除，不询问</td></tr><tr><td>-i</td><td></td><td>删除前询问</td></tr><tr><td>-r</td><td></td><td>递归删除</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若文件名以-开头，<span class="built_in">rm</span>会将其识别为关键字，因此需要在其前加本目录</span></span><br><span class="line">root@tzj-virtual-machine:~# touch ./-aaa</span><br><span class="line">root@tzj-virtual-machine:~# ls -l</span><br><span class="line">总计 4</span><br><span class="line">-rw-r--r-- 1 root root    0  8月  6 16:48 -aaa</span><br><span class="line">drwx------ 5 root root 4096  8月  4 16:04 snap</span><br><span class="line">root@tzj-virtual-machine:~# rm -aaa</span><br><span class="line">rm: 无效的选项 -- a</span><br><span class="line">尝试使用 &quot;rm ./-aaa&quot; 删除文件 &#x27;-aaa&#x27;。</span><br><span class="line">请尝试执行 &quot;rm --help&quot; 来获取更多信息。</span><br><span class="line">root@tzj-virtual-machine:~# rm ./-aaa</span><br></pre></td></tr></table></figure><h4 id="移动或更名mv"><a href="#移动或更名mv" class="headerlink" title="移动或更名mv"></a>移动或更名mv</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更名</span></span><br><span class="line">mv [-选项] source destination</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># rename可以同时对多个文件更名</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">移动</span></span><br><span class="line">mv [-选项] source1 source2 source3 ... 目录</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td></td><td>强制移动</td></tr><tr><td>-i</td><td></td><td>移动前询问</td></tr><tr><td>-u</td><td></td><td>若目标文件已存在，且源文件更新才覆盖（update）</td></tr><tr><td>-v</td><td></td><td>显示移动进度</td></tr></tbody></table></div><h4 id="文件-目录搜索"><a href="#文件-目录搜索" class="headerlink" title="文件/目录搜索"></a>文件/目录搜索</h4><h5 id="whereis"><a href="#whereis" class="headerlink" title="whereis"></a>whereis</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis [-选项] 文件/目录名</span><br></pre></td></tr></table></figure><blockquote><p>局限性在于仅搜索特定的目录，速度虽然快，但一些文件可能找不到</p></blockquote><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-l</td><td></td><td>列出whereis主要查询的目录</td></tr><tr><td>-b</td><td></td><td>只找二进制文件</td></tr><tr><td>-m</td><td></td><td>值找在manual路径下的文件</td></tr><tr><td>-s</td><td></td><td>只找source文件</td></tr><tr><td>-u</td><td></td><td>搜索不在上述三个路径的其他特殊文件</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">范例一：请找出 ifconfig 这个档名</span><br><span class="line">[root@study ~]# whereis ifconfig</span><br><span class="line">ifconfig: /sbin/ifconfig /usr/share/man/man8/ifconfig.8.gz</span><br><span class="line"></span><br><span class="line">范例二：只找出跟 passwd 有关的『说明文件』档名(man page)</span><br><span class="line">[root@study ~]# whereis passwd # 全部的档名通通列出来！</span><br><span class="line">passwd: /usr/bin/passwd /etc/passwd /usr/share/man/man1/passwd.1.gz</span><br><span class="line">/usr/share/man/man5/passwd.5.gz</span><br><span class="line">[root@study ~]# whereis -m passwd # 只有在 man 里面的档名才抓出来！</span><br><span class="line">passwd: /usr/share/man/man1/passwd.1.gz /usr/share/man/man5/passwd.5.gz</span><br></pre></td></tr></table></figure><h5 id="locate-updatedb"><a href="#locate-updatedb" class="headerlink" title="locate/updatedb"></a>locate/updatedb</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locate -ir 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-i</td><td></td><td>忽略大小写</td></tr><tr><td>-c</td><td></td><td>仅计算找到的文件数量</td></tr><tr><td>-l n</td><td></td><td>仅输出前n个文件</td></tr><tr><td>-S</td><td></td><td>输出locate使用的数据库文件信息，包括该数据库记录的文件/目录数</td></tr><tr><td>-r</td><td></td><td>正则查询</td></tr></tbody></table></div><blockquote><p>局限性：locate在/var/lib/mlocate/数据库中搜索，因此，只有特定时间才会自动更新数据库信息，所以最近创建的文件并不会被收录</p><ul><li><p>updatedb：手动更新locate数据库</p><p>updatedb读取 <em>/etc/updatedb.conf</em> 配置文件的设定，再去硬盘进行文件搜索指令。</p></li></ul></blockquote><h5 id="find"><a href="#find" class="headerlink" title="find"></a>find</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find 路径 [-选项] 参数</span><br></pre></td></tr></table></figure><blockquote><p>find指令会搜索次目录</p><p>find支持通配符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找包含httpd的文件名</span></span><br><span class="line">find /etc -name &#x27;*httpd*&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找所有以大写字母为首字母的文件</span></span><br><span class="line">find ./ -name &quot;[A-Z]*&quot; </span><br></pre></td></tr></table></figure></blockquote><p><strong>依时间搜索</strong>：-mtime、-ctime、-atime</p><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-mtime</td><td>n</td><td>在[n+1,n]天范围内改动过的文件</td></tr><tr><td>-mtime</td><td>+n</td><td>在(,n+1)天范围内，改动过的文件</td></tr><tr><td>-mtime</td><td>-n</td><td>在[n,0]天范围内，改动的文件</td></tr><tr><td>-newer</td><td>file</td><td>file作为已存在的文件，列出必file还要新的文件</td></tr></tbody></table></div><p><img src="/posts/2763264027/image-20250806225628149.png" alt="image-20250806225628149"></p><p><strong>依用户或群组搜索</strong></p><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-uid</td><td>n</td><td>用户UID，表示搜索属于用户UID的文件</td></tr><tr><td>-gid</td><td>n</td><td>群组GID，表示搜索属于群组GID的文件</td></tr><tr><td>-user</td><td>name</td><td>用户名，搜索用户名为name的文件</td></tr><tr><td>-group</td><td>name</td><td></td></tr><tr><td>-nouser</td><td></td><td>搜索文件拥有者不存在于 <em>/etc/passwd</em> 的文件</td></tr><tr><td>-nogroup</td><td></td><td>搜索文件的拥有群组不存在于 <em>/etc/group</em> 的文件</td></tr></tbody></table></div><p><strong>依权限搜索</strong></p><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-name</td><td>filename</td><td>搜索文件名为filename的文件</td></tr><tr><td>-size</td><td>[+/-]s[x]</td><td>搜索文件容量比s还大(+)或小(-)的文件<br>x表示容量单位：<br>- c：字节<br>- k：KB</td></tr><tr><td>-type</td><td>t</td><td>文件类型为t的文件<br>- f：一般文件<br>- b/c：块设备/字符设备文件<br>- d：目录<br>- l：链接文件<br>- s：socket文件<br>- p：FIFO文件</td></tr><tr><td>-perm</td><td>mode</td><td>文件权限恰好为mode的文件</td></tr><tr><td>-perm</td><td>-mode</td><td>文件权限包括所有mode的文件</td></tr><tr><td>-perm</td><td>/mode</td><td>文件权限包含任一mode的文件</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">搜寻 -rwxr--r-- ，亦即 0744 的文件，使用 -perm -0744，</span><br><span class="line">当一个文件的权限为 -rwsr-xr-x ，亦即 4755 时，也会被列出来，</span><br><span class="line"></span><br><span class="line">搜寻 -rwxr-xr-x ，亦即 -perm /755 时，但一个文件属性为 -rw-------</span><br><span class="line">也会被列出来</span><br><span class="line"></span><br><span class="line">如：想要找出来/usr/bin, /usr/sbin 这两个目录下，只要具有 SUID 或SGID 就列出来该文件</span><br><span class="line">[root@study ~]# find /usr/bin /usr/sbin -perm /6000</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td></td><td>-exec command</td><td>利用其他指令，对搜索结果进行处理</td></tr><tr><td></td><td>-print</td><td>将结果打印到屏幕上</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /usr/bin /usr/sbin -perm /7000 -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure><ul><li><code>&#123;&#125;</code> 表示 <code>find /usr/bin /usr/sbin -perm /7000</code> 的搜索结果</li><li><code>;</code> 表示-exec的结束关键字</li><li>因为 <code>;</code> 为指令顺序执行关键字，所以需要转义字符 <code>\;</code></li></ul><h2 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h2><p>一组可被挂载到操作系统的数据称为 <strong>文件系统</strong></p><ul><li>传统文件系统，一个分区仅能被格式化为一个文件系统</li><li>目前，可将一个分区格式化为多个文件系统（LVM），也可将多个分区合并为一个文件系统（LVM，RAID）</li></ul><p><strong>所有Unix/Linux的数据都是由文件系统按照树型目录结构管理的</strong></p><ul><li><p>数据内容会占据一定量的扇区，通过一个文件名指针指向这组扇区，这些数据扇区与文件名被组织为一个文件</p><p>硬链接文件相当于为该数据区新增一个文件名指针</p></li><li><p>目录文件记录这些文件的层次结构</p></li></ul><p><strong>文件系统可以挂载到目录树的某个挂载点，以该目录作为文件系统的访问入口</strong></p><h3 id="文件系统概念"><a href="#文件系统概念" class="headerlink" title="文件系统概念"></a>文件系统概念</h3><h4 id="硬件支持"><a href="#硬件支持" class="headerlink" title="硬件支持"></a>硬件支持</h4><p><strong>磁盘</strong></p><ul><li>盘片——数据记录载体</li><li>磁盘读取头通过机械臂的移动擦写磁盘上的数据</li><li>主轴马达——驱动盘片转动</li></ul><p><strong>磁盘分区</strong></p><ul><li>扇区（sector）是最小的物理存储单元——512B与4KB两种</li><li>同一圆环上的扇区组成柱面（cylinder）</li><li>早期磁盘以柱面为单位分区（一个分区包含多个柱面），目前以扇区为单位分区（一个分区多个扇区）</li><li>磁盘分区表：早期MBR（限制多），目前GPT<ul><li>MBR分区，第一个扇区（512B），前446B包含开机扇区（Master Boot record），后64B为分区表，最多4个主分区，更多的分区需要引入延伸分区，最大磁盘容量为2TB</li><li>GPT分区，支持的磁盘容量超2TB</li></ul></li></ul><p><strong>磁盘文件名</strong></p><ul><li>物理磁盘设备的文件名 <em>/dev/sd[a-p]</em></li><li>虚拟机磁盘的文件名 <em>/dev/vd[a-p]</em></li><li>磁盘阵列的文件名 <em>/dev/md[0-128]</em></li></ul><p><strong>格式化</strong>——操作系统对分区中的数据格式进行约定</p><p>每种操作系统设定的文件属性/权限不尽相同，所以需要对分区进行格式化，成为操作系统支持的文件系统</p><ul><li>Win98前，主要的文件系统是FAT（FAT16）</li><li>Win2000后，NTFS</li><li>Linux为EXT家族及XFS</li></ul><h4 id="文件系统的三种关键数据"><a href="#文件系统的三种关键数据" class="headerlink" title="文件系统的三种关键数据"></a>文件系统的三种关键数据</h4><p>文件系统中的所有数据记录在不同类型的数据块中，这些数据块本质上都是磁盘的扇区</p><ul><li>超块（super block）：记录文件系统元数据（inode/block总量、使用量、剩余量）</li><li>inode：文件元数据（文件权限与属性，数据块号）<ul><li>一个文件占用一个inode</li></ul></li><li>data block：实际记录文件的内容</li></ul><p>每个inode与block都有编号</p><blockquote><p>分类：</p><ul><li><p>索引式文件系统：inode中记录该文件所有的block编号</p><p><img src="/posts/2763264027/image-20250809184940788.png" alt="image-20250809184940788"></p><ul><li>EX2、EX3</li></ul></li><li><p>链式文件系统：每个block的编号记录在上一个block中</p><p><img src="/posts/2763264027/image-20250809184945687.png" alt="image-20250809184945687"></p><ul><li>FAT</li><li>碎片整理：将同一个文件所属的blocks整合在较近的扇区，便于数据的读写</li></ul></li></ul></blockquote><h3 id="文件系统的组成"><a href="#文件系统的组成" class="headerlink" title="文件系统的组成"></a>文件系统的组成</h3><h4 id="EXT2文件系统的组成"><a href="#EXT2文件系统的组成" class="headerlink" title="EXT2文件系统的组成"></a>EXT2文件系统的组成</h4><p>EXT2文件系统的inode与block在格式化完成后，就固定不再变动</p><p>EXT2文件系统在格式化时，将整个磁盘分为多个扇区组（block group），每个扇区组都有独立的 inode/block/superblock 系统</p><ul><li>每个文件系统前部都有一个启动扇区（boot sector），可以安装开机管理程序</li></ul><p><img src="/posts/2763264027/image-20250810192928754.png" alt="image-20250810192928754"></p><h5 id="数据块"><a href="#数据块" class="headerlink" title="数据块"></a>数据块</h5><p>用于放置文件内容，EXT2系统支持的block大小有1KB、2KB及4KB</p><ul><li><p>块大小与块数量，在文件系统格式化后无法改变</p><p>若block较小，一个大型文件会占用更多的block，inode也需要记录更多的block号，导致文件系统读写性能不佳</p></li><li><p>每个block都有编号</p></li><li><p>每个block最多放一个文件的数据，剩余容量不可被其他文件使用</p></li></ul><h5 id="inode表"><a href="#inode表" class="headerlink" title="inode表"></a>inode表</h5><p>inode记录的信息，至少包括</p><ul><li>文件的存取权限（read、write、execute）</li><li>文件特殊权限标志（SUID等）</li><li>文件的拥有者与群组（owner/group）</li><li>文件的容量</li><li>文件的访问、内容与状态修改时间（atime、mtime、ctime）</li><li>文件的block号（指针）</li></ul><p>inode特点</p><ul><li>inode的大小与数量在格式化时被固定</li><li>每个文件仅占用一个inode</li><li>每个inode大小固定为128B，EXT4与XFS可设置为256B<ul><li>文件系统能建立的文件数与inode数有关</li></ul></li></ul><h6 id="inode编号相关"><a href="#inode编号相关" class="headerlink" title="inode编号相关"></a>inode编号相关</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# ls -lid / /boot /home</span><br><span class="line">128 dr-xr-xr-x. 19 root root  269  8月 25 15:25 /</span><br><span class="line">128 dr-xr-xr-x.  7 root root 4096  8月 21 17:03 /boot</span><br><span class="line">138 drwxr-xr-x   2 root root    6  4月  3  2021 /home</span><br><span class="line"></span><br><span class="line">[root@node1 ~]# df -h</span><br><span class="line">...</span><br><span class="line">/dev/mapper/klas-root  422G   12G  410G    3% /</span><br><span class="line">tmpfs                   63G   32M   63G    1% /tmp</span><br><span class="line">/dev/sda2             1014M  164M  851M   17% /boot</span><br><span class="line">...</span><br></pre></td></tr></table></figure><ul><li>XFS文件系统最顶层目录的indoe为128</li><li>每个文件系统都有独立的inode编号空间。可见， <em>/</em> 与 <em>/boot</em> 是不同的文件系统</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# ls -ild / /. /..</span><br><span class="line">128 dr-xr-xr-x. 19 root root 269  8月 25 15:25 /</span><br><span class="line">128 dr-xr-xr-x. 19 root root 269  8月 25 15:25 /.</span><br><span class="line">128 dr-xr-xr-x. 19 root root 269  8月 25 15:25 /..</span><br></pre></td></tr></table></figure><ul><li>对于同一个文件系统，一个inode只会对应到一个文件内容，所以可以通过inode号判断是否为同一个文件</li></ul><h6 id="inode数的计算"><a href="#inode数的计算" class="headerlink" title="inode数的计算"></a>inode数的计算</h6><script type="math/tex;mode=display">\frac{\text{inode table占用块数}\times 块大小}{每个inode占用字节数}</script><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# dumpe2fs /dev/vda5</span><br><span class="line">....(中间省略)....</span><br><span class="line">Block size: 4096 # 单个 block 的容量大小</span><br><span class="line">....(中间省略)....</span><br><span class="line">Inode size: 256 # inode 的容量大小！已经是 256 了喔！</span><br><span class="line">....(中间省略)....</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 超块在0组的第0号block</span></span></span><br><span class="line">Group 0: (Blocks 0-32767) # 第一块 block group 位置</span><br><span class="line">Checksum 0x13be, unused inodes 8181</span><br><span class="line">Primary superblock at 0, Group descriptors at 1-1 # 主要 superblock 的所在喔！</span><br><span class="line">Reserved GDT blocks at 2-128</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># bitmap占第2~128号block</span></span></span><br><span class="line">Block bitmap at 129 (+129), Inode bitmap at 145 (+145)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># inode table占第161~672号block</span></span></span><br><span class="line">Inode table at 161-672 (+161) # inode table 的所在喔！</span><br><span class="line">....(中间省略)....</span><br></pre></td></tr></table></figure><ul><li>即共 $(672-161+1)$ 个block，bitmap $(672-161+1)*4KB/256B=8192$ 个inode</li></ul><h6 id="inode-block与文件大小的关系"><a href="#inode-block与文件大小的关系" class="headerlink" title="inode/block与文件大小的关系"></a>inode/block与文件大小的关系</h6><p>不同块大小的文件系统支持，所支持的最大单一文件容量与磁盘容量不同</p><div class="table-container"><table><thead><tr><th>块大小</th><th>1KB</th><th>2KB</th><th>4KB</th></tr></thead><tbody><tr><td>最大单一文件限制</td><td>16GB</td><td>256GB</td><td>2TB</td></tr><tr><td>最大文件系统容量限制</td><td>2TB</td><td>8TB</td><td>16TB</td></tr></tbody></table></div><p>某些应用程序只能捕捉小于2GB的文件，与文件系统无关</p><p><img src="/posts/2763264027/image-20250903112013144.png" alt="image-20250903112013144"></p><p><strong>inode记录block号需4B</strong></p><p>inode记录block号的区域为：12个直接地址、1个间接地址、一个二间接地址、一个三间接地址。每个间接地址用一个block记录block号</p><p>block大小为1KB：</p><ul><li>12个直接地址记录的大小为12KB</li><li>1个间接地址记录的block数为 $\frac{1KB}{4B}=256$ 个，文件大小为256KB</li><li>2个间接地址记录的block数为 $256*256=2^{16}$个，文件大小为 $2^{26}B=64MB$</li><li>3个间接地址记录的block数为 $256<em>256</em>256=2^{24}$ 个，文件大小为 $2^{34}B=16GB$</li></ul><p>因此，块大小为1KB时，一个文件最大容量为 $12KB+256KB+64MB+16GB\approx 16GB$</p><p>块大小为2KB时，一个block最多容纳约为 $\frac{2KB}{4B}=512$ 个block地址，文件最大容量约为 $512^3*2KB=2^{38}B=256GB$</p><p>块大小为4KB时，一个block最多容纳约为 $\frac{4KB}{4B}=1024$ 个block地址，文件最大容量约为 $1024^3*2KB=2^{41}B=2TB$</p><h5 id="inode-bitmap（inode对照表）"><a href="#inode-bitmap（inode对照表）" class="headerlink" title="inode bitmap（inode对照表）"></a>inode bitmap（inode对照表）</h5><p>标记每个inode的使用情况</p><h5 id="block-bitmap（区块对照表）"><a href="#block-bitmap（区块对照表）" class="headerlink" title="block bitmap（区块对照表）"></a>block bitmap（区块对照表）</h5><p>标记每个block的使用情况</p><h5 id="filesystem-description（文件系统描述说明）"><a href="#filesystem-description（文件系统描述说明）" class="headerlink" title="filesystem description（文件系统描述说明）"></a>filesystem description（文件系统描述说明）</h5><blockquote><p><code>dumpe2fs</code> 会输出这部分信息</p></blockquote><ul><li>每个block group的开始与结束block号</li><li>每个区段（superblock、bitmap、inodemap、data block）分别位于哪个block间</li></ul><h5 id="superblock（超块）"><a href="#superblock（超块）" class="headerlink" title="superblock（超块）"></a>superblock（超块）</h5><p>superblock会位于第一个block group，其他block group中的超块均为其备份</p><ul><li>超块一般记录在每个block group的第一个block</li></ul><p>记录的信息</p><ul><li>block与inode的总数</li><li>未使用与已使用的inode/block数量</li><li>block与inode的大小</li><li>文件系统相关信息：挂载时间、最近一次写入数据的时间、最近一次检验磁盘（fsck）的时间</li><li>valid bit（可用标志），挂载为0，可被挂载为1</li></ul><h4 id="XFS文件系统组成"><a href="#XFS文件系统组成" class="headerlink" title="XFS文件系统组成"></a>XFS文件系统组成</h4><p><strong>EXT弊端</strong></p><ul><li><p>EXT文件系统对文件系统格式化：预先规划出所有的inode、block、元数据，不会动态调整</p></li><li><p>随着磁盘容量增大，格式化效率很低</p></li><li><p>虚拟化的应用越来越广泛，通常使用巨型文件作为虚拟化磁盘的来源</p></li></ul><p>XFS是性能更好的，更适合高容量磁盘与巨型文件的文件系统</p><h5 id="数据区（data-section）"><a href="#数据区（data-section）" class="headerlink" title="数据区（data section）"></a>数据区（data section）</h5><p>数据区包含 inode、data block、superblock</p><p>与EXT家族与block group类似，分为多个存储区群组（allocation groups，AG）放置数据</p><p>每个存储组包含：</p><ul><li>整个文件系统的super block</li><li>剩余空间的管理机制</li><li>inode的分配机制</li></ul><p>inode与block只有在系统需要用到时，才会动态配置产生，所以格式化操作很快</p><p>XFS的block与inode可设置多种容量</p><ul><li><p>block容量从 512B~64KB，但由于内容控制（页面文件pagesize的容量），block最高支持4KB</p></li><li><p>inode容量可由256B到2MB</p></li></ul><h5 id="文件系统活动日志区（log-section）"><a href="#文件系统活动日志区（log-section）" class="headerlink" title="文件系统活动日志区（log section）"></a>文件系统活动日志区（log section）</h5><p>日志区用于记录文件系统的更新，直至更新完整地写入数据区，相应的记录才会停止</p><p>日志区是磁盘区块活动相当频繁的，可以指定外部磁盘作为XFS文件系统的日志区</p><h5 id="实时运行区（realtime-section）"><a href="#实时运行区（realtime-section）" class="headerlink" title="实时运行区（realtime section）"></a>实时运行区（realtime section）</h5><p>文件系统要被建立时，XFS会在该区找若干个extent区</p><p>先将文件放置在该extent区块中，分配完毕后，再将这些数据写入到 数据区（data section）的 inode 与 block 中。</p><p>extent 区块的大小在文件系统格式化时就被指定，4KB~1GB</p><ul><li>非磁盘阵列，设为64KB</li><li>磁盘阵列，extent区块设为与RAID的stripe大小一致</li></ul><h4 id="其他Linux支持的系统与VFS"><a href="#其他Linux支持的系统与VFS" class="headerlink" title="其他Linux支持的系统与VFS"></a>其他Linux支持的系统与VFS</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看Linux支持的文件系统</span></span><br><span class="line">ls -l /lib/modules/$(uname -r)/kernel/fs</span><br></pre></td></tr></table></figure><ul><li>传统文件系统：ext2 、minix、MS-DOS、FAT、iso</li><li>日志式文件系统：EXT3、EXT4、ReiserFS、Windows NTFS、ZFS、IBM JFS、SGI XFS</li><li>网络文件系统：NFS、SMBFS</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">系统目前已加载到内存中支持的文件系统</span></span><br><span class="line">cat /proc/filesystems</span><br></pre></td></tr></table></figure><h5 id="VFS"><a href="#VFS" class="headerlink" title="VFS"></a>VFS</h5><p>Linux通过VFS（Virtual Filesystem Switch）对系统支持的文件系统进行管理</p><p><img src="/posts/2763264027/image-20250903171310971.png" alt="image-20250903171310971"></p><p>Linux并不需要知道每个分区上的文件系统时什么，VFS作为文件系统抽象层，封装了每种文件系统的存取操作</p><h4 id="查看文件系统"><a href="#查看文件系统" class="headerlink" title="查看文件系统"></a>查看文件系统</h4><h5 id="EXT文件系统"><a href="#EXT文件系统" class="headerlink" title="EXT文件系统"></a>EXT文件系统</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">读取EXT家族的文件系统信息</span></span><br><span class="line">dumpe2fs [-bfghimxV] [-o superblock=&lt;超级块编号&gt;] [-o blocksize=&lt;块大小&gt;] 设备</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-d</td><td></td><td>仅列出磁盘本身，不列出磁盘的分区数据</td></tr><tr><td>-f</td><td></td><td>列出磁盘内的文件系统名称</td></tr><tr><td>-i</td><td></td><td>以ASCII输出，不适用复杂编码</td></tr><tr><td>-m</td><td></td><td>输出设备在 <em>/dev</em> 底下的权限数据（rwx）</td></tr><tr><td>-p</td><td></td><td>列出该装置的完整文件名</td></tr><tr><td>-t</td><td></td><td>列出磁盘的详细数据</td></tr><tr><td>-h</td><td></td><td>仅列出超块的数据，不列出其他属性信息</td></tr></tbody></table></div><h5 id="XFS文件系统"><a href="#XFS文件系统" class="headerlink" title="XFS文件系统"></a>XFS文件系统</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_info 挂载点|设备文件名</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取指定类型的文件系统</span></span><br><span class="line">[root@node1 ~]# df -t xfs</span><br><span class="line">文件系统                  1K-块     已用      可用 已用% 挂载点</span><br><span class="line">/dev/mapper/klas-root 441603404 11910412 429692992    3% /</span><br><span class="line">/dev/sda2               1038336   166936    871400   17% /boot</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看xfs文件系统的信息</span></span><br><span class="line">[root@node1 ~]# xfs_info /</span><br><span class="line">meta-data=/dev/mapper/klas-root  isize=512    agcount=4, agsize=27613696 blks</span><br><span class="line">         =                       sectsz=512   attr=2, projid32bit=1</span><br><span class="line">         =                       crc=1        finobt=1, sparse=1, rmapbt=0</span><br><span class="line">         =                       reflink=1</span><br><span class="line">data     =                       bsize=4096   blocks=110454784, imaxpct=25</span><br><span class="line">         =                       sunit=0      swidth=0 blks</span><br><span class="line">naming   =version 2              bsize=4096   ascii-ci=0, ftype=1</span><br><span class="line">log      =internal log           bsize=4096   blocks=53933, version=2</span><br><span class="line">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none                   extsz=4096   blocks=0, rtextents=0</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>isize：inode的容量，每个512B</p><p>agcount为 AG 的数量，共4个</p><p>agsize 为每个AG中包含的 block 数</p><p>sectsz为逻辑扇区（sector）的容量为512B</p></li><li><p>bsize：block容量，每个block为4KB，blocks为区块数</p></li><li><p>sunit与swidth，与RAID的条带相关</p></li><li><p>internal log指日志区位于文件系统内。并未使用外部存储</p><p>bsize与blocks与上述含义一致</p></li><li><p>realtime 为 realtime区，每个扩展区容量为4KB</p></li></ul><h3 id="文件读写与性能"><a href="#文件读写与性能" class="headerlink" title="文件读写与性能"></a>文件读写与性能</h3><h4 id="目录文件与目录树"><a href="#目录文件与目录树" class="headerlink" title="目录文件与目录树"></a>目录文件与目录树</h4><p>在Linux下的文件系统建立目录时，文件系统会为该目录分配至少一个inode与一块block</p><ul><li><p>inode记录元数据</p></li><li><p>block内的数据：当前目录下的文件名及其对应的inode编号</p><p><img src="/posts/2763264027/image-20250902184129938.png" alt="image-20250902184129938"></p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ls -i [路径]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看路径下文件的inode号</span></span><br><span class="line">total 8</span><br><span class="line">53735697 -rw-------. 1 root root 1816 May 4 17:57 anaconda-ks.cfg</span><br><span class="line">53745858 -rw-r--r--. 1 root root 1864 May 4 18:01 initial-setup-ks.cfg</span><br></pre></td></tr></table></figure><ul><li><p>文件：文件系统会为每个文件分配一个inode与相对于该文件大小的block数</p><p>先计算改文件的block数，再确定inode结构</p></li></ul><h4 id="文件的读取流程"><a href="#文件的读取流程" class="headerlink" title="文件的读取流程"></a>文件的读取流程</h4><ul><li>通过目录inode中指示的block号，找到文件的inode号，进而定位目标block</li></ul><p>目录树都是从根目录开始，系统通过挂载的信息可以找到挂载点的inode号，进而得到根目录inode内容，依据该inode读取根目录block内的文件名数据，再依次逐层读取正确的文件名</p><ol><li><p>根目录 <em>/</em> 的inode：</p><p>通过挂载点信息，找到根目录的inode号，验证inode中的读写权限后，才能从指定的block中读取内容</p></li><li><p>根目录 <em>/</em> 的block：</p><p>从block保存的 <strong>[文件名,inode号]</strong> ，找到二级目录的inode号</p></li><li><p>二级目录的 inode：</p><p>读取二级目录inode中保存的信息，验证用户对该目录具有 r 和 x 权限，因此可以获取二级目录 block 的内容</p></li><li><p>二级目录的block：</p><p>获取二级目录内文件的inode号</p></li><li><p>文件的inode：</p><p>获取文件inode的信息，确定用户对该文件的权限，获取block号</p></li><li><p>文件的block：</p><p>将该block的内容返回或更新内容</p></li></ol><h4 id="EXT文件系统的写入"><a href="#EXT文件系统的写入" class="headerlink" title="EXT文件系统的写入"></a>EXT文件系统的写入</h4><ol><li>确定用户对于新增文件所在的目录是否具有 w 和 x权限，若有才能新增</li><li>根据 inode bitmap，获得一个可用的inode号，并向inode写入新文件元数据</li><li>根据 block bitmap，获得一个可用的block号，并将数据写入block中，更新 inode 的block指向数据</li><li>将刚写入的 inode 和 block 数据同步更新 inode bitmap 与 block bitmap ，并更新 super block 内容</li></ol><h5 id="数据不一致状态"><a href="#数据不一致状态" class="headerlink" title="数据不一致状态"></a>数据不一致状态</h5><p>文件写入时，需要修改的元数据仅涉及 inode table 与 block table</p><p>若元数据未同步完成，则会发生元数据内容与实际数据存放区不一致的现象</p><p>系统在重新启动时，会通过超块中记录的 valid bit（是否有挂载）与 filesystem state（是否clean）等标志位，判断是否强制进行一致性检查</p><ul><li>使用 <code>e2fsck</code> 进行检查：会对比元数据区域与实际的数据存放区，耗时长，后续使用日志式文件系统</li></ul><h5 id="日志式文件系统"><a href="#日志式文件系统" class="headerlink" title="日志式文件系统"></a>日志式文件系统</h5><p>日志：文件系统中规划处一个区块，专门记录写入或修改文件的操作过程</p><p>日志式文件系统的基本写入过程：</p><ol><li>预备：当系统要写入文件时，会先在日志记录区块中记录某个文件准备写入的数据</li><li>实际写入：写入文件的权限，写入数据，写入元数据</li><li>结束：完成数据与元数据的更新后，在日志记录区中完成该文件的记录</li></ol><p>在整个数据记录过程中发生故障，仅需要检查日志记录区块，不必针对整个文件系统检查</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Journal inode: 8</span><br><span class="line">Journal backup: inode blocks</span><br><span class="line">Journal features: (none)</span><br><span class="line">Journal size: 32M</span><br><span class="line">Journal length: 8192</span><br><span class="line">Journal sequence: 0x00000001</span><br></pre></td></tr></table></figure><ul><li>可见，日志文件元数据记录在inode 8中，实际的日志数据保存在inode记录的block中</li></ul><h4 id="文件系统的读写性能"><a href="#文件系统的读写性能" class="headerlink" title="文件系统的读写性能"></a>文件系统的读写性能</h4><h5 id="Linux文件系统的异步写入"><a href="#Linux文件系统的异步写入" class="headerlink" title="Linux文件系统的异步写入"></a>Linux文件系统的异步写入</h5><p>系统会将常用的文件数据写入内存，加速文件的读写</p><ul><li>当系统将一个文件加载到内存区段，若该文件并未被改动，则内存中的文件数据会被设为clean</li><li>当内存中的文件被改动后，则该数据会被设为 Dirty，所有数据保存在内存中，并不会立即写入硬盘，后续系统将择机将内存中的dirty数据写回硬盘</li></ul><p>但物理内存空间有限，可以使用 <code>sync</code> 指令，将内存中被设为 Dirty 的数据强制下刷到硬盘</p><p>正常关机时，关机指令会主动调用 <code>sync</code> 指令</p><p>不正常关机，重启时会花费较长时间进行磁盘检验，若无法恢复则造成文件系统损毁</p><h5 id="文件系统大小与性能"><a href="#文件系统大小与性能" class="headerlink" title="文件系统大小与性能"></a>文件系统大小与性能</h5><p>文件数据离散问题：数据被填入式地放入未被使用的block中</p><p>磁盘读写头要在整个文件系统中频繁读取，若文件数据过于离散，会导致读写性能很低</p><ul><li>可以将整个文件系统内的数据全部复制，然后重新格式化，再将数据复制回去</li></ul><h4 id="EXT2文件系统的空间浪费"><a href="#EXT2文件系统的空间浪费" class="headerlink" title="EXT2文件系统的空间浪费"></a>EXT2文件系统的空间浪费</h4><p>由于一个block中仅可存放一个文件的内容，即使是一个小文件，也会占用一个Block</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# ll -sh</span><br><span class="line">total 72K</span><br><span class="line">4.0K drwx------  7 root root 4.0K  9月 12 10:04 ./</span><br><span class="line">4.0K drwxr-xr-x 20 root root 4.0K  7月 30 19:05 ../</span><br><span class="line">8.0K -rw-------  1 root root 7.1K  9月 12 09:46 .bash_history</span><br><span class="line">4.0K -rw-r--r--  1 root root 3.1K 10月 15  2021 .bashrc</span><br><span class="line">4.0K drwx------  2 root root 4.0K  8月  1 13:05 .cache/</span><br><span class="line">4.0K -rw-r--r--  2 root root 1.2K  3月 23  2022 crontab</span><br><span class="line">4.0K -rw-------  1 root root   20  9月 12 09:33 .lesshst</span><br><span class="line">4.0K drwxr-xr-x  3 root root 4.0K  7月 30 12:12 .local/</span><br><span class="line">4.0K -rw-r--r--  1 root root  161  7月  9  2019 .profile</span><br><span class="line">4.0K drwx------  5 root root 4.0K  7月 30 19:25 snap/</span><br><span class="line">4.0K drwxr-xr-x  3 root root 4.0K  9月 11 10:45 test/</span><br><span class="line">4.0K drwxr-xr-x  2 root root 4.0K  9月  9 16:53 .vim/</span><br><span class="line"> 16K -rw-------  1 root root  14K  9月 12 10:04 .viminfo</span><br><span class="line">4.0K -rw-------  1 root root  260  9月 12 09:48 .Xauthority</span><br></pre></td></tr></table></figure><p>如 <em>.lesshst</em> 仅有20B，但仍会占用一个block</p><p><code>ls -lh</code> 第一列的值为该文件占用的磁盘空间 $=占用的Block数\times Block大小$</p><h3 id="文件系统的操作"><a href="#文件系统的操作" class="headerlink" title="文件系统的操作"></a>文件系统的操作</h3><h4 id="文件系统信息获取"><a href="#文件系统信息获取" class="headerlink" title="文件系统信息获取"></a>文件系统信息获取</h4><h5 id="获取分区中的各文件系统信息"><a href="#获取分区中的各文件系统信息" class="headerlink" title="获取分区中的各文件系统信息"></a>获取分区中的各文件系统信息</h5><p><strong>df指令读取的信息在超块中</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# df</span><br><span class="line">Filesystem                1K-blocks     Used Available Use% Mounted on</span><br><span class="line">tmpfs                        808408     2064    806344   1% /run</span><br><span class="line">/dev/mapper/vgubuntu-root  48753324 25519996  20724324  56% /</span><br><span class="line">tmpfs                       4042036        0   4042036   0% /dev/shm</span><br><span class="line">tmpfs                          5120        4      5116   1% /run/lock</span><br><span class="line">/dev/sda2                    524252     6228    518024   2% /boot/efi</span><br><span class="line">tmpfs                        808404      104    808300   1% /run/user/1000</span><br><span class="line">tmpfs                        808404       64    808340   1% /run/user/0 </span><br></pre></td></tr></table></figure><ul><li>Filesystem：代表文件系统所在的分区，列出设备名</li><li>1k-blocks：以1KB为单位列出块数</li><li>Used：已使用的磁盘容量</li><li>Available：当前分区剩余的容量</li><li>Use%：磁盘空间使用率</li><li>Mounted on：挂载点</li></ul><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th><th></th></tr></thead><tbody><tr><td>-a</td><td></td><td>列出所有的文件系统（包括内存文件系统）</td><td></td></tr><tr><td>-k</td><td></td><td>显示文件系统分区容量（KB）</td><td><img src="/posts/2763264027/image-20250909140257677.png" alt="image-20250909140257677"></td></tr><tr><td>-m</td><td></td><td>显示文件系统分区容量（MB）</td><td></td></tr><tr><td>-h</td><td></td><td>以人类易读的格式显示</td><td><img src="/posts/2763264027/image-20250909140352531.png" alt="image-20250909140352531"></td></tr><tr><td>-H</td><td></td><td>以M=1000K的进位方式显示</td><td><img src="/posts/2763264027/image-20250909140412685.png" alt="image-20250909140412685"></td></tr><tr><td>-T</td><td></td><td>列出分区的文件系统类型</td><td><img src="/posts/2763264027/image-20250909140436217.png" alt="image-20250909140436217"></td></tr><tr><td>-i</td><td></td><td>不显示磁盘容量，以inode的数量显示</td><td><img src="/posts/2763264027/image-20250909140752135.png" alt="image-20250909140752135"></td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# df -a</span><br><span class="line">df: /run/user/0/doc: Operation not permitted</span><br><span class="line">Filesystem                1K-blocks     Used Available Use% Mounted on</span><br><span class="line">sysfs                             0        0         0    - /sys</span><br><span class="line">proc                              0        0         0    - /proc</span><br><span class="line">udev                        4000964        0   4000964   0% /dev</span><br><span class="line">devpts                            0        0         0    - /dev/pts</span><br><span class="line">tmpfs                        808408     2060    806348   1% /run</span><br><span class="line">/dev/mapper/vgubuntu-root  48753324 25520000  20724320  56% /</span><br><span class="line">securityfs                        0        0         0    - /sys/kernel/security</span><br><span class="line">tmpfs                       4042036        0   4042036   0% /dev/shm</span><br></pre></td></tr></table></figure><p><em>/dev/shm</em> 是利用内存虚拟出来的磁盘空间，通常是总物理内存的一半</p><ul><li>通过内存仿真出来的磁盘，在该目录下创建的数据文件，访问速度非常快</li><li>但创建的内容下次开机就消失</li></ul><h5 id="获取文件或目录的占用量"><a href="#获取文件或目录的占用量" class="headerlink" title="获取文件或目录的占用量"></a>获取文件或目录的占用量</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# mkdir test ; cd test ; echo &quot;hello&quot; &gt;&gt; test.txt | echo &quot;hello aaaaa&quot; &gt;&gt; test2.txt ; mkdir hello ; cd hello; echo &quot;hello1&quot; &gt;&gt; hello1.txt ; echo &quot;hello2&quot; &gt;&gt; hello2.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">du</span> 默认情况，只会显示当前目录下，所有目录的容量</span></span><br><span class="line">root@tzj-virtual-machine:~/test# du </span><br><span class="line">12	./hello</span><br><span class="line">24	.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">du</span> -a 会显示当前目录下，所有目录与文件的容量</span></span><br><span class="line">root@tzj-virtual-machine:~/test# du -a</span><br><span class="line">4	./hello/hello2.txt</span><br><span class="line">4	./hello/hello1.txt</span><br><span class="line">12	./hello</span><br><span class="line">4	./test2.txt</span><br><span class="line">4	./test.txt</span><br><span class="line">24	.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">仅列出当前目录下的总容量</span></span><br><span class="line">root@tzj-virtual-machine:~/test# du -s</span><br><span class="line">24	.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">仅列出当前目录下的二级目录</span></span><br><span class="line">root@tzj-virtual-machine:~/test# du -S</span><br><span class="line">12	./hello</span><br><span class="line">12	.</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~/test# rm -rf *</span><br><span class="line">root@tzj-virtual-machine:~/test# du -a</span><br><span class="line">4	.									&lt;===空目录占用4KB</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td></td><td>列出当前目录下，所有文件与目录的容量</td></tr><tr><td>-h</td><td></td><td>以人类较易读懂的容量格式显示</td></tr><tr><td>-s</td><td></td><td>列出总量，不列出各目录占用的容量</td></tr><tr><td>-S</td><td></td><td>不包括子目录下的总计</td></tr><tr><td>-k</td><td></td><td>以KB列出容量显示</td></tr><tr><td>-m</td><td></td><td>以MB列出容量显示</td></tr></tbody></table></div><p><code>du</code> 指令会直接搜索文件系统内所有的文件数据，搜索范围越大，执行时间越长</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">会输出当前目录下所有二级目录及文件的容量，可观察哪个此目录占用的容量大</span></span><br><span class="line">du -s *</span><br></pre></td></tr></table></figure><h4 id="创建文件链接"><a href="#创建文件链接" class="headerlink" title="创建文件链接"></a>创建文件链接</h4><p>符号链接（Symbolic link）：创建快捷方式</p><ul><li>创建新的文件，文件内容为源文件的文件名</li></ul><p>硬链接（Hard link）：通过inode链接产生新的文件名（只是在某一目录下新增一个文件名）</p><ul><li>由于链接到同一个indoe，所以该文件名对应的内容一致</li></ul><h5 id="硬链接"><a href="#硬链接" class="headerlink" title="硬链接"></a>硬链接</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# ll -i /etc/crontab </span><br><span class="line">655509 -rw-r--r-- 1 root root 1136  3月 23  2022 /etc/crontab</span><br><span class="line">root@tzj-virtual-machine:~# ln /etc/crontab crontab</span><br><span class="line">root@tzj-virtual-machine:~# ls</span><br><span class="line">crontab  snap  test</span><br><span class="line">root@tzj-virtual-machine:~# ll -i /etc/crontab crontab </span><br><span class="line">655509 -rw-r--r-- 2 root root 1136  3月 23  2022 crontab</span><br><span class="line">655509 -rw-r--r-- 2 root root 1136  3月 23  2022 /etc/crontab</span><br></pre></td></tr></table></figure><p>inode2 为目录的indoe，在该inode中记录 <em>/rtc/</em> 目录文件所在的block，读取该block数据内容，可知 <em>crontab</em> 文件的inode号-real，real号指向文件内容实际所在的block</p><p>若 <em>/root/crontab</em> 为硬链接文件，可见 <em>/root</em> 目录中，文件名链接到同一个inode-real</p><p><img src="/posts/2763264027/image-20250909183952470.png" alt="image-20250909183952470"></p><ul><li><p>不管对哪个文件名进行编辑，最终结果都会写入相同的inode与block</p></li><li><p>如果将二者中的任一文件名删除，inode与block都存在</p><p>删除操作只是将目录中的文件名删除，原始的inode与block没有变动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">root@dc_1214:~# mkdir test ; cd test ; echo &quot;hello&quot; &gt;&gt; test.txt | echo &quot;hello aaaaa&quot; &gt;&gt; test2.txt ; mkdir hello ; cd hello; echo &quot;hello1&quot; &gt;&gt; hello1.txt ; echo &quot;hello2&quot; &gt;&gt; hello2.txt</span><br><span class="line">root@dc_1214:~/test/hello# cd ..</span><br><span class="line">root@dc_1214:~/test# tree</span><br><span class="line">.</span><br><span class="line">├── hello</span><br><span class="line">│   ├── hello1.txt</span><br><span class="line">│   └── hello2.txt</span><br><span class="line">├── test2.txt</span><br><span class="line">└── test.txt</span><br><span class="line"></span><br><span class="line">1 directory, 4 files</span><br><span class="line"></span><br><span class="line">root@dc_1214:~/test# ll -i test.txt</span><br><span class="line">4866834 -rw-r--r-- 1 root root 6 Sep 11 09:02 test.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建硬链接文件</span></span><br><span class="line">root@dc_1214:~/test# ln test.txt ~/test/hello/test.txt</span><br><span class="line">root@dc_1214:~/test# ll -i test.txt ~/test/hello/test.txt</span><br><span class="line">4866834 -rw-r--r-- 2 root root 6 Sep 11 09:02 /root/test/hello/test.txt</span><br><span class="line">4866834 -rw-r--r-- 2 root root 6 Sep 11 09:02 test.txt</span><br><span class="line">root@dc_1214:~/test# tree</span><br><span class="line">.</span><br><span class="line">├── hello</span><br><span class="line">│   ├── hello1.txt</span><br><span class="line">│   ├── hello2.txt</span><br><span class="line">│   └── test.txt</span><br><span class="line">├── test2.txt</span><br><span class="line">└── test.txt</span><br><span class="line"></span><br><span class="line">1 directory, 5 files</span><br><span class="line">root@dc_1214:~/test# rm test.txt </span><br><span class="line">root@dc_1214:~/test# ll -i ~/test/hello/test.txt </span><br><span class="line">4866834 -rw-r--r-- 1 root root 6 Sep 11 09:02 /root/test/hello/test.txt</span><br></pre></td></tr></table></figure></li></ul><p>硬链接只是在某个目录的block中多写入一条关联记录，因此，磁盘的空间与inode的数目不变</p><p>硬链接需要在同一文件系统中进行，不能跨文件系统，也不能链接一个目录</p><ul><li><p>若硬链接到目录，目录下的文件也需要被链接</p><p>若此时在新链接目录下创建文件，则原目录下对该新文件也需要被建立链接，会增加系统的复杂度</p></li></ul><h5 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h5><p>软链接（Symbolic link，符号链接）是建立一个独立的文件，对该数据的读取指向被链接的文件名</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln [-sf] 源文件 目标文件</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-s</td><td></td><td>不加任何参数，创建的是硬链接，<br>使用-s参数，创建符号链接文件</td></tr><tr><td>-f</td><td></td><td>如果目标文件存在，则将目标文件移除后再建立</td></tr></tbody></table></div><ul><li><p>符号链接文件的inode中，读取到链接文件的内容为 原文件名 ，根据文件名去获取被链接文件的inode，进而读取到实际存储的内容</p><p><img src="/posts/2763264027/image-20250911110808290.png" alt="image-20250911110808290"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~/test# echo &quot;aaaaa&quot; &gt; test.txt</span><br><span class="line">root@tzj-virtual-machine:~/test# ln -s ./test.txt softlink_test_relative</span><br><span class="line">root@tzj-virtual-machine:~/test# ln -s /root/test/test.txt softlink_test_absolute</span><br><span class="line">root@tzj-virtual-machine:~/test# cat softlink_test_absolute </span><br><span class="line">aaaaa</span><br><span class="line">root@tzj-virtual-machine:~/test# cat softlink_test_relative </span><br><span class="line">aaaaa</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">readlink</span>读取链接文件实际存储的内容</span></span><br><span class="line">root@tzj-virtual-machine:~/test# readlink softlink_test_absolute </span><br><span class="line">/root/test/test.txt</span><br><span class="line">root@tzj-virtual-machine:~/test# readlink softlink_test_relative </span><br><span class="line">./test.txt</span><br></pre></td></tr></table></figure><p><em>softlink_test_absolute</em> 记录的内容是 /root/test/test.txt，所以文件大小为19B</p><p><em>softlink_test_relative</em> 记录的内容是 ./test.txt，所以文件大小为10B</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~/test# ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  2 root root 4096 10月  9 19:39 .</span><br><span class="line">drwx------ 10 root root 4096 10月  9 19:34 ..</span><br><span class="line">lrwxrwxrwx  1 root root   19 10月  9 19:39 softlink_test_absolute -&gt; /root/test/test.txt</span><br><span class="line">lrwxrwxrwx  1 root root   10 10月  9 19:38 softlink_test_relative -&gt; ./test.txt</span><br><span class="line">-rw-r--r--  1 root root    6 10月  9 19:37 test.txt</span><br></pre></td></tr></table></figure></li><li><p>源文件被删除或移动后，链接文件由于找不到原始的文件名，将打不开</p></li><li><p>移动链接文件</p><ul><li>由于使用相对路径建立的链接文件，记录的路径中找不到原文件，所以无法访问，</li><li>但使用绝对路径建立的链接文件，可以找到原文件，所以有输出内容</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~/test# tree</span><br><span class="line">.</span><br><span class="line">├── softlink_test_absolute -&gt; /root/test/test.txt</span><br><span class="line">├── softlink_test_relative -&gt; ./test.txt</span><br><span class="line">└── test.txt</span><br><span class="line"></span><br><span class="line">0 directories, 3 files</span><br><span class="line">root@tzj-virtual-machine:~/test# mkdir test_bak</span><br><span class="line">root@tzj-virtual-machine:~/test# mv softlink_test_* test_bak/</span><br><span class="line">root@tzj-virtual-machine:~/test# tree</span><br><span class="line">.</span><br><span class="line">├── test_bak</span><br><span class="line">│   ├── softlink_test_absolute -&gt; /root/test/test.txt</span><br><span class="line">│   └── softlink_test_relative -&gt; ./test.txt</span><br><span class="line">└── test.txt</span><br><span class="line"></span><br><span class="line">1 directory, 3 files</span><br><span class="line">root@tzj-virtual-machine:~/test# cd test_bak/</span><br><span class="line">root@tzj-virtual-machine:~/test/test_bak# cat softlink_test_absolute </span><br><span class="line">aaaaa</span><br><span class="line">root@tzj-virtual-machine:~/test/test_bak# cat softlink_test_relative </span><br><span class="line">cat: softlink_test_relative: No such file or directory</span><br><span class="line">root@tzj-virtual-machine:~/test/test_bak# </span><br></pre></td></tr></table></figure></li><li><p>符号链接建立的文件是独立的新文件，会占用inode与block</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:/tmp# cd /tmp/</span><br><span class="line">root@tzj-virtual-machine:/tmp# cp -a /etc/passwd .</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">记录当前目录初始占用的容量，182443B，inode使用数量为204885</span></span><br><span class="line">root@tzj-virtual-machine:/tmp# du -sb ; df -i .</span><br><span class="line">182443	.</span><br><span class="line">Filesystem                 Inodes  IUsed   IFree IUse% Mounted on</span><br><span class="line">/dev/mapper/vgubuntu-root 3121152 !204885! 2916267    7% /</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:/tmp# ln passwd passwd-hd</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 创建硬链接文件后，inode使用数量不变，目录占用的容量也不变</span></span></span><br><span class="line">root@tzj-virtual-machine:/tmp# du -sb ; df -i .</span><br><span class="line">182443	.</span><br><span class="line">Filesystem                 Inodes  IUsed   IFree IUse% Mounted on</span><br><span class="line">/dev/mapper/vgubuntu-root 3121152 !204885! 2916267    7% /</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 且indoe为同一个</span></span></span><br><span class="line">root@tzj-virtual-machine:/tmp# ls -il passwd*</span><br><span class="line">393220 -rw-r--r-- 2 root root 2927  7月 30 14:30 passwd</span><br><span class="line">393220 -rw-r--r-- 2 root root 2927  7月 30 14:30 passwd-hd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建软链接文件</span></span><br><span class="line">root@tzj-virtual-machine:/tmp# ln -s passwd passwd-so</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 软链接文件的indoe为不同，表示其为一个新的文件，</span></span></span><br><span class="line">root@tzj-virtual-machine:/tmp# ls -li passwd*</span><br><span class="line">393220 -rw-r--r-- 2 root root 2927  7月 30 14:30 passwd</span><br><span class="line">393220 -rw-r--r-- 2 root root 2927  7月 30 14:30 passwd-hd</span><br><span class="line">393221 lrwxrwxrwx 1 root root    6  9月 11 17:52 passwd-so -&gt; passwd</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 软链接文件中保存的内容为 passwd，</span></span></span><br><span class="line">root@tzj-virtual-machine:/tmp# readlink passwd-so </span><br><span class="line">passwd</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 所以当前目录所占用的容量多6B，且多使用一个inode</span></span></span><br><span class="line">root@tzj-virtual-machine:/tmp# du -sb ; df -i .</span><br><span class="line">182449	.</span><br><span class="line">Filesystem                 Inodes  IUsed   IFree IUse% Mounted on</span><br><span class="line">/dev/mapper/vgubuntu-root 3121152 !204886! 2916266    7% /</span><br></pre></td></tr></table></figure><h4 id="磁盘分区与挂载"><a href="#磁盘分区与挂载" class="headerlink" title="磁盘分区与挂载"></a>磁盘分区与挂载</h4><blockquote><p><strong>挂载点</strong></p><p>每个文件系统都有独立的超块，inode、block等信息，这个文件系统需要链接到目录树，才可被操作系统所使用</p><p>文件系统与目录树的链接称为 <strong>挂载</strong></p><p>挂载点一定是目录，以该目录作为该文件系统的入口</p><hr><p><strong>挂载流程</strong></p><ol><li>建立磁盘分区</li><li>建立文件系统（格式化）</li><li>文件系统校验</li><li>建立挂载点（目录），并挂载文件系统</li></ol></blockquote><h5 id="确认磁盘状态"><a href="#确认磁盘状态" class="headerlink" title="确认磁盘状态"></a>确认磁盘状态</h5><h6 id="列出磁盘列表"><a href="#列出磁盘列表" class="headerlink" title="列出磁盘列表"></a>列出磁盘列表</h6><blockquote><p><code>lsblk</code>：list block device</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk [-dfimpt] [device]</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th><th></th></tr></thead><tbody><tr><td>-d</td><td></td><td>列出磁盘本身，不会列该磁盘的分区数据</td><td><img src="/posts/2763264027/image-20250826162455972.png" alt="image-20250826162455972"></td></tr><tr><td>-f</td><td></td><td>列出磁盘内文件系统类型</td><td><img src="/posts/2763264027/image-20250826170010171.png" alt="image-20250826170010171"></td></tr><tr><td>-i</td><td></td><td>使用ASCII输出，不使用复杂编码</td><td></td></tr><tr><td>-m</td><td></td><td>输出设备在/dev下的权限数据</td><td><img src="/posts/2763264027/image-20250826170044081.png" alt="image-20250826170044081"></td></tr><tr><td>-p</td><td></td><td>显示设备的完整文件名，不是仅列出最后名字</td><td><img src="/posts/2763264027/image-20250826170226427.png" alt="image-20250826170226427"></td></tr><tr><td>-t</td><td></td><td>列出磁盘设备的详细数据</td><td><img src="/posts/2763264027/image-20250826170150945.png" alt="image-20250826170150945"></td></tr></tbody></table></div><ul><li>NAME：设备名，默认忽略 <em>/dev</em> 等目录前缀</li><li>MAJ:MIN：主要：次要设备代码，内核使用该属性识别设备</li><li>RM（removable device）：是否为可移除设备，如光盘、USB盘等</li><li>SIZE：容量</li><li>RO：是否为只读设备</li><li>TYPE：磁盘（disk）、分区（partition）、只读存储器（rom）等</li><li>MOUNTPOINT：挂载点</li></ul><h6 id="获取设备UUID信息——blkid"><a href="#获取设备UUID信息——blkid" class="headerlink" title="获取设备UUID信息——blkid"></a>获取设备UUID信息——blkid</h6><p>Linux会为系统内每个设备设置唯一标识符UUID，用作挂载或使用这个装置/文件系统</p><p><img src="/posts/2763264027/image-20250826174514279.png" alt="image-20250826174514279"></p><h6 id="获取磁盘分区信息——parted"><a href="#获取磁盘分区信息——parted" class="headerlink" title="获取磁盘分区信息——parted"></a>获取磁盘分区信息——parted</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parted device_name print</span><br></pre></td></tr></table></figure><p><img src="/posts/2763264027/image-20250826174627256.png" alt="image-20250826174627256"></p><h5 id="磁盘分区"><a href="#磁盘分区" class="headerlink" title="磁盘分区"></a>磁盘分区</h5><blockquote><p><code>parted</code> 通用</p><ul><li><code>fdisk</code> 建立MBR分区</li><li><code>gdisk</code> 建立GPT分区</li></ul></blockquote><h6 id="fdisk"><a href="#fdisk" class="headerlink" title="fdisk"></a>fdisk</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fdisk device_name</span><br><span class="line"></span><br><span class="line">m：帮助</span><br><span class="line">n：新建一个分区</span><br><span class="line">d：删除一个分区</span><br><span class="line">p：打印分区表</span><br><span class="line">q：退出，不保存修改</span><br><span class="line">w：将修改写入分区表</span><br></pre></td></tr></table></figure><h6 id="gdisk"><a href="#gdisk" class="headerlink" title="gdisk"></a>gdisk</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdisk device_name</span><br></pre></td></tr></table></figure><ul><li><p>首先，打印分区表，获取最后一个扇区号</p></li><li><p>输入创建分区后</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Partition number (4-128, default 4): 4 # 预设就是 4 号，所以也能 enter 即可！</span><br><span class="line">First sector (34-83886046, default = 65026048) or &#123;+-&#125;size&#123;KMGTP&#125;: 65026048 # 也能 enter</span><br><span class="line">Last sector (65026048-83886046, default = 83886046) or &#123;+-&#125;size&#123;KMGTP&#125;: +1G # 绝不要 enter</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Command (? for help): p</span><br><span class="line">Number Start (sector) End (sector) Size Code Name</span><br><span class="line">1 2048 6143 2.0 MiB EF02</span><br><span class="line">2 6144 2103295 1024.0 MiB 0700</span><br><span class="line">3 2103296 65026047 30.0 GiB 8E00</span><br><span class="line">4 65026048 67123199 1024.0 MiB 8300 Linux filesystem</span><br><span class="line">5 67123200 69220351 1024.0 MiB 0700 Microsoft basic data</span><br><span class="line">6 69220352 70244351 500.0 MiB 8200 Linux swap</span><br></pre></td></tr></table></figure><ul><li><em>Code</em> 属性：文件系统ID</li><li>Linux 为8200、8300、8e00三种格式</li></ul><p>上述 <code>fdisk</code> 与 <code>gdisk</code> 执行完后，需要重启系统</p><h6 id="partprobe更新内核的分区表信息"><a href="#partprobe更新内核的分区表信息" class="headerlink" title="partprobe更新内核的分区表信息"></a>partprobe更新内核的分区表信息</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">partprobe [-s] # 你可以不要加 -s ！那么屏幕不会出现讯息！</span><br><span class="line">partprobe -s # 不过还是建议加上 -s 比较清晰！</span><br><span class="line"></span><br><span class="line">lsblk /dev/vda # 实际的磁盘分区状态</span><br><span class="line"></span><br><span class="line">cat /proc/partitions # 获取内核识别到的分区信息</span><br></pre></td></tr></table></figure><h6 id="删除分区的操作"><a href="#删除分区的操作" class="headerlink" title="删除分区的操作"></a>删除分区的操作</h6><ol><li>首先解除挂载</li><li>然后再删除分区</li></ol><p>直接删除分区，虽然磁盘会写入正确的分区信息，但内核无法更新分区表信息</p><h6 id="使用parted进行分区"><a href="#使用parted进行分区" class="headerlink" title="使用parted进行分区"></a>使用parted进行分区</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parted 设备名 [指令 [参数]]</span><br></pre></td></tr></table></figure><p>指令功能：</p><ul><li><p>新增分区：<code>mkpart [primary | logical | extended] [ext4 | vfat | xfs]</code> 开始扇区号 结束扇区号</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parted /dev/vda mkpart primary fat32 36.0GB 36.5GB</span><br></pre></td></tr></table></figure></li><li><p>显示分区：<code>print 设备名</code></p><p><code>parted /dev/vda unit mb print</code> 固定单位</p></li><li><p>删除分区：<code>rm 分区名</code></p></li><li><p>修改硬盘的分区表类型：</p><p><code>parted 设备名 mklabel gpt/mbr</code></p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@dc_1214:~# parted /dev/sdb print</span><br><span class="line">Model: ABOSION 128G SSD (scsi)				# 硬盘接口与型号</span><br><span class="line">Disk /dev/sdb: 128GB						# 扇区容量</span><br><span class="line">Sector size (logical/physical): 512B/512B	# 分区表类型</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags: </span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    Type     File system  Flags</span><br><span class="line"> 1      33.6MB  10.8GB  10.7GB  primary  ext4</span><br><span class="line"> 2      10.8GB  128GB   117GB   primary  ext4</span><br></pre></td></tr></table></figure><ul><li>Number：分区号</li><li>Start：分区起始位置在磁盘多少MB处</li><li>End：分区结束位置在磁盘多少MB处</li><li>Size：分区容量</li><li>Type：分区类型</li><li>File system：文件系统</li></ul><h5 id="格式化——mkfs"><a href="#格式化——mkfs" class="headerlink" title="格式化——mkfs"></a>格式化——mkfs</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# mkfs [Tab][Tab] # 查看支持的文件系统</span><br><span class="line">mkfs         mkfs.bfs     mkfs.cramfs  mkfs.ext2    mkfs.ext3    mkfs.ext4    mkfs.fat     mkfs.minix   mkfs.msdos   mkfs.ntfs    mkfs.vfat</span><br></pre></td></tr></table></figure><h6 id="mkfs-xfs"><a href="#mkfs-xfs" class="headerlink" title="mkfs.xfs"></a>mkfs.xfs</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs -b bsize -d parms -i parms -l parms -L label -f \</span><br><span class="line">-r parms 设备名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-b</td><td>默认单位B，kmgtp为字节数，</td><td>块大小，Linux限制最大为4KB</td></tr><tr><td>-d</td><td>agcount=数值：需要几个存储组（AG），与CPU相关<br>agsize=数值：每个AG设定为多少容量（agcount/agsize直选设一个即可）<br>file：格式化的设备是个文件而不是设备<br>size=数值：指定格式化后文件系统的容量<br>su=数值：当有RAID时，标识stripe，<br>sw=数值：当有RAID时，用于存储数据的磁盘数<br>sunit=数值：与su相当，单位是使用几个扇区<br>swidth=数值：sw*sw的数值，但是以几个扇区来设定</td><td>数据分区相关的参数值</td></tr><tr><td>-f</td><td></td><td>若已有文件系统，则需要强制格式化</td></tr><tr><td>-i</td><td>size=数值：256B~2K<br>internal=[ 0 \</td><td>1]：是否内置log设备（日志盘是否与数据盘同盘）<br>logdev=device：指定日志存放的设备<br>size=数值：指定日志盘的容量，2M以上</td><td>与inode相关的参数</td></tr><tr><td>-L</td><td></td><td>指定卷标</td></tr><tr><td>-r</td><td>extsize=数值：有RAID时，最好设定与swidth的数值相同，4K~1G</td><td>指定realtime 分区的相关设置</td></tr></tbody></table></div><ul><li><p>xfs可使用多个数据流来读写系统，以增加速度。因此 <strong>agcount</strong> 可以与CPU内核数搭配</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#x27;processor&#x27; /proc/cpuinfo</span><br></pre></td></tr></table></figure></li><li><p>RAID相关操作</p><p>磁盘阵列，将多个硬盘组为一个大硬盘，同步写入这些硬盘，并支持容错机制（一个磁盘故障，整个文件系统可持续运行）</p><p>RAID将文件细分为多个小的条带（stripe），将众多条带分别放在RAID的物理硬盘</p><p>为确保高可用，一个文件会被同时写入到多个磁盘中，同时会保留多个备份盘（parity disk），而且还会保留一个备用盘（spare disk）</p><p>分区条带界于4K~1M间，条带与文件数据容量与读写效率相关</p><ul><li>当系统多为大型文件，建议条带设置大一些，可以降低RAID的读/写频率</li><li>当系统多为小型文件，条件设置小一些</li></ul><p>一些常见设置</p><ul><li><p>agcount设置为CPU数量</p></li><li><p>RAID条带为256K时，su设为256K</p></li><li><p>磁盘阵列含8个磁盘，且为RAID5，因此有1个备份盘，sw设置7</p></li><li><p>数据宽度256K*7=1792K，则extsize为1792K</p><p>换算为扇区，$sunit=256KB/512B=512$ 个扇区</p><p>$swidth=7*sunit=3584$ 个扇区</p></li></ul></li></ul><h6 id="mkfs-ext4"><a href="#mkfs-ext4" class="headerlink" title="mkfs.ext4"></a>mkfs.ext4</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4-b size -L label 装置名称</span><br><span class="line"></span><br><span class="line">[root@study ~]# mkfs.ext4 /dev/vda5</span><br><span class="line">mke2fs 1.42.9 (28-Dec-2013)</span><br><span class="line">Filesystem label= # 显示 Label name</span><br><span class="line">OS type: Linux</span><br><span class="line">Block size=4096 (log=2) # 每一个 block 的大小</span><br><span class="line">Fragment size=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks # 跟 RAID 相关性较高</span><br><span class="line">65536 inodes, 262144 blocks # 总计 inode/block 的数量</span><br><span class="line">13107 blocks (5.00%) reserved for the super user</span><br><span class="line">First data block=0</span><br><span class="line">Maximum filesystem blocks=268435456</span><br><span class="line">8 block groups # 共有 8 个 block groups 喔！</span><br></pre></td></tr></table></figure><p>文件系统默认值写入系统的 <em>/etc/mke2fs.conf</em> 文件</p><h5 id="文件系统检验"><a href="#文件系统检验" class="headerlink" title="文件系统检验"></a>文件系统检验</h5><ul><li>仅root用户，且文件系统确实存在问题，才可使用文件系统的修复指令</li><li>修复文件系统时，分区不可被挂载</li></ul><h6 id="EXT4文件系统检验"><a href="#EXT4文件系统检验" class="headerlink" title="EXT4文件系统检验"></a>EXT4文件系统检验</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsck.ext4 -pf -b superblock 装置名称</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-p</td><td></td><td>自动回复y，继续进行修复动作</td></tr><tr><td>-f</td><td></td><td>强制检查，若fsck发现没有unclean标志，不会主动进行细部检查，若想强制fsck进行细部检查，需-f</td></tr><tr><td>-D</td><td></td><td>仅针对文件系统下的目录进行优化配置</td></tr><tr><td>-b</td><td></td><td>接备份超块的位置，若超块损坏，则可以通过该参数指定的备份超块进行恢复</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# dumpe2fs -h /dev/mapper/vgubuntu-root  | grep &quot;Blocks per group&quot;</span><br><span class="line">dumpe2fs 1.46.5 (30-Dec-2021)</span><br><span class="line">Blocks per group:         32768</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 每个group的块数记录在文件系统描述说明中，第二个超块备份就放置在32768号块中</span></span></span><br><span class="line">fsck.ext4 -b 32768 /dev/vda5</span><br></pre></td></tr></table></figure><h6 id="xfs文件系统的检验"><a href="#xfs文件系统的检验" class="headerlink" title="xfs文件系统的检验"></a>xfs文件系统的检验</h6><p>Linux的根目录 <em>\\</em> 不可被解除挂载，若修复根目录，需要进入单人维护模式或救援模式，通过 <code>-d</code> 来处理，系统强制检查该设备，检验完毕后自动重启系统</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_repair -fnd 装置名称</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td></td><td>设备实际为文件，不是实体设备</td></tr><tr><td>-n</td><td></td><td>单纯检查，并不修改文件系统的数据</td></tr><tr><td>-d</td><td></td><td>在担任维护模式下，仅针对根目录进行检查与修复、</td></tr></tbody></table></div><h5 id="文件系统挂载与解除"><a href="#文件系统挂载与解除" class="headerlink" title="文件系统挂载与解除"></a>文件系统挂载与解除</h5><blockquote><p>文件系统挂载实质上，是设置进入磁盘分区槽的目录</p></blockquote><ul><li>一个文件系统仅可被挂载到一个挂载点</li><li>一个挂载点仅可挂载一个文件系统</li><li>根目录 <em>/</em> 必须被挂载，且先与其他文件系统被挂载</li><li>其他挂载点必须为已建立的目录</li><li>解除挂载，需先将工作目录移出到挂载点外</li></ul><p>文件系统挂载后，原目录下的内容会暂时被分区中的文件系统替换</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount [选项] [参数]</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td></td><td>依据 <em>/fstab</em> 的记录，挂载所有文件系统</td></tr><tr><td>-l</td><td></td><td><code>mount</code> 会显示目前挂载信息<br><code>mount -l</code> 会增加Label名称</td></tr><tr><td>-t</td><td></td><td>指定待挂载的文件系统类型（xfs、ext3、ext4等）</td></tr><tr><td>-n</td><td></td><td>默认情况下，实际挂载信息会被实时写入 <em>/etc/mtab</em> 中，便于其他程序使用<br>特殊情况（单人维护模式）下，为避免出错，会禁止写入该文件</td></tr><tr><td>-o</td><td>async、sync：是否使用同步写入与异步的内存机制<br>atime、noatime：是否更新文件系统的读取时间<br>ro, rw：文件系统为只读（ro）或可读写（rw）<br>auto，noauto：是否允许文件系统被 <code>mount -a</code> 自动挂载<br>dev，nodev：是否允许此文件系统设置为设备文件<br>suid，nosuid：是否允许此文件系统含suid/sgid格式的文件<br>exec，noexec：是否允许此文件系统执行可执行文件<br>user，nouser：是否允许此文件系统被任一用户挂载，默认为nouser，即仅root用户可挂载，设为user可使普通用户也有权限挂载分区<br>defaults：默认值async，rw，suid，dev，exec，auto，nouser<br>remount：重新挂载</td><td>指定额外参数</td></tr></tbody></table></div><h6 id="文件系统的自动挂载原理"><a href="#文件系统的自动挂载原理" class="headerlink" title="文件系统的自动挂载原理"></a>文件系统的自动挂载原理</h6><p>当前文件系统的所有信息都被记录到超块中</p><p>Linux可以分析超块中的文件系统类型，与驱动程序是否搭配</p><p>若二者一致，则可自动地挂载该文件系统</p><ul><li>Linux系统已加载的文件系统类型，记录在 <em>/proc/filesystems</em> 下</li><li>自动挂载文件系统的测试顺序，记录在 <em>/etc/filesystems</em></li></ul><p>Linux系统支持的文件系统驱动程序记录在 <em>/lib/modules/$(uname -r)/kernel/fs/</em> 目录下</p><h6 id="挂载xfs-ext4-vfat等文件系统"><a href="#挂载xfs-ext4-vfat等文件系统" class="headerlink" title="挂载xfs/ext4/vfat等文件系统"></a>挂载xfs/ext4/vfat等文件系统</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 获取分区的UUID</span></span><br><span class="line">blkid /dev/xxx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 创建挂载目录</span></span><br><span class="line">mkdir 挂载点</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. 利用UUID挂载文件系统</span></span><br><span class="line">mount UUID=&quot;xxxx&quot;  挂载点</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4. 显示挂载点信息</span></span><br><span class="line">root@tzj-virtual-machine:~# df /</span><br><span class="line">Filesystem                1K-blocks     Used Available Use% Mounted on</span><br><span class="line">/dev/mapper/vgubuntu-root  48753324 25458168  20786152  56% /</span><br></pre></td></tr></table></figure><h6 id="挂载CD或DVD光盘"><a href="#挂载CD或DVD光盘" class="headerlink" title="挂载CD或DVD光盘"></a>挂载CD或DVD光盘</h6><ul><li>光驱挂载的特殊之处在于，一旦挂载，只能手动解除</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取分区UUID</span></span><br><span class="line">blkid</span><br><span class="line">通常会以 /dev/srx开始</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建目录</span></span><br><span class="line">mkdir /data/cdrom</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载</span></span><br><span class="line">mount 设备名 挂载点</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示挂载点信息</span></span><br><span class="line">df 挂载点</span><br></pre></td></tr></table></figure><h6 id="挂载中文USB设备"><a href="#挂载中文USB设备" class="headerlink" title="挂载中文USB设备"></a>挂载中文USB设备</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# blkid</span><br><span class="line">/dev/sda1: UUID=&quot;35BC-6D6B&quot; TYPE=&quot;vfat&quot;</span><br><span class="line"></span><br><span class="line">[root@study ~]# mkdir /data/usb</span><br><span class="line"></span><br><span class="line">[root@study ~]# mount -o codepage=950,iocharset=utf8 UUID=&quot;35BC-6D6B&quot; /data/usb</span><br><span class="line"></span><br><span class="line">[root@study ~]# df /data/usb</span><br></pre></td></tr></table></figure><ul><li><p>若磁盘内含有中文文件名的数据，则需要在挂载时，指定文件系统所使用的语种及文字编码</p><ul><li>语种：vfat文件格式，使用codepage处理</li><li>编码：iocharset（utf8或big5、unicode等）</li></ul></li><li><p>若磁盘格式为NTFS，则需要安装NTFS文件系统的驱动程序</p></li></ul><h6 id="修改挂载参数"><a href="#修改挂载参数" class="headerlink" title="修改挂载参数"></a>修改挂载参数</h6><blockquote><p>适用于：修改挂载参数或根目录变为只读状态</p><ul><li>在单人维护模式下，根目录通常被系统挂载为只读</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mount -o [参数] 挂载点</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将根目录重新挂载，并指定挂载参数为 rw与auto</span></span><br><span class="line">[root@study ~]# mount -o remount,rw,auto /</span><br></pre></td></tr></table></figure><h6 id="解除挂载"><a href="#解除挂载" class="headerlink" title="解除挂载"></a>解除挂载</h6><p>将设备文件解除挂载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount [选项] 设备文件名/挂载点</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td></td><td>强制解除挂载（NFS无法读取的情况下使用）</td></tr><tr><td>-l</td><td></td><td>立即解除文件系统</td></tr><tr><td>-n</td><td></td><td>不更新 <em>/etc/mtab</em> 的情况下卸载</td></tr></tbody></table></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设备文件名</span></span><br><span class="line">umount /dev/vda4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载点</span></span><br><span class="line">umount /data/ext4</span><br><span class="line">umount /data/cdrom</span><br></pre></td></tr></table></figure><h5 id="设置开机挂载"><a href="#设置开机挂载" class="headerlink" title="设置开机挂载"></a>设置开机挂载</h5><p><em>/etc/fstab</em> （filesystem table），在利用 <code>mount</code> 指令进行挂载时，会将所有的参数、选项写入到该配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设备文件名/UUID 挂载点 文件系统类型 [文件系统选项/参数] dump fsck</span><br></pre></td></tr></table></figure><ul><li><p>设备文件名/UUID/LABEL名：</p><p>指定待挂载的设备</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda</span><br><span class="line">UUID=xxx</span><br><span class="line">LABEL=xxx</span><br></pre></td></tr></table></figure><p>LVM文件名在系统中也是唯一的 <em>/dev/mapper/xxx</em></p></li><li><p><strong>loop设备的挂载不能使用UUID，因为系统仅查询块设备的UUID，不会查询文件</strong></p></li><li><p>挂载点（目录）</p></li><li><p>磁盘分区的文件系统类型</p><p>xfs/ext4/vfat等</p></li><li><p>文件系统参数</p><p>与 <code>mount -o [选项/参数]</code> 中指定的参数相同</p><p>| 参数 | 含义 |<br>| —————- | —————————————————————————————- |<br>| async/sync | 设定磁盘是否异步，异步读写性能较好 |<br>| auto/noauto | 执行<code>mount -a</code> 指令时，文件系统是否可被自动挂载 |<br>| rw/ro | 分区以只读还是可读写的方式挂载 |<br>| exec/noexec | 限制文件系统内是否可进行执行操作 |<br>| user/nouser | 是否允许用户使用mount指令挂载，普通用户也有挂载权限比较危险 |<br>| suid/nosuid | 是否允许文件系统内有SUID类型的文件存在 |<br>| defaults | 默认参数为rw,suid,dev,exec,auto,nouser,async |</p></li><li><p>是否可被dump指令备份</p><p><code>dump</code> 是一个用于备份的指令，现在有更好的备份方案，默认为0即可</p></li><li><p>是否以fsck检验扇区</p><p>早期开机程序，会间隔一段时间检验本机的文件系统是否clean，主要通过fsck执行，但现在XFS文件系统会自行检验，因此，直接填0即可</p></li></ul><p><em>/etc/fstab</em> 仅是开机时的配置文件，实际的文件系统挂载被记录到 <em>/etc/mtab</em> 与 <em>/proc/monts</em> 中</p><p>当 <em>/etc/fstab</em> 编写错误，导致无法正常开机，需要进入单人维护模式，但处于只读模式，因此需要将根目录重新挂载 <code>mount -n -o remount,rw /</code></p><ul><li>重新挂载根目录，且本次挂载不会被记录到文件</li></ul><h5 id="loop设备的挂载（镜像文件直接使用）"><a href="#loop设备的挂载（镜像文件直接使用）" class="headerlink" title="loop设备的挂载（镜像文件直接使用）"></a>loop设备的挂载（镜像文件直接使用）</h5><blockquote><p>不需要将镜像刻录到硬盘，即可以镜像文件形式被挂载使用</p><p>用于制作离线镜像源</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 获取iso镜像文件</span></span><br><span class="line">[root@study ~]# ll -h /tmp/CentOS-7.0-1406-x86_64-DVD.iso</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. 创建挂载点</span></span><br><span class="line">mkdir /data/cdrom</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. 挂载镜像文件</span></span><br><span class="line">mount -o loop /path/to/iso /path/to/mount_point</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4. 查看与解除挂载</span></span><br><span class="line">df /path/to/mount_point</span><br><span class="line">umount /path/to/mount_point</span><br></pre></td></tr></table></figure><h6 id="挂载ubuntu离线镜像源"><a href="#挂载ubuntu离线镜像源" class="headerlink" title="挂载ubuntu离线镜像源"></a>挂载ubuntu离线镜像源</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载指令</span></span><br><span class="line">/usr/bin/mount -o loop -t iso9660 /media/ubuntu-22.04.5-desktop-amd64.iso /mnt/iso</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 启动开机自动挂载服务</span></span><br><span class="line">vim /etc/systemd/system/mount_iso.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Mount iso service</span><br><span class="line">After=network.target auditd.service</span><br><span class="line">ConditionPathExists=!/etc/ssh/sshd_not_to_be_run</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/bin/mount -o loop /media/ubuntu-22.04.5-desktop-amd64.iso /mnt/iso</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">Alias=mount_iso.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置开机自动启动</span></span><br><span class="line">systemctl enable mount.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2.修改apt源配置文件</span></span><br><span class="line">vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">deb [trusted=yes] file:///mnt/iso jammy main restricte</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新本地源</span></span><br><span class="line">apt clean all</span><br><span class="line">apt update</span><br></pre></td></tr></table></figure><h6 id="挂载centos离线镜像源"><a href="#挂载centos离线镜像源" class="headerlink" title="挂载centos离线镜像源"></a>挂载centos离线镜像源</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将系统的安装镜像放到 /media/下</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建挂载点</span></span><br><span class="line">[root@node205 ~]# mkdir /mnt/iso</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将镜像挂载到挂载点</span></span><br><span class="line">[root@node205 ~]# mount -o loop /media/Kylin-Sever-V10-GFB-RC5-030-arm64.iso /mnt/iso</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置开机自动挂载</span></span><br><span class="line">[root@node205 ~]# vim /etc/fstab</span><br><span class="line">/media/Kylin-Sever-V10-GFB-RC5-030-arm64.iso /mnt/iso iso9660 loop,defaults 0 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改yum源配置</span></span><br><span class="line">[root@node205 ~]# cd /etc/yum.repos.d/</span><br><span class="line">[root@node205 yum.repos.d]# cp kylin_aarch64.repo kylin_aarch64.repo.bak</span><br><span class="line">[ks10-adv-os]</span><br><span class="line">name = Kylin Linux Advanced Server 10 - Os </span><br><span class="line">baseurl = file:///mnt/iso/</span><br><span class="line">gpgcheck = 0</span><br><span class="line">enabled = 1</span><br><span class="line"></span><br><span class="line">[root@node205 yum.repos.d]# yum clean all</span><br><span class="line">[root@node205 yum.repos.d]# yum makecacke</span><br></pre></td></tr></table></figure><h6 id="制作loop设备文件以挂载"><a href="#制作loop设备文件以挂载" class="headerlink" title="制作loop设备文件以挂载"></a>制作loop设备文件以挂载</h6><p>当分区中有多余空间，可用于存储其他数据，可将该空间制作为loop设备文件，以供挂载使用</p><ol><li><p>建立大文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">建立块大小为1MB，512MB的大文件</span></span><br><span class="line">dd if=/dev/zero of=/srv/loopdev bs=1M count=512</span><br></pre></td></tr></table></figure><ul><li>if：input file，输入文件， <em>/dev/zero</em> 是会一直输出0的设备、</li><li>of：outfile，待写入的目标文件</li><li>bs：块大小</li><li>count：块数量</li></ul></li><li><p>对大文件格式化</p><p>XFS不能被格式化，需要对其强制格式化</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs -f /srv/loopdev</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">blkid 也可列出在大文件内部的文件系统</span></span><br><span class="line">blkid /srv/loopdev</span><br><span class="line">/srv/loopdev: UUID=&quot;7dd97bd2-4446-48fd-9d23-a8b03ffdd5ee&quot; TYPE=&quot;xfs&quot;</span><br></pre></td></tr></table></figure></li><li><p>挂载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -o loop UUID=&quot;7dd97bd2-4446-48fd-9d23-a8b03ffdd5ee&quot; /mnt</span><br></pre></td></tr></table></figure></li></ol><h5 id="目录挂载"><a href="#目录挂载" class="headerlink" title="目录挂载"></a>目录挂载</h5><p>利用 <code>mount --bind 原目录 新目录挂载点</code> 将某个目录挂载到另一个目录</p><p>相当于符号链接，进入新目录相当于进入原目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# mkdir /data/var</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将原目录挂载到新目录挂载点</span></span><br><span class="line">[root@study ~]# mount --bind /var /data/var</span><br><span class="line">[root@study ~]# ls -lid /var /data/var</span><br><span class="line">16777346 drwxr-xr-x. 22 root root 4096 Jun 15 23:43 /data/var</span><br><span class="line">16777346 drwxr-xr-x. 22 root root 4096 Jun 15 23:43 /var</span><br></pre></td></tr></table></figure><p>目录卸载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount 新目录挂载点</span><br></pre></td></tr></table></figure><h4 id="修改文件系统参数"><a href="#修改文件系统参数" class="headerlink" title="修改文件系统参数"></a>修改文件系统参数</h4><h5 id="mknod指定设备文件的MAJ与MIN"><a href="#mknod指定设备文件的MAJ与MIN" class="headerlink" title="mknod指定设备文件的MAJ与MIN"></a>mknod指定设备文件的MAJ与MIN</h5><p>设备文件通过major（主要设备代码）与minor（次要设备代码）表示某个设备</p><div class="table-container"><table><thead><tr><th>磁盘设备文件名</th><th>Major</th><th>Minor</th></tr></thead><tbody><tr><td><em>/dev/sda</em></td><td>8</td><td>0~15</td></tr><tr><td><em>/dev/sdb</em></td><td>8</td><td>16~31</td></tr><tr><td><em>/dev/loop0</em></td><td>7</td><td>0</td></tr><tr><td><em>/dev/loop1</em></td><td>7</td><td>1</td></tr></tbody></table></div><p>Linux内核2.6之后，硬件文件名由系统自动的实时产生</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mknod 设备文件名 [参数] Major Minor</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td></td><td>b</td><td>指定为块设备（磁盘等）</td></tr><tr><td></td><td>c</td><td>指定为字符设备（鼠标、键盘）</td></tr><tr><td></td><td>p</td><td>指定为FIFO文件</td></tr></tbody></table></div><h5 id="xfs-admin修改XFS文件系统的UUID与Label-name"><a href="#xfs-admin修改XFS文件系统的UUID与Label-name" class="headerlink" title="xfs_admin修改XFS文件系统的UUID与Label name"></a>xfs_admin修改XFS文件系统的UUID与Label name</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xfs_admin [选项]</span><br><span class="line">xfs_admin -L label_name -U uuid_值	设备文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-l</td><td></td><td>列出设备的label name</td></tr><tr><td>-u</td><td></td><td>列出设备的UUID</td></tr><tr><td>-L</td><td></td><td>指定设备的label</td></tr><tr><td>-U</td><td></td><td>指定设备的UUID</td></tr></tbody></table></div><h5 id="tune2fs修改ext4文件系统的UUID与label-name"><a href="#tune2fs修改ext4文件系统的UUID与label-name" class="headerlink" title="tune2fs修改ext4文件系统的UUID与label name"></a>tune2fs修改ext4文件系统的UUID与label name</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l # 类似 dumoe2fs -h，读取文件系统超块内的信息</span><br><span class="line">tune2fs -L label名 -U UUID值</span><br></pre></td></tr></table></figure><h4 id="内存置换空间的构建"><a href="#内存置换空间的构建" class="headerlink" title="内存置换空间的构建"></a>内存置换空间的构建</h4><blockquote><p>内存置换空间（swap）：硬盘中暂时放置内存中数据的区域</p></blockquote><p>早期操作系统的安装，必须划分的两个分区是根目录（<em>/</em>）与内存置换分区</p><ul><li>若物理内存的资源足够，则swap分区不会被系统所使用</li><li>仅当物理内存资源不足的情况下，swap分区才会被使用</li><li>若主机支持休眠，运行中的程序状态也会被记录到swap分区中</li></ul><p>流程：</p><ol><li>设置一个swap分区</li><li>建立虚拟内存文件</li></ol><h5 id="使用分区构建swap分区"><a href="#使用分区构建swap分区" class="headerlink" title="使用分区构建swap分区"></a>使用分区构建swap分区</h5><ol><li>分区：gdisk在磁盘中划分一个分区槽，作为swap分区</li><li>格式化：将分区格式化为swap格式，<code>mkswap 设备文件名</code></li><li>使用：启动该swap分区， <code>swapon 设备文件名</code></li><li>通过free与 <code>swapon -s</code> 就可观察内存的使用量</li></ol><p><strong>分区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# gdisk /dev/sdb</span><br><span class="line">GPT fdisk (gdisk) version 1.0.8</span><br><span class="line"></span><br><span class="line">Partition table scan:</span><br><span class="line">  MBR: not present</span><br><span class="line">  BSD: not present</span><br><span class="line">  APM: not present</span><br><span class="line">  GPT: not present</span><br><span class="line"></span><br><span class="line">Creating new GPT entries in memory.</span><br><span class="line"></span><br><span class="line">Command (? for help): n</span><br><span class="line">Partition number (1-128, default 1): </span><br><span class="line">First sector (34-41943006, default = 2048) or &#123;+-&#125;size&#123;KMGTP&#125;: </span><br><span class="line">Last sector (2048-41943006, default = 41943006) or &#123;+-&#125;size&#123;KMGTP&#125;: </span><br><span class="line">Current type is 8300 (Linux filesystem)</span><br><span class="line">Hex code or GUID (L to show codes, Enter = 8300): </span><br><span class="line">Changed type of partition to &#x27;Linux filesystem&#x27;</span><br><span class="line"></span><br><span class="line">Command (? for help): w</span><br><span class="line"></span><br><span class="line">Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING</span><br><span class="line">PARTITIONS!!</span><br><span class="line"></span><br><span class="line">Do you want to proceed? (Y/N): y</span><br><span class="line">OK; writing new GUID partition table (GPT) to /dev/sdb.</span><br><span class="line">The operation has completed successfully.</span><br><span class="line">root@tzj-virtual-machine:~# partprobe</span><br><span class="line">root@tzj-virtual-machine:~# lsblk</span><br></pre></td></tr></table></figure><p><strong>构建swap格式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# mkswap /dev/sdb1</span><br><span class="line">Setting up swapspace version 1, size = 20 GiB (21473763328 bytes)</span><br><span class="line">no label, UUID=2578e2ef-ca15-4054-a91a-674fce1db3cc</span><br><span class="line">[root@study ~]# blkid /dev/vda6</span><br></pre></td></tr></table></figure><p><strong>使用swap分区以及观察</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# free</span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:         8084036      918184     6423360       29564      742492     6890316</span><br><span class="line">Swap:        1998844           0     1998844</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# swapon /dev/sdb1</span><br><span class="line">root@tzj-virtual-machine:~# free</span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:         8084036      937368     6401772       29564      744896     6871048</span><br><span class="line">Swap:       22969316           0    22969316</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# swapon -s</span><br><span class="line">Filename				Type		Size		Used		Priority</span><br><span class="line">/dev/dm-1                               partition	1998844		0		-2</span><br><span class="line">/dev/sdb1                               partition	20970472	0		-3</span><br></pre></td></tr></table></figure><p><strong>开机自动挂载</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/fstab</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">文件系统类型为swap，由于没有挂载点，所以挂载点写swap</span></span><br><span class="line">UUID=2578e2ef-ca15-4054-a91a-674fce1db3cc swap swap defaults 0 0</span><br></pre></td></tr></table></figure><p><strong>解除swap分区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# swapoff /dev/sdb1</span><br><span class="line">root@tzj-virtual-machine:~# free</span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:         8084036      892560     6438656       23256      752820     6921896</span><br><span class="line">Swap:        1998844           0     1998844</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~# swapon -s</span><br><span class="line">Filename				Type		Size		Used		Priority</span><br><span class="line">/dev/dm-1                               partition	1998844		0		-2</span><br></pre></td></tr></table></figure><h5 id="使用文件构建swap"><a href="#使用文件构建swap" class="headerlink" title="使用文件构建swap"></a>使用文件构建swap</h5><p>将文件设为loop设备，后续步骤与分区构建swap一致</p><ol><li>初始化文件</li><li>将文件格式化为swap格式</li><li>使用 <code>swapon</code> 启动swap分区</li></ol><p><strong>初始化文件</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# dd if=/dev/zero of=/tmp/swap bs=1M count=128</span><br><span class="line">128+0 records in</span><br><span class="line">128+0 records out</span><br><span class="line">134217728 bytes (134 MB, 128 MiB) copied, 0.0676459 s, 2.0 GB/s</span><br></pre></td></tr></table></figure><p><strong>将swap文件格式化为swap的文件格式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# mkswap /tmp/swap</span><br><span class="line">mkswap: /tmp/swap: insecure permissions 0644, fix with: chmod 0600 /tmp/swap</span><br><span class="line">Setting up swapspace version 1, size = 128 MiB (134213632 bytes)</span><br><span class="line">no label, UUID=c3402139-8cf7-46b0-bb23-799c7c11a0cf</span><br></pre></td></tr></table></figure><p><strong>启动swap分区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# swapon /tmp/swap</span><br><span class="line">swapon: /tmp/swap: insecure permissions 0644, 0600 suggested.</span><br><span class="line">root@tzj-virtual-machine:~# swapon -s</span><br><span class="line">Filename				Type		Size		Used		Priority</span><br><span class="line">/dev/dm-1                               partition	1998844		0		-2</span><br><span class="line">/tmp/swap                               file		131068		0		-3</span><br></pre></td></tr></table></figure><p><strong>开机自动挂载</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~# vim /etc/fstab</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loop设备的挂载不能使用UUID，因为系统仅查询块设备的UUID，不会查询文件</span></span><br><span class="line">/tmp/swap swap swap defaults 0 0</span><br></pre></td></tr></table></figure><h2 id="文件与文件系统的压缩、打包、备份"><a href="#文件与文件系统的压缩、打包、备份" class="headerlink" title="文件与文件系统的压缩、打包、备份"></a>文件与文件系统的压缩、打包、备份</h2><p>由于计算机以字节为单位记录数据，而有效的信息以bit为单位存储，所以难免会有空间浪费</p><p>两种文件压缩思路：</p><ul><li>利用压缩算法，将未使用的空间丢弃，再使用相应的解压算法，填充原始数据</li><li>将重复的数据进行统计记录</li></ul><p>压缩文件无法直接被操作系统使用，若要使用这些压缩过的文件数据，需要将这些数据解压缩（还原为未压缩的状态）</p><ul><li>$压缩比=\frac{压缩后文件大小}{压缩前文件大小}$</li></ul><h3 id="文件压缩指指令"><a href="#文件压缩指指令" class="headerlink" title="文件压缩指指令"></a>文件压缩指指令</h3><p>不同的压缩算法需要使用不同的压缩指令</p><p>Linux上常用的压缩指令为gzip、bzip2、xz，compress已被淘汰</p><ul><li>gzip算法由GNU计划开发，后续的bzip2与xz指令压缩比更高</li></ul><p>Windows常用zip，所以Linux也支持zip指令</p><p>这些压缩指令，通常仅支持对一个文件进行压缩与解压缩，利用 <strong>打包软件（tar）</strong> ，可以将多个文件打包为一个文件</p><div class="table-container"><table><thead><tr><th>压缩指令</th><th>压缩文件名</th><th></th></tr></thead><tbody><tr><td>compress</td><td>*.Z</td><td></td></tr><tr><td>zip</td><td>*.zip</td><td></td></tr><tr><td>gzip</td><td>*.gz</td><td></td></tr><tr><td>bzip2</td><td>*.bz2</td><td></td></tr><tr><td>xz</td><td>*.xz</td><td></td></tr><tr><td>tar</td><td>*.tar</td><td>经tar打包，并未被压缩</td></tr><tr><td></td><td>*.tar.gz</td><td>经tar打包，并由gzip压缩</td></tr><tr><td></td><td>*tar.bz2</td><td>经tar打包，并由bzip2压缩</td></tr><tr><td></td><td>*.tar.xz</td><td>经tar打包，并由xz压缩</td></tr></tbody></table></div><h4 id="gzip、zcat-zmore-zless-zgrep"><a href="#gzip、zcat-zmore-zless-zgrep" class="headerlink" title="gzip、zcat/zmore/zless/zgrep"></a>gzip、zcat/zmore/zless/zgrep</h4><blockquote><p>gzip可以解压缩compress，zip与gzip等压缩的文件</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip [-cdtv#] 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-c</td><td></td><td>将压缩后的数据显示在屏幕上</td></tr><tr><td>-d</td><td></td><td>删除原压缩文件，并解压缩</td></tr><tr><td>-t</td><td></td><td>检验压缩文件的一致性</td></tr><tr><td>-v</td><td></td><td>显示原始文件/压缩文件的压缩比等信息</td></tr><tr><td>-#</td><td>#表示数字</td><td>代表压缩等级<br>-1：压缩速度最快，压缩比最差<br>-9：压缩速度最慢，压缩比最高<br>默认为6</td></tr></tbody></table></div><p>默认情况，使用gzip压缩文件，原始文件会被压缩为.gz，且原始文件就不存在了</p><p>使用gzip压缩的文件，在Windows中，可被WinRAR或7Zip解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@tzj-virtual-machine:~/test# ls</span><br><span class="line">test.txt</span><br><span class="line">root@tzj-virtual-machine:~/test# cat test.txt </span><br><span class="line">aaaaa</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示压缩</span></span><br><span class="line">root@tzj-virtual-machine:~/test# gzip -v test.txt </span><br><span class="line">test.txt:	  0.0% -- replaced with test.txt.gz</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~/test# ls</span><br><span class="line">test.txt.gz</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压缩</span></span><br><span class="line">root@tzj-virtual-machine:~/test# gzip -d test.txt.gz</span><br><span class="line"></span><br><span class="line">root@tzj-virtual-machine:~/test# gzip -c test.txt                                                                                                                                                             榃test.txtKL.(¡</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gzip -c 可以预先查看压缩后的内容</span></span><br><span class="line">root@tzj-virtual-machine:~/test# cat test.txt.gz                                                                                                                                                              榃test.txtKL.(¡</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若想保留原文件，可使用gzip -c将压缩后的内容重定向到新的文件</span></span><br><span class="line">root@tzj-virtual-machine:~/test# gzip -c test.txt &gt; test.txt.gz</span><br><span class="line">root@tzj-virtual-machine:~/test# ls</span><br><span class="line">test.txt  test.txt.gz</span><br><span class="line">root@tzj-virtual-machine:~/test# zcat test.txt.gz </span><br><span class="line">aaaaa</span><br></pre></td></tr></table></figure><p>zcat、zmore、zless用法类似于cat、more、less，用于读取纯文本文件被压缩后的内容</p><p>zgrep 可以搜索原始文件中的关键字，而不需要解压缩</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[dmtsai@study tmp]$ zgrep -n &#x27;http&#x27; services.gz</span><br><span class="line">14:# http://www.iana.org/assignments/port-numbers</span><br><span class="line">89:http 80/tcp www www-http # WorldWideWeb HTTP</span><br><span class="line">90:http 80/udp www www-http # HyperText Transfer Protocol</span><br></pre></td></tr></table></figure><h4 id="bzip2、bzcat-bzmore-bzless"><a href="#bzip2、bzcat-bzmore-bzless" class="headerlink" title="bzip2、bzcat/bzmore/bzless"></a>bzip2、bzcat/bzmore/bzless</h4><p>bzip2相较gzip有更高的压缩比</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bzip2 -[选项] 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-c</td><td></td><td>将压缩后的数据输出到屏幕上</td></tr><tr><td>-d</td><td></td><td>解压缩</td></tr><tr><td>-k</td><td></td><td>保留源文件，不删除原始文件</td></tr><tr><td>-z</td><td></td><td>压缩参数</td></tr><tr><td>-v</td><td></td><td>显示原始文件/压缩文件的压缩比等信息</td></tr><tr><td>-#</td><td>#表示数字</td><td>代表压缩等级<br>-1：压缩速度最快，压缩比最差<br>-9：压缩速度最慢，压缩比最高<br>默认为6</td></tr></tbody></table></div><h4 id="xz、xzcat-xzmore-xzless-xzgrep"><a href="#xz、xzcat-xzmore-xzless-xzgrep" class="headerlink" title="xz、xzcat/xzmore/xzless/xzgrep"></a>xz、xzcat/xzmore/xzless/xzgrep</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xz -[选项] 文件名</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>选项</th><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-d</td><td></td><td>解压缩</td></tr><tr><td>-t</td><td></td><td>测试文件完整性</td></tr><tr><td>-l</td><td></td><td>列出压缩文件的相关信息</td></tr><tr><td>-k</td><td></td><td>保留原始文件</td></tr><tr><td>-c</td><td></td><td>将压缩后的数据显示在屏幕上</td></tr><tr><td>-#</td><td>#表示数字</td><td>代表压缩等级<br>-1：压缩速度最快，压缩比最差<br>-9：压缩速度最慢，压缩比最高<br>默认为6</td></tr></tbody></table></div><p>可对比压缩时长</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time [gzip|bzip2|xz] -c services &gt; services.[gz|bz2|xz]</span><br></pre></td></tr></table></figure><p>xz指令压缩效果最好，但压缩耗时非常多</p><h3 id="打包指令"><a href="#打包指令" class="headerlink" title="打包指令"></a>打包指令</h3><p>tar将多个目录或文件打包为一个大文件，支持通过参数将打包后的文件进行压缩与解压缩</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -[z|j|j][c|x|t][v][f] 文件名 -C</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------<i class="fa fa-hand-peace-o"></i>本文结束-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者 </strong>AmosTian</li><li class="post-copyright-link"><strong>本文链接 </strong><a href="https://amostian.github.io/posts/2763264027/" title="Linux文件系统">https://amostian.github.io/posts/2763264027/</a></li><li class="post-copyright-license"><strong>版权声明 </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Linux/" rel="tag"><i class="fa fa-tags"></i> Linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/2693647045/" rel="prev" title="Linux简介、安装、简单使用"><i class="fa fa-chevron-left"></i> Linux简介、安装、简单使用</a></div><div class="post-nav-item"><a href="/posts/799239284/" rel="next" title="minio集群搭建">minio集群搭建 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E3%80%81%E6%9D%83%E9%99%90%E3%80%81%E6%93%8D%E4%BD%9C"><span class="nav-text">1. 文件信息、权限、操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="nav-text">文件信息查看</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%A0%8F%EF%BC%9A%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B-%E4%B8%8D%E5%90%8C%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E7%9A%84%E6%9D%83%E9%99%90"><span class="nav-text">第一栏：文件类型+不同用户身份的权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%A0%8F%EF%BC%9A%E9%93%BE%E6%8E%A5%E6%95%B0"><span class="nav-text">第二栏：链接数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%A0%8F%EF%BC%9A%E6%96%87%E4%BB%B6%E6%8B%A5%E6%9C%89%E8%80%85%E4%B8%8E%E6%89%80%E5%B1%9E%E7%BE%A4%E7%BB%84"><span class="nav-text">第三栏：文件拥有者与所属群组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%A0%8F%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F"><span class="nav-text">第五栏：文件大小</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%A0%8F%EF%BC%9A%E6%96%87%E4%BB%B6%E6%9C%80%E8%BF%91%E7%9A%84%E4%BF%AE%E6%94%B9%E6%97%A5%E6%9C%9F"><span class="nav-text">第六栏：文件最近的修改日期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7"><span class="nav-text">Linux文件的其他属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">文件类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E6%96%87%E4%BB%B6"><span class="nav-text">普通文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6"><span class="nav-text">目录文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E6%96%87%E4%BB%B6"><span class="nav-text">设备文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%A1%E9%81%93%E6%96%87%E4%BB%B6"><span class="nav-text">管道文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6"><span class="nav-text">链接文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-text">文件权限</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E7%94%A8%E6%88%B7"><span class="nav-text">访问用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8E%E7%94%A8%E6%88%B7%E7%BB%84%E4%BF%AE%E6%94%B9"><span class="nav-text">用户与用户组修改</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E6%9D%83%E9%99%90%E2%80%94%E2%80%94rwx"><span class="nav-text">普通权限——rwx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90"><span class="nav-text">特殊权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SUID%E6%9D%83%E9%99%90"><span class="nav-text">SUID权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SGID%E6%9D%83%E9%99%90"><span class="nav-text">SGID权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SBIT%E6%9D%83%E9%99%90"><span class="nav-text">SBIT权限</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E7%9A%84%E4%BF%AE%E6%94%B9%E2%80%94%E2%80%94chmod"><span class="nav-text">权限的修改——chmod</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B%E6%94%B9%E5%8F%98%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-text">数字类型改变文件权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AC%A6%E5%8F%B7%E7%B1%BB%E5%9E%8B%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-text">符号类型修改文件权限</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%9D%83%E9%99%90"><span class="nav-text">默认权限</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E9%9A%90%E8%97%8F%E5%B1%9E%E6%80%A7"><span class="nav-text">文件隐藏属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%9A%90%E8%97%8F%E5%B1%9E%E6%80%A7%E2%80%94%E2%80%94lsattr"><span class="nav-text">查看隐藏属性——lsattr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9A%90%E8%97%8F%E5%B1%9E%E6%80%A7%E2%80%94%E2%80%94chattr"><span class="nav-text">配置隐藏属性——chattr</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">对文件的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E2%80%94%E2%80%94file"><span class="nav-text">查看文件基本数据——file</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-text">查看文本文件内容</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-text">直接查看文件内容</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#cat"><span class="nav-text">cat</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#nl"><span class="nav-text">nl</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BF%BB%E9%A1%B5%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-text">翻页查看文件内容</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%85%E5%AE%B9%E6%88%AA%E5%8F%96"><span class="nav-text">内容截取</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BB%8E%E5%89%8D%E6%88%AA%E5%8F%96head"><span class="nav-text">从前截取head</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BB%8E%E5%90%8E%E6%88%AA%E5%8F%96tail"><span class="nav-text">从后截取tail</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%9D%9E%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9%E2%80%94%E2%80%94od"><span class="nav-text">查看非文本文档内容——od</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E6%97%B6%E9%97%B4%E2%80%94%E2%80%94touch"><span class="nav-text">创建文件或修改文件时间——touch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2"><span class="nav-text">文件搜索</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4%E6%90%9C%E7%B4%A2"><span class="nav-text">指令搜索</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86"><span class="nav-text">目录管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E4%B8%8E%E8%B7%AF%E5%BE%84"><span class="nav-text">目录与路径</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E7%9B%AE%E5%BD%95"><span class="nav-text">特殊目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84-%E6%96%87%E4%BB%B6%E5%90%8D"><span class="nav-text">获取路径&#x2F;文件名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-text">环境变量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E9%85%8D%E7%BD%AE"><span class="nav-text">目录配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E9%85%8D%E7%BD%AE%E8%A7%84%E8%8C%83%E2%80%94%E2%80%94FHS"><span class="nav-text">目录配置规范——FHS</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B9%E7%9B%AE%E5%BD%95%EF%BC%88-%EF%BC%89"><span class="nav-text">根目录（&#x2F;）</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BF%85%E9%9C%80%E7%9B%AE%E5%BD%95"><span class="nav-text">必需目录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BB%BA%E8%AE%AE%E7%9B%AE%E5%BD%95"><span class="nav-text">建议目录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9D%9EFHS%E8%A7%84%E5%AE%9A%EF%BC%8C%E4%BD%86%E9%87%8D%E8%A6%81%E7%9A%84%E7%9B%AE%E5%BD%95"><span class="nav-text">非FHS规定，但重要的目录</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#usr-%E7%9B%AE%E5%BD%95"><span class="nav-text">&#x2F;usr 目录</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BF%85%E9%9C%80%E7%9B%AE%E5%BD%95-1"><span class="nav-text">必需目录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BB%BA%E8%AE%AE%E7%9B%AE%E5%BD%95-1"><span class="nav-text">建议目录</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#var%E7%9B%AE%E5%BD%95"><span class="nav-text">&#x2F;var目录</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BF%85%E9%9C%80%E7%9B%AE%E5%BD%95-2"><span class="nav-text">必需目录</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%A0%91"><span class="nav-text">目录树</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LSB%E8%A7%84%E8%8C%83"><span class="nav-text">LSB规范</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%9B%AE%E5%BD%95%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">对目录的操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-text">对文件与目录的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E4%BF%A1%E6%81%AFls"><span class="nav-text">输出信息ls</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%8D%E5%88%B6cp"><span class="nav-text">复制cp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4rm"><span class="nav-text">删除rm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A7%BB%E5%8A%A8%E6%88%96%E6%9B%B4%E5%90%8Dmv"><span class="nav-text">移动或更名mv</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6-%E7%9B%AE%E5%BD%95%E6%90%9C%E7%B4%A2"><span class="nav-text">文件&#x2F;目录搜索</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#whereis"><span class="nav-text">whereis</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#locate-updatedb"><span class="nav-text">locate&#x2F;updatedb</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#find"><span class="nav-text">find</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5"><span class="nav-text">文件系统概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A1%AC%E4%BB%B6%E6%94%AF%E6%8C%81"><span class="nav-text">硬件支持</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%89%E7%A7%8D%E5%85%B3%E9%94%AE%E6%95%B0%E6%8D%AE"><span class="nav-text">文件系统的三种关键数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-text">文件系统的组成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#EXT2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-text">EXT2文件系统的组成</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%9D%97"><span class="nav-text">数据块</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#inode%E8%A1%A8"><span class="nav-text">inode表</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#inode%E7%BC%96%E5%8F%B7%E7%9B%B8%E5%85%B3"><span class="nav-text">inode编号相关</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#inode%E6%95%B0%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-text">inode数的计算</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#inode-block%E4%B8%8E%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-text">inode&#x2F;block与文件大小的关系</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#inode-bitmap%EF%BC%88inode%E5%AF%B9%E7%85%A7%E8%A1%A8%EF%BC%89"><span class="nav-text">inode bitmap（inode对照表）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#block-bitmap%EF%BC%88%E5%8C%BA%E5%9D%97%E5%AF%B9%E7%85%A7%E8%A1%A8%EF%BC%89"><span class="nav-text">block bitmap（区块对照表）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#filesystem-description%EF%BC%88%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8F%8F%E8%BF%B0%E8%AF%B4%E6%98%8E%EF%BC%89"><span class="nav-text">filesystem description（文件系统描述说明）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#superblock%EF%BC%88%E8%B6%85%E5%9D%97%EF%BC%89"><span class="nav-text">superblock（超块）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90"><span class="nav-text">XFS文件系统组成</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%BA%EF%BC%88data-section%EF%BC%89"><span class="nav-text">数据区（data section）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%B4%BB%E5%8A%A8%E6%97%A5%E5%BF%97%E5%8C%BA%EF%BC%88log-section%EF%BC%89"><span class="nav-text">文件系统活动日志区（log section）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E6%97%B6%E8%BF%90%E8%A1%8C%E5%8C%BA%EF%BC%88realtime-section%EF%BC%89"><span class="nav-text">实时运行区（realtime section）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96Linux%E6%94%AF%E6%8C%81%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%B8%8EVFS"><span class="nav-text">其他Linux支持的系统与VFS</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#VFS"><span class="nav-text">VFS</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">查看文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#EXT%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">EXT文件系统</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#XFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">XFS文件系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E4%B8%8E%E6%80%A7%E8%83%BD"><span class="nav-text">文件读写与性能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%A0%91"><span class="nav-text">目录文件与目录树</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="nav-text">文件的读取流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EXT%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%86%99%E5%85%A5"><span class="nav-text">EXT文件系统的写入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E7%8A%B6%E6%80%81"><span class="nav-text">数据不一致状态</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">日志式文件系统</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AF%BB%E5%86%99%E6%80%A7%E8%83%BD"><span class="nav-text">文件系统的读写性能</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%BC%82%E6%AD%A5%E5%86%99%E5%85%A5"><span class="nav-text">Linux文件系统的异步写入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%A4%A7%E5%B0%8F%E4%B8%8E%E6%80%A7%E8%83%BD"><span class="nav-text">文件系统大小与性能</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EXT2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%A9%BA%E9%97%B4%E6%B5%AA%E8%B4%B9"><span class="nav-text">EXT2文件系统的空间浪费</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">文件系统的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><span class="nav-text">文件系统信息获取</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%88%86%E5%8C%BA%E4%B8%AD%E7%9A%84%E5%90%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF"><span class="nav-text">获取分区中的各文件系统信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95%E7%9A%84%E5%8D%A0%E7%94%A8%E9%87%8F"><span class="nav-text">获取文件或目录的占用量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E9%93%BE%E6%8E%A5"><span class="nav-text">创建文件链接</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A1%AC%E9%93%BE%E6%8E%A5"><span class="nav-text">硬链接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="nav-text">软链接</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E4%B8%8E%E6%8C%82%E8%BD%BD"><span class="nav-text">磁盘分区与挂载</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E7%A3%81%E7%9B%98%E7%8A%B6%E6%80%81"><span class="nav-text">确认磁盘状态</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E7%A3%81%E7%9B%98%E5%88%97%E8%A1%A8"><span class="nav-text">列出磁盘列表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87UUID%E4%BF%A1%E6%81%AF%E2%80%94%E2%80%94blkid"><span class="nav-text">获取设备UUID信息——blkid</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF%E2%80%94%E2%80%94parted"><span class="nav-text">获取磁盘分区信息——parted</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="nav-text">磁盘分区</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#fdisk"><span class="nav-text">fdisk</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#gdisk"><span class="nav-text">gdisk</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#partprobe%E6%9B%B4%E6%96%B0%E5%86%85%E6%A0%B8%E7%9A%84%E5%88%86%E5%8C%BA%E8%A1%A8%E4%BF%A1%E6%81%AF"><span class="nav-text">partprobe更新内核的分区表信息</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%88%86%E5%8C%BA%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">删除分区的操作</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8parted%E8%BF%9B%E8%A1%8C%E5%88%86%E5%8C%BA"><span class="nav-text">使用parted进行分区</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E2%80%94%E2%80%94mkfs"><span class="nav-text">格式化——mkfs</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#mkfs-xfs"><span class="nav-text">mkfs.xfs</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#mkfs-ext4"><span class="nav-text">mkfs.ext4</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A3%80%E9%AA%8C"><span class="nav-text">文件系统检验</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#EXT4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A3%80%E9%AA%8C"><span class="nav-text">EXT4文件系统检验</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%A3%80%E9%AA%8C"><span class="nav-text">xfs文件系统的检验</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8C%82%E8%BD%BD%E4%B8%8E%E8%A7%A3%E9%99%A4"><span class="nav-text">文件系统挂载与解除</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-text">文件系统的自动挂载原理</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDxfs-ext4-vfat%E7%AD%89%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">挂载xfs&#x2F;ext4&#x2F;vfat等文件系统</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDCD%E6%88%96DVD%E5%85%89%E7%9B%98"><span class="nav-text">挂载CD或DVD光盘</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD%E4%B8%AD%E6%96%87USB%E8%AE%BE%E5%A4%87"><span class="nav-text">挂载中文USB设备</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0"><span class="nav-text">修改挂载参数</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E9%99%A4%E6%8C%82%E8%BD%BD"><span class="nav-text">解除挂载</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E6%8C%82%E8%BD%BD"><span class="nav-text">设置开机挂载</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#loop%E8%AE%BE%E5%A4%87%E7%9A%84%E6%8C%82%E8%BD%BD%EF%BC%88%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%EF%BC%89"><span class="nav-text">loop设备的挂载（镜像文件直接使用）</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDubuntu%E7%A6%BB%E7%BA%BF%E9%95%9C%E5%83%8F%E6%BA%90"><span class="nav-text">挂载ubuntu离线镜像源</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDcentos%E7%A6%BB%E7%BA%BF%E9%95%9C%E5%83%8F%E6%BA%90"><span class="nav-text">挂载centos离线镜像源</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%B6%E4%BD%9Cloop%E8%AE%BE%E5%A4%87%E6%96%87%E4%BB%B6%E4%BB%A5%E6%8C%82%E8%BD%BD"><span class="nav-text">制作loop设备文件以挂载</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%8C%82%E8%BD%BD"><span class="nav-text">目录挂载</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0"><span class="nav-text">修改文件系统参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mknod%E6%8C%87%E5%AE%9A%E8%AE%BE%E5%A4%87%E6%96%87%E4%BB%B6%E7%9A%84MAJ%E4%B8%8EMIN"><span class="nav-text">mknod指定设备文件的MAJ与MIN</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#xfs-admin%E4%BF%AE%E6%94%B9XFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84UUID%E4%B8%8ELabel-name"><span class="nav-text">xfs_admin修改XFS文件系统的UUID与Label name</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#tune2fs%E4%BF%AE%E6%94%B9ext4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84UUID%E4%B8%8Elabel-name"><span class="nav-text">tune2fs修改ext4文件系统的UUID与label name</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E7%BD%AE%E6%8D%A2%E7%A9%BA%E9%97%B4%E7%9A%84%E6%9E%84%E5%BB%BA"><span class="nav-text">内存置换空间的构建</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%88%86%E5%8C%BA%E6%9E%84%E5%BB%BAswap%E5%88%86%E5%8C%BA"><span class="nav-text">使用分区构建swap分区</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E6%9E%84%E5%BB%BAswap"><span class="nav-text">使用文件构建swap</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8E%8B%E7%BC%A9%E3%80%81%E6%89%93%E5%8C%85%E3%80%81%E5%A4%87%E4%BB%BD"><span class="nav-text">文件与文件系统的压缩、打包、备份</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9%E6%8C%87%E6%8C%87%E4%BB%A4"><span class="nav-text">文件压缩指指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#gzip%E3%80%81zcat-zmore-zless-zgrep"><span class="nav-text">gzip、zcat&#x2F;zmore&#x2F;zless&#x2F;zgrep</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#bzip2%E3%80%81bzcat-bzmore-bzless"><span class="nav-text">bzip2、bzcat&#x2F;bzmore&#x2F;bzless</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xz%E3%80%81xzcat-xzmore-xzless-xzgrep"><span class="nav-text">xz、xzcat&#x2F;xzmore&#x2F;xzless&#x2F;xzgrep</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%8C%87%E4%BB%A4"><span class="nav-text">打包指令</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="AmosTian" src="/images/avatar.png"><p class="site-author-name" itemprop="name">AmosTian</p><div class="site-description" itemprop="description">知道的越多，不知道的越多</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">236</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">68</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">83</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AmosTian" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AmosTian" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/qq_40479037?type=blog" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_40479037?type&#x3D;blog" rel="noopener" target="_blank"><i class="fa fa-fw fa-crosshairs"></i>CSDN</a> </span><span class="links-of-author-item"><a href="mailto:17636679561@163.com" title="E-Mail → mailto:17636679561@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("01/27/2022 15:13:14"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-grav"></i> </span><span class="author" itemprop="copyrightHolder">AmosTian</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">站点总字数 </span><span title="站点总字数">1252.1k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">50:25</span></div></div></footer></div><script color="0,0,0" opacity="0.5" zindex="-1" count="150" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'neutral',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}</script><script>if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }</script><script async src="/js/cursor/fireworks.js"></script><script src="/js/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"live2d-widget-model-hijiki"},display:{position:"right",width:150,height:300},mobile:{show:!1},log:!1})</script></body></html>